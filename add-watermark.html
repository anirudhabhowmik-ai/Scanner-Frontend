<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Primary Meta Tags -->
    <title>
      Add Watermark to PDF Online Free - Text & Image Watermarks | NextoPDF
    </title>
    <meta
      name="title"
      content="Add Watermark to PDF Online Free - Text & Image Watermarks | NextoPDF"
    />
    <meta
      name="description"
      content="Add watermark to PDF files online for free. Add text or image watermarks with custom position, opacity, and rotation. Protect your documents and establish copyright ownership instantly."
    />
    <meta
      name="keywords"
      content="add watermark to PDF, PDF watermark online, watermark PDF free, text watermark, image watermark, protect PDF, copyright watermark, PDF branding"
    />
    <meta name="author" content="NextoPDF" />
    <meta
      name="robots"
      content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"
    />

    <!-- Canonical URL -->
    <link rel="canonical" href="https://nextopdf.com/watermark" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://nextopdf.com/watermark" />
    <meta
      property="og:title"
      content="Add Watermark to PDF Online Free - Text & Image Watermarks | NextoPDF"
    />
    <meta
      property="og:description"
      content="Add watermark to PDF files online for free. Add text or image watermarks with custom position, opacity, and rotation. Protect your documents instantly."
    />
    <meta
      property="og:image"
      content="https://nextopdf.com/images/og-image.png"
    />
    <meta property="og:site_name" content="NextoPDF" />
    <meta property="og:locale" content="en_US" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="https://nextopdf.com/watermark" />
    <meta
      name="twitter:title"
      content="Add Watermark to PDF Online Free - Text & Image Watermarks | NextoPDF"
    />
    <meta
      name="twitter:description"
      content="Add watermark to PDF files online for free. Add text or image watermarks with custom position, opacity, and rotation."
    />
    <meta
      name="twitter:image"
      content="https://nextopdf.com/images/twitter-card.png"
    />

    <!-- Structured Data / Schema.org -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "NextoPDF - Add Watermark to PDF",
        "url": "https://nextopdf.com/watermark",
        "description": "Free online tool to add text or image watermarks to PDF documents with custom positioning and styling",
        "applicationCategory": "UtilitiesApplication",
        "operatingSystem": "Any",
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "USD"
        },
        "featureList": "Text watermarks, Image watermarks, Custom positioning, Opacity control, Rotation, Batch processing"
      }
    </script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&family=Inter:wght@400;500&display=swap"
      rel="stylesheet"
    />

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />

    <!-- Favicon -->
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="./images/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="./images/favicon-16x16.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="./images/apple-touch-icon.png"
    />

    <!-- Main CSS -->
    <link rel="stylesheet" href="./css/style.css" />
    <link rel="stylesheet" href="./css/watermerk.css" />

    <!-- Google AdSense (Replace with your AdSense ID) -->
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5797619165090350"
      crossorigin="anonymous"
    ></script>
  </head>

  <body>
    <section id="header-placeholder"></section>

    <main>
      <section class="merge-tool" role="main">
        <div class="container">
          <h1>Add Watermark to PDF Online - Protect Your Documents</h1>
          <p>
            Add custom text or image watermarks to PDFs with full control over
            position, opacity, and rotation. Protect copyright and establish
            document ownership.
          </p>

          <div class="upload-section">
            <div id="uploadSection">
              <label class="upload-label" for="pdfUpload">
                <i class="fa fa-upload" aria-hidden="true"></i> Choose PDF files
              </label>
              <input
                type="file"
                id="pdfUpload"
                accept=".pdf"
                multiple
                aria-label="Upload PDF files to add watermark"
              />
            </div>

            <div
              class="success-message"
              id="successMsg"
              role="status"
              aria-live="polite"
            ></div>

            <ul
              id="fileList"
              class="file-list"
              style="display: none"
              role="list"
            ></ul>
            <div
              id="pagesGrid"
              class="pages-grid"
              style="display: none"
              role="region"
              aria-label="PDF pages preview with watermarks"
            ></div>

            <!-- OPTIONS -->
            <div id="wmOptions" style="display: none; text-align: left">
              <div class="watermarkBtn-container">
                <p
                  class="error-text"
                  id="errorMsg"
                  style="display: none"
                  role="alert"
                ></p>
                <button
                  id="watermarkBtn"
                  class="cta-button"
                  aria-label="Add watermark to PDF"
                >
                  <span class="btn-spinner" aria-hidden="true">
                    <i class="fa fa-spinner fa-spin"></i>
                  </span>
                  <span class="btn-text"
                    ><i class="fa fa-stamp" aria-hidden="true"></i
                  ></span>
                  Add Watermark
                </button>
                
              </div>
              <label>Watermark Type</label>
              <div
                class="radio-group"
                role="radiogroup"
                aria-label="Choose watermark type"
              >
                <label style="display: flex; align-items: center">
                  <input
                    type="radio"
                    name="wmType"
                    value="text"
                    checked
                    style="margin-top: 0"
                    aria-label="Text watermark"
                  />
                  Text
                </label>
                <label style="display: flex; align-items: center">
                  <input
                    type="radio"
                    name="wmType"
                    value="image"
                    style="margin-top: 0"
                    aria-label="Image watermark"
                  />
                  Image
                </label>
              </div>

              <div id="textControls" style="display: flex; gap: 10px">
                <div style="margin-bottom: 5px">
                  <label for="wmText">Watermark Text</label>
                  <input
                    type="text"
                    id="wmText"
                    placeholder="Enter watermark text"
                    style="
                      padding: 6px 8px;
                      border: 1px solid #e5e7eb;
                      border-radius: 6px;
                    "
                    aria-label="Enter watermark text"
                  />
                </div>

                <div>
                  <label>Text Styling</label>
                  <div class="text-style-buttons">
                    <div class="option-group" id="fontFamilyGroup">
                      <select id="fontFamily" aria-label="Select font family">
                        <option value="Helvetica">Helvetica</option>
                        <option value="Helvetica-Bold">Helvetica Bold</option>
                        <option value="Courier">Courier</option>
                        <option value="Times-Roman">Times Roman</option>
                      </select>
                    </div>
                    <div class="option-group" id="fontSizeGroup">
                      <input
                        type="number"
                        id="fontSize"
                        value="36"
                        min="8"
                        max="200"
                        aria-label="Font size"
                      />
                    </div>

                    <div class="color-input-wrapper">
                      <input
                        type="color"
                        id="textColor"
                        value="#000000"
                        aria-label="Text color picker"
                      />
                      <input
                        type="text"
                        id="textColorHex"
                        value="#000000"
                        placeholder="#000000"
                        aria-label="Text color hex code"
                      />
                    </div>

                    <button
                      type="button"
                      id="boldBtn"
                      title="Bold"
                      aria-label="Toggle bold text"
                      aria-pressed="false"
                    >
                      <i class="fa fa-bold" aria-hidden="true"></i>
                    </button>
                    <button
                      type="button"
                      id="italicBtn"
                      title="Italic"
                      aria-label="Toggle italic text"
                      aria-pressed="false"
                    >
                      <i class="fa fa-italic" aria-hidden="true"></i>
                    </button>
                    <button
                      type="button"
                      id="underlineBtn"
                      title="Underline"
                      aria-label="Toggle underline text"
                      aria-pressed="false"
                    >
                      <i class="fa fa-underline" aria-hidden="true"></i>
                    </button>
                  </div>
                </div>
              </div>

              <div id="imageControls" style="display: none">
                <label for="wmImage">Watermark Image</label>
                <input
                  type="file"
                  id="wmImage"
                  accept="image/*"
                  style="
                    padding: 10px;
                    border: 1px solid #e5e7eb;
                    border-radius: 6px;
                  "
                  aria-label="Upload watermark image"
                />
              </div>

              <div class="options-grid">
                <div class="option-group">
                  <label for="opacity">Opacity</label>
                  <input
                    type="number"
                    id="opacity"
                    step="0.1"
                    min="0.1"
                    max="1"
                    value="0.3"
                    aria-label="Watermark opacity from 0.1 to 1"
                  />
                </div>

                <div class="option-group">
                  <label for="rotation">Rotation (degrees)</label>
                  <input
                    type="number"
                    id="rotation"
                    value="0"
                    min="-180"
                    max="180"
                    step="15"
                    aria-label="Rotation angle in degrees"
                  />
                </div>

                <div class="option-group">
                  <label for="position">Position</label>
                  <select id="position" aria-label="Watermark position">
                    <option value="center">Center</option>
                    <option value="top-left">Top Left</option>
                    <option value="top-right">Top Right</option>
                    <option value="bottom-left">Bottom Left</option>
                    <option value="bottom-right">Bottom Right</option>
                  </select>
                </div>

                <div class="option-group">
                  <label for="pageStart">Page Range</label>
                  <div class="page-range-input">
                    <input
                      type="number"
                      id="pageStart"
                      value="1"
                      min="1"
                      placeholder="Start"
                      aria-label="Starting page number"
                    />
                    <input
                      type="number"
                      id="pageEnd"
                      value="0"
                      min="0"
                      placeholder="End (0=all)"
                      aria-label="Ending page number, 0 for all pages"
                    />
                  </div>
                </div>
              </div>
            </div>

            <div class="note-box">
              ðŸ’¡ Drag watermarks to reposition and resize images. Each modified
              page will show an "Apply to All" button.
            </div>

            <div id="resultBtns" style="display: none; margin-top: 30px">
              <div class="result-card">
                <i class="fa fa-file-pdf" aria-hidden="true"></i>
              </div>

              <p class="file-name">
                <a href="#" id="fileNameLink">watermarked.pdf</a>
              </p>

              <div class="result-btns-container">
                <a
                  id="downloadBtn"
                  href="#"
                  class="cta-button"
                  download
                  aria-label="Download watermarked PDF"
                >
                  <i class="fa fa-download" aria-hidden="true"></i> Download
                </a>
                <a
                  id="shareBtn"
                  href="#"
                  class="cta-button"
                  aria-label="Share watermarked PDF"
                >
                  <i class="fa fa-share-alt" aria-hidden="true"></i> Share
                </a>
                <button
                  id="resetBtn"
                  class="secondary-btn"
                  aria-label="Add watermark to another PDF"
                >
                  <i class="fa fa-rotate-right" aria-hidden="true"></i> Add
                  Another Watermark
                </button>
              </div>
            </div>
          </div>

          <div id="pdfPreview" style="display: none; margin-top: 30px">
            <h2>Preview Watermarked PDF</h2>
            <iframe
              id="pdfFrame"
              width="100%"
              height="600"
              style="border-radius: 12px; border: 1px solid #e5e7eb"
              title="Watermarked PDF preview"
            ></iframe>
          </div>
        </div>
      </section>

      <!-- How It Works Section -->
      <section class="benefits" style="background: white">
        <div class="container">
          <h2>How to Add Watermark to PDF</h2>
          <div class="feature-grid">
            <div class="feature-card">
              <div
                style="
                  font-size: 48px;
                  color: #fbbf24;
                  font-weight: bold;
                  margin-bottom: 10px;
                "
                aria-hidden="true"
              >
                1
              </div>
              <h3>Upload Your PDF</h3>
              <p>
                Select one or multiple PDF files. Visual preview shows where
                watermarks will appear on each page.
              </p>
            </div>
            <div class="feature-card">
              <div
                style="
                  font-size: 48px;
                  color: #fbbf24;
                  font-weight: bold;
                  margin-bottom: 10px;
                "
                aria-hidden="true"
              >
                2
              </div>
              <h3>Customize Watermark</h3>
              <p>
                Choose text or image watermark. Adjust position, opacity,
                rotation, font, color, and styling options.
              </p>
            </div>
            <div class="feature-card">
              <div
                style="
                  font-size: 48px;
                  color: #fbbf24;
                  font-weight: bold;
                  margin-bottom: 10px;
                "
                aria-hidden="true"
              >
                3
              </div>
              <h3>Download Protected PDF</h3>
              <p>
                Download your watermarked PDF with copyright protection applied
                permanently to all selected pages.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- Why Add Watermarks Section -->
      <section class="features" style="background: #f9fafb">
        <div class="container">
          <h2>Why Add Watermarks to PDF Documents?</h2>
          <div style="max-width: 900px; margin: 0 auto; text-align: left">
            <p style="color: #555; line-height: 1.8; margin-bottom: 30px">
              Watermarks serve as a visible declaration of ownership, copyright
              protection, and document status. Whether you're sharing creative
              work, confidential documents, or branded materials, watermarks
              help protect your intellectual property and prevent unauthorized
              use.
            </p>

            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              Copyright Protection and Ownership
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 25px">
              Watermarks serve as the first line of defense for your
              intellectual property. By adding a visible watermark to PDFs, you
              establish clear ownership and make unauthorized reproduction more
              difficult. While watermarks don't legally prevent copying, they
              deter casual theft by making it obvious when content has been
              taken without permission. For photographers, designers, writers,
              and other creative professionals, watermarks protect work samples
              shared with potential clients or posted online. The watermark
              ensures that even if someone downloads or screenshots your work,
              your name or logo remains attached to it, helping potential
              clients find you and discouraging unauthorized commercial use.
            </p>

            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              Professional Branding
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 15px">
              Watermarks reinforce brand identity across all documents. Common
              professional branding applications include:
            </p>
            <ul
              style="
                color: #555;
                line-height: 1.8;
                margin-bottom: 25px;
                padding-left: 25px;
              "
            >
              <li style="margin-bottom: 10px">
                <strong>Company Documents:</strong> Add company logos to
                reports, proposals, and presentations to maintain brand
                consistency and professional appearance.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Marketing Materials:</strong> Watermark promotional
                PDFs, brochures, and catalogs to ensure brand visibility even
                when documents are shared or redistributed.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Portfolio Protection:</strong> Designers, photographers,
                and artists watermark portfolio pieces to protect work while
                showcasing capabilities to potential clients.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Training Materials:</strong> Organizations watermark
                training documents and instructional materials to indicate
                proprietary content and prevent unauthorized distribution.
              </li>
            </ul>

            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              Document Status Indicators
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 15px">
              Watermarks communicate important information about document status
              and usage restrictions:
            </p>
            <p style="color: #555; line-height: 1.8; margin-bottom: 10px">
              <strong>Draft vs. Final Status:</strong> "DRAFT" watermarks
              prevent confusion when multiple versions exist, ensuring
              recipients don't act on preliminary information. This is
              particularly important in legal, financial, and technical
              documentation where using outdated information could have serious
              consequences.
            </p>
            <p style="color: #555; line-height: 1.8; margin-bottom: 10px">
              <strong>Confidentiality Markers:</strong> "CONFIDENTIAL,"
              "PROPRIETARY," or "INTERNAL USE ONLY" watermarks remind all
              viewers of usage restrictions and discourage unauthorized sharing.
              These visual reminders reinforce security policies and help
              prevent accidental disclosure.
            </p>
            <p style="color: #555; line-height: 1.8; margin-bottom: 25px">
              <strong>Review Status:</strong> Watermarks like "FOR REVIEW,"
              "PENDING APPROVAL," or "SAMPLE" clarify document purpose and
              prevent final-version treatment of preliminary work.
            </p>

            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              Legal and Compliance Requirements
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 25px">
              Certain industries require watermarks for regulatory compliance or
              legal protection. Law firms watermark case documents and client
              materials to maintain confidentiality and establish privilege.
              Healthcare providers add watermarks to patient documents to
              indicate privacy protections under HIPAA. Financial institutions
              watermark statements and reports to prevent fraud and establish
              authenticity. Government agencies use watermarks to classify
              document sensitivity and control information distribution. These
              watermarks aren't just brandingâ€”they're essential components of
              compliance programs and legal risk management.
            </p>

            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              Preventing Unauthorized Distribution
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 25px">
              Watermarks make unauthorized distribution less attractive and
              easier to trace. When sharing documents publicly or with limited
              audiences, watermarks discourage recipients from redistributing
              content without permission. If watermarked content appears
              somewhere it shouldn't, the watermark helps track the source of
              the leak. For subscription services, educational content, and
              proprietary research, watermarks protect revenue by making it
              obvious when content has been shared beyond its intended audience.
              Some organizations use personalized watermarks (including
              recipient names or tracking codes) to trace distribution and
              enforce usage agreements.
            </p>

            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              Adding Value to Free Samples
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 25px">
              When offering free PDF contentâ€”such as ebooks, templates, reports,
              or guidesâ€”watermarks protect the full value of your work while
              still providing useful samples. "SAMPLE" or "PREVIEW" watermarks
              let potential customers evaluate your content quality while
              preventing the free version from substituting for the paid
              version. This approach is particularly effective for educational
              materials, stock assets, design templates, and research reports
              where you want to demonstrate value without giving away the entire
              product. The watermark reminds users they're viewing a limited
              version and directs them toward purchasing the full, unmarked
              version.
            </p>

            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              Tracking and Attribution
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 25px">
              Watermarks help track how documents circulate and ensure proper
              attribution. When your watermarked PDF appears online, in
              presentations, or in other contexts, the watermark ensures you
              receive credit. This is valuable for thought leadership, research
              publications, and creative work where attribution drives
              reputation and opportunities. The watermark acts as a persistent
              link back to the source, helping people find more of your work and
              contact you for permissions or collaborations. Even if someone
              removes metadata or changes filenames, the visible watermark
              maintains the connection to your identity or organization.
            </p>
          </div>
        </div>
      </section>

      <!-- Features Section -->
      <section class="benefits" style="padding-top: 60px">
        <div class="container">
          <h2>Powerful Watermark Features</h2>
          <div class="feature-grid">
            <div class="feature-card">
              <i
                class="fas fa-font"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Text Watermarks</h3>
              <p>
                Add custom text with full font control, color selection, size
                adjustment, and styling options including bold, italic, and
                underline.
              </p>
            </div>
            <div class="feature-card">
              <i
                class="fas fa-image"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Image Watermarks</h3>
              <p>
                Upload logos, signatures, or custom graphics as watermarks.
                Resize and position images exactly where you need them.
              </p>
            </div>
            <div class="feature-card">
              <i
                class="fas fa-arrows-alt"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Custom Positioning</h3>
              <p>
                Drag and drop watermarks to any location. Choose preset
                positions or manually place watermarks with pixel precision.
              </p>
            </div>
            <div class="feature-card">
              <i
                class="fas fa-adjust"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Opacity Control</h3>
              <p>
                Adjust watermark transparency from subtle background marks to
                bold foreground declarations. Perfect balance for any use case.
              </p>
            </div>
            <div class="feature-card">
              <i
                class="fas fa-redo"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Rotation Options</h3>
              <p>
                Rotate watermarks to any angle for diagonal placement or to
                match document orientation. Full 360-degree control.
              </p>
            </div>
            <div class="feature-card">
              <i
                class="fas fa-clone"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Apply to All Pages</h3>
              <p>
                Position watermark on one page and apply identical placement to
                all pages instantly. Consistent branding across documents.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- Tips Section -->
      <section class="features" style="background: white">
        <div class="container">
          <h2>Watermark Design Tips and Best Practices</h2>
          <div style="max-width: 900px; margin: 0 auto; text-align: left">
            <div style="margin-bottom: 40px">
              <h3 style="color: #1e3a8a; margin-bottom: 15px">
                Choosing Between Text and Image Watermarks
              </h3>
              <p style="color: #555; line-height: 1.8; margin-bottom: 15px">
                The choice between text and image watermarks depends on your
                goals and branding needs:
              </p>
              <p style="color: #555; line-height: 1.8; margin-bottom: 10px">
                <strong>Text Watermarks Work Best For:</strong> Copyright
                notices (Â© 2024 Company Name), confidentiality markers
                (CONFIDENTIAL, DRAFT), simple branding with company names, date
                and time stamps, and status indicators. Text watermarks are
                clearer at small sizes, easier to read, and create minimal
                visual distraction.
              </p>
              <p style="color: #555; line-height: 1.8; margin-bottom: 20px">
                <strong>Image Watermarks Work Best For:</strong> Company logos
                for brand recognition, signature graphics for personal branding,
                complex designs or seals, visual brand elements that can't be
                replicated with text, and situations where visual impact matters
                more than readability. Images can convey more information in
                less space but require careful sizing to remain visible without
                overwhelming content.
              </p>
            </div>

            <div style="margin-bottom: 40px">
              <h3 style="color: #1e3a8a; margin-bottom: 15px">
                Opacity and Visibility Balance
              </h3>
              <p style="color: #555; line-height: 1.8; margin-bottom: 15px">
                Finding the right opacity is crucial for effective watermarking:
              </p>
              <p style="color: #555; line-height: 1.8; margin-bottom: 10px">
                <strong>High Opacity (70-100%):</strong> Use for strong
                copyright protection, preview/sample watermarks, or when you
                want watermarks to be the dominant visual element. This works
                well for draft documents or samples where you deliberately want
                to limit usability.
              </p>
              <p style="color: #555; line-height: 1.8; margin-bottom: 10px">
                <strong>Medium Opacity (40-70%):</strong> Ideal for professional
                branding on finished documents. Watermarks are clearly visible
                but don't dominate the page. Good for company logos on reports
                or photographer watermarks on portfolios.
              </p>
              <p style="color: #555; line-height: 1.8; margin-bottom: 20px">
                <strong>Low Opacity (10-40%):</strong> Creates subtle background
                watermarks that establish ownership without distracting from
                content. Perfect for legal documents, academic papers, or any
                situation where content readability is paramount but you still
                want to mark ownership.
              </p>
            </div>

            <div style="margin-bottom: 40px">
              <h3 style="color: #1e3a8a; margin-bottom: 15px">
                Strategic Watermark Positioning
              </h3>
              <p style="color: #555; line-height: 1.8; margin-bottom: 15px">
                Watermark placement affects both protection effectiveness and
                document usability:
              </p>
              <ul
                style="
                  color: #555;
                  line-height: 1.8;
                  margin-bottom: 20px;
                  padding-left: 25px;
                "
              >
                <li style="margin-bottom: 10px">
                  <strong>Center Placement:</strong> Most visible and difficult
                  to crop out. Ideal for maximum protection on images, design
                  work, or samples you want to strongly watermark.
                </li>
                <li style="margin-bottom: 10px">
                  <strong>Corner Placement:</strong> Less intrusive while
                  maintaining visibility. Professional looking for business
                  documents, reports, and presentations where you want branding
                  without distraction.
                </li>
                <li style="margin-bottom: 10px">
                  <strong>Diagonal Placement:</strong> Crossing the entire page
                  diagonally makes removal very difficult while distributing
                  visual weight evenly. Excellent for draft documents or
                  confidential materials.
                </li>
                <li style="margin-bottom: 10px">
                  <strong>Edge Placement:</strong> Along page borders or
                  margins. Subtle but permanent, good for archival documents or
                  situations where you need to mark ownership without affecting
                  content usability.
                </li>
              </ul>
            </div>

            <div style="margin-bottom: 40px">
              <h3 style="color: #1e3a8a; margin-bottom: 15px">
                Font Selection for Text Watermarks
              </h3>
              <p style="color: #555; line-height: 1.8; margin-bottom: 15px">
                Font choice affects readability and professional appearance:
              </p>
              <p style="color: #555; line-height: 1.8; margin-bottom: 10px">
                <strong>Sans-serif fonts (Helvetica, Arial):</strong> Clean,
                modern appearance. Excellent readability even at small sizes or
                low opacity. Best for professional business documents and
                contemporary branding.
              </p>
              <p style="color: #555; line-height: 1.8; margin-bottom: 10px">
                <strong>Serif fonts (Times Roman):</strong> Traditional,
                authoritative look. Appropriate for legal documents, academic
                work, and situations requiring a more formal appearance.
              </p>
              <p style="color: #555; line-height: 1.8; margin-bottom: 20px">
                <strong>Monospace fonts (Courier):</strong> Distinctive
                appearance, good for technical documents or when you want
                watermarks to stand apart from document text.
              </p>
            </div>

            <div style="margin-bottom: 40px">
              <h3 style="color: #1e3a8a; margin-bottom: 15px">
                Color Psychology and Selection
              </h3>
              <p style="color: #555; line-height: 1.8; margin-bottom: 15px">
                Watermark color impacts visibility and emotional response:
              </p>
              <ul
                style="
                  color: #555;
                  line-height: 1.8;
                  margin-bottom: 20px;
                  padding-left: 25px;
                "
              >
                <li style="margin-bottom: 10px">
                  <strong>Black or Dark Gray:</strong> Professional,
                  authoritative, works well on light backgrounds. Classic choice
                  for copyright notices and business branding.
                </li>
                <li style="margin-bottom: 10px">
                  <strong>White or Light Gray:</strong> Subtle, elegant, ideal
                  for dark backgrounds or when you want watermarks barely
                  perceptible. Good for artistic work where heavy watermarking
                  would detract from aesthetics.
                </li>
                <li style="margin-bottom: 10px">
                  <strong>Brand Colors:</strong> Reinforce company identity
                  using corporate colors. Maintains brand consistency across all
                  materials.
                </li>
                <li style="margin-bottom: 10px">
                  <strong>Red:</strong> Attention-grabbing, excellent for DRAFT
                  or CONFIDENTIAL markers. Psychologically signals importance
                  and urgency.
                </li>
              </ul>
            </div>

            <div style="margin-bottom: 40px">
              <h3 style="color: #1e3a8a; margin-bottom: 15px">
                Image Watermark Optimization
              </h3>
              <p style="color: #555; line-height: 1.8; margin-bottom: 15px">
                When using logos or graphics as watermarks:
              </p>
              <ul
                style="
                  color: #555;
                  line-height: 1.8;
                  margin-bottom: 20px;
                  padding-left: 25px;
                "
              >
                <li style="margin-bottom: 10px">
                  Use PNG format with transparent backgrounds for clean
                  integration over any document content
                </li>
                <li style="margin-bottom: 10px">
                  Ensure logos are high-resolution to avoid pixelation when
                  resized
                </li>
                <li style="margin-bottom: 10px">
                  Simplify complex logos for watermark useâ€”intricate details may
                  become muddy at smaller sizes
                </li>
                <li style="margin-bottom: 10px">
                  Consider creating a dedicated watermark version of your logo
                  with optimized opacity
                </li>
                <li style="margin-bottom: 10px">
                  Test watermark visibility on various background colors and
                  content types
                </li>
              </ul>
            </div>

            <div style="margin-bottom: 40px">
              <h3 style="color: #1e3a8a; margin-bottom: 15px">
                Page Range Strategies
              </h3>
              <p style="color: #555; line-height: 1.8; margin-bottom: 15px">
                Strategic page selection can enhance watermark effectiveness:
              </p>
              <p style="color: #555; line-height: 1.8; margin-bottom: 10px">
                <strong>All Pages:</strong> Maximum protection and consistent
                branding. Appropriate for most business documents, portfolios,
                and confidential materials.
              </p>
              <p style="color: #555; line-height: 1.8; margin-bottom: 10px">
                <strong>First Page Only:</strong> Establishes ownership without
                affecting content readability on subsequent pages. Good for
                reports or documents where you want minimal visual interference.
              </p>
              <p style="color: #555; line-height: 1.8; margin-bottom: 10px">
                <strong>Odd or Even Pages:</strong> Creates a lighter watermark
                presence while maintaining protection. Can be effective for
                printed documents.
              </p>
              <p style="color: #555; line-height: 1.8; margin-bottom: 20px">
                <strong>Custom Ranges:</strong> Watermark only specific sections
                (like sensitive data pages) while leaving other content
                unwatermarked for clarity.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- FAQ Section -->
      <section class="features" style="background: #f9fafb">
        <div class="container">
          <h2>Frequently Asked Questions About PDF Watermarks</h2>
          <div style="max-width: 800px; margin: 0 auto; text-align: left">
            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Can watermarks be removed from PDFs?
              </h3>
              <p style="color: #555; line-height: 1.8">
                While watermarks can technically be removed with advanced
                editing tools, the process is time-consuming and often leaves
                visible artifacts. Watermarks serve as a deterrent to casual
                unauthorized use. For maximum protection, combine watermarks
                with other security measures like password protection.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                What's the difference between text and image watermarks?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Text watermarks display custom text (like copyright notices or
                company names) with adjustable font, size, and color. Image
                watermarks use logos, graphics, or signatures. Text watermarks
                are better for simple messages and remain clear at any size.
                Image watermarks are ideal for branding with company logos or
                complex graphics.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                How do I choose the right opacity level?
              </h3>
              <p style="color: #555; line-height: 1.8">
                For strong protection (like sample documents), use 60-80%
                opacity so watermarks are prominent. For professional documents
                where you want to mark ownership without heavy visual impact,
                20-40% opacity works well. Preview different opacity levels to
                find the right balance for your specific needs.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Can I watermark specific pages only?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Yes. Use the page range feature to apply watermarks only to
                specific pages. You can watermark just the first page, certain
                page ranges, or all pages. This is useful when you want to
                protect specific sections while leaving others unmarked for
                clarity.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Will watermarks affect PDF file size?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Text watermarks add minimal file size. Image watermarks increase
                file size depending on image resolution and complexity. For most
                documents, the increase is negligible. If file size is a
                concern, compress your watermarked PDF afterward using our
                compression tool.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Can I use my company logo as a watermark?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Absolutely. Upload your logo as an image watermark. PNG format
                with transparent background works best. You can resize,
                position, and adjust opacity to integrate your logo perfectly
                with document content while maintaining brand visibility.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                How do I watermark multiple PDFs at once?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Upload multiple PDF files simultaneously. Configure your
                watermark settings once, and they'll be applied consistently
                across all documents. This batch processing saves significant
                time when watermarking large document collections.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Can watermarks be rotated?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Yes. Rotate watermarks to any angle from -180 to +180 degrees.
                Diagonal watermarks (typically 45 degrees) are particularly
                effective for protection as they're harder to crop out while
                distributing visual weight evenly across the page.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Will watermarks print on paper?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Yes. Watermarks are permanently embedded in the PDF and will
                print along with document content. Very low opacity watermarks
                may be less visible when printed, so test print a page if print
                appearance is important for your use case.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Can I preview watermarks before applying?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Yes. Our tool shows live preview of watermarks on your PDF pages
                as you adjust settings. You can see exactly how watermarks will
                look, test different positions, and adjust styling before
                downloading the final watermarked PDF.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Are watermarks permanent?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Yes. Once you download your watermarked PDF, the watermarks are
                permanently embedded. Your original file remains unchanged. If
                you need to modify watermarks, start over with the original PDF
                and apply new watermark settings.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                What file formats are supported for image watermarks?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Common image formats are supported: PNG, JPG, JPEG, GIF, and
                more. PNG format with transparent backgrounds is recommended for
                best integration. Upload your image, and our tool handles the
                conversion and placement automatically.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- Related Tools Section -->
      <section class="benefits" style="background: white; padding-top: 60px">
        <div class="container">
          <h2>Related PDF Protection Tools</h2>
          <div class="feature-grid">
            <div class="feature-card">
              <i
                class="fas fa-lock"
                style="font-size: 40px; color: #4f46e5; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Protect PDF</h3>
              <p>
                Add password encryption to watermarked documents for maximum
                security. Combine watermarks with password protection.
              </p>
              <a
                href="/protect-pdf"
                class="cta-button"
                style="font-size: 14px; padding: 8px 16px; margin-top: 10px"
                >Use Tool</a
              >
            </div>
            <div class="feature-card">
              <i
                class="fas fa-sort-numeric-up"
                style="font-size: 40px; color: #4f46e5; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Add Page Numbers</h3>
              <p>
                Add professional page numbering to watermarked documents.
                Combine watermarks with page numbers for complete branding.
              </p>
              <a
                href="/page-number"
                class="cta-button"
                style="font-size: 14px; padding: 8px 16px; margin-top: 10px"
                >Use Tool</a
              >
            </div>
            <div class="feature-card">
              <i
                class="fas fa-file-pdf"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>PDF to PDF/A</h3>
              <p>
                Convert watermarked PDFs to archival format for long-term
                storage with embedded protection.
              </p>
              <a
                href="/pdf-to-pdfa"
                class="cta-button"
                style="font-size: 14px; padding: 8px 16px; margin-top: 10px"
                >Use Tool</a
              >
            </div>
            <div class="feature-card">
              <i
                class="fas fa-object-group"
                style="font-size: 40px; color: #4f46e5; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Merge PDF</h3>
              <p>
                Combine multiple watermarked PDFs into single documents while
                preserving all watermarks.
              </p>
              <a
                href="/merge"
                class="cta-button"
                style="font-size: 14px; padding: 8px 16px; margin-top: 10px"
                >Use Tool</a
              >
            </div>
            <div class="feature-card">
              <i
                class="fas fa-compress"
                style="font-size: 40px; color: #f59e0b; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Compress PDF</h3>
              <p>
                Reduce file size of watermarked PDFs for easier sharing while
                maintaining watermark quality.
              </p>
              <a
                href="/compress-pdf"
                class="cta-button"
                style="font-size: 14px; padding: 8px 16px; margin-top: 10px"
                >Use Tool</a
              >
            </div>
            <div class="feature-card">
              <i
                class="fas fa-edit"
                style="font-size: 40px; color: #4f46e5; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Edit PDF</h3>
              <p>
                Make content changes before adding watermarks. Edit text and
                images, then apply protection.
              </p>
              <a
                href="/edit"
                class="cta-button"
                style="font-size: 14px; padding: 8px 16px; margin-top: 10px"
                >Use Tool</a
              >
            </div>
          </div>
        </div>
      </section>

      <!-- CTA Section -->
      <section class="hero">
        <div class="container">
          <h2 style="font-size: 32px; margin-bottom: 15px">
            Ready to Protect Your PDFs?
          </h2>
          <p style="margin-bottom: 25px">
            Add professional watermarks instantly. Protect copyright and
            establish ownership with custom text or logos.
          </p>
          <a
            href="#"
            class="cta-button"
            onclick="
              window.scrollTo({ top: 0, behavior: 'smooth' });
              return false;
            "
            aria-label="Scroll to top to add watermark"
          >
            <i class="fa fa-stamp" aria-hidden="true"></i> Start Adding
            Watermarks
          </a>
        </div>
      </section>
    </main>

    <section id="footer-placeholder"></section>

    <script src="./js/app.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
      const BACKEND_URL = `${BACKEND_BASE_URL}/add-watermark`;
      const pdfUpload = document.getElementById("pdfUpload");
      const fileList = document.getElementById("fileList");
      const pagesGrid = document.getElementById("pagesGrid");
      const wmOptions = document.getElementById("wmOptions");
      const errorMsg = document.getElementById("errorMsg");
      const successMsg = document.getElementById("successMsg");
      const watermarkBtn = document.getElementById("watermarkBtn");
      const uploadSection = document.getElementById("uploadSection");
      const resultBtns = document.getElementById("resultBtns");
      const downloadBtn = document.getElementById("downloadBtn");
      const shareBtn = document.getElementById("shareBtn");
      const resetBtn = document.getElementById("resetBtn");
      const pdfPreview = document.getElementById("pdfPreview");
      const pdfFrame = document.getElementById("pdfFrame");
      const fileNameLink = document.getElementById("fileNameLink");

      const wmText = document.getElementById("wmText");
      const wmImage = document.getElementById("wmImage");
      const fontSize = document.getElementById("fontSize");
      const opacity = document.getElementById("opacity");
      const position = document.getElementById("position");
      const rotation = document.getElementById("rotation");
      const fontFamily = document.getElementById("fontFamily");
      const pageStart = document.getElementById("pageStart");
      const pageEnd = document.getElementById("pageEnd");
      const textColor = document.getElementById("textColor");
      const textColorHex = document.getElementById("textColorHex");

      const boldBtn = document.getElementById("boldBtn");
      const italicBtn = document.getElementById("italicBtn");
      const underlineBtn = document.getElementById("underlineBtn");

      const fontSizeGroup = document.getElementById("fontSizeGroup");
      const fontFamilyGroup = document.getElementById("fontFamilyGroup");

      let files = [];
      let watermarkData = {
        bold: false,
        italic: false,
        underline: false,
      };
      let totalPagesCount = 0;

      pdfjsLib.GlobalWorkerOptions.workerSrc =
        "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";

      function applyTransform(el, isCenter) {
        const rot = parseFloat(rotation.value) || 0;

        if (isCenter) {
          el.style.transform = `translate(-50%, -50%) rotate(${rot}deg)`;
        } else {
          el.style.transform = `rotate(${rot}deg)`;
        }
      }

      function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
          const later = () => {
            clearTimeout(timeout);
            func(...args);
          };
          clearTimeout(timeout);
          timeout = setTimeout(later, wait);
        };
      }

      textColor.oninput = () => {
        textColorHex.value = textColor.value.toUpperCase();
        updatePreview();
      };

      textColorHex.oninput = () => {
        const hex = textColorHex.value;
        if (/^#[0-9A-F]{6}$/i.test(hex)) {
          textColor.value = hex;
          updatePreview();
        }
      };

      function showError(msg) {
        errorMsg.textContent = msg;
        errorMsg.style.display = "block";
        successMsg.classList.remove("show");
      }

      function clearError() {
        errorMsg.textContent = "";
        errorMsg.style.display = "none";
      }

      function showSuccess(msg) {
        successMsg.textContent = msg;
        successMsg.classList.add("show");
        clearError();
        setTimeout(() => successMsg.classList.remove("show"), 3000);
      }

      document.querySelectorAll("input[name='wmType']").forEach((r) => {
        r.onchange = () => {
          clearError();
          const isText = r.value === "text";
          document.getElementById("textControls").style.display = isText
            ? "flex"
            : "none";
          document.getElementById("imageControls").style.display = isText
            ? "none"
            : "block";
          updatePreview();
        };
      });

      boldBtn.onclick = () => {
        watermarkData.bold = !watermarkData.bold;
        boldBtn.classList.toggle("active", watermarkData.bold);
        boldBtn.setAttribute("aria-pressed", watermarkData.bold);
        updatePreview();
      };

      italicBtn.onclick = () => {
        watermarkData.italic = !watermarkData.italic;
        italicBtn.classList.toggle("active", watermarkData.italic);
        italicBtn.setAttribute("aria-pressed", watermarkData.italic);
        updatePreview();
      };

      underlineBtn.onclick = () => {
        watermarkData.underline = !watermarkData.underline;
        underlineBtn.classList.toggle("active", watermarkData.underline);
        underlineBtn.setAttribute("aria-pressed", watermarkData.underline);
        updatePreview();
      };

      pdfUpload.onchange = (e) => {
        clearError();
        const newFiles = [...e.target.files];
        newFiles.forEach((f) => {
          if (!files.some((x) => x.name === f.name && x.size === f.size))
            files.push(f);
        });
        renderFileList();
        loadAllPDFs();
      };

      function renderFileList() {
        if (files.length === 0) {
          fileList.style.display = "none";
          pagesGrid.style.display = "none";
          wmOptions.style.display = "none";
          return;
        }
        fileList.style.display = "block";
        fileList.innerHTML = "";
        files.forEach((f, i) => {
          const li = document.createElement("li");
          li.innerHTML = `<i class="fa fa-file-pdf pdf-icon"></i> <span>${f.name}</span> <i class="fa fa-times delete-file" role="button" aria-label="Remove ${f.name}" tabindex="0"></i>`;
          li.querySelector(".delete-file").onclick = () => {
            files.splice(i, 1);
            pdfUpload.value = "";
            renderFileList();
            loadAllPDFs();
          };
          fileList.appendChild(li);
        });
      }

      async function loadAllPDFs() {
        pagesGrid.innerHTML = "";
        if (files.length === 0) return;

        pagesGrid.style.display = "flex";
        wmOptions.style.display = "block";
        totalPagesCount = 0;

        for (let file of files) {
          const pdf = await pdfjsLib.getDocument(URL.createObjectURL(file))
            .promise;

          for (let i = 1; i <= pdf.numPages; i++) {
            totalPagesCount++;
            const page = await pdf.getPage(i);

            const maxWidth =
              window.innerWidth < 768 ? window.innerWidth - 40 : 800;
            const viewport = page.getViewport({ scale: 1 });
            const displayScale = Math.min(maxWidth / viewport.width, 1);

            const renderScale = displayScale * (window.devicePixelRatio || 2);
            const scaledViewport = page.getViewport({ scale: renderScale });

            const canvas = document.createElement("canvas");
            canvas.width = scaledViewport.width;
            canvas.height = scaledViewport.height;

            await page.render({
              canvasContext: canvas.getContext("2d"),
              viewport: scaledViewport,
            }).promise;

            const card = document.createElement("div");
            card.className = "page-card";
            card.dataset.pageNum = totalPagesCount;
            card.dataset.scale = displayScale;
            card.dataset.baseWidth = viewport.width;
            card.setAttribute("role", "article");
            card.setAttribute("aria-label", `Page ${totalPagesCount}`);

            const badge = document.createElement("div");
            badge.className = "page-number-badge";
            badge.textContent = `Page ${totalPagesCount}`;
            badge.setAttribute("aria-hidden", "true");
            card.appendChild(badge);

            canvas.style.width = viewport.width * displayScale + "px";
            canvas.style.height = viewport.height * displayScale + "px";
            card.appendChild(canvas);

            const applyBtn = document.createElement("button");
            applyBtn.className = "page-apply-btn";
            applyBtn.innerHTML =
              '<i class="fa fa-clone" aria-hidden="true"></i> Apply to All';
            applyBtn.setAttribute(
              "aria-label",
              "Apply this watermark position to all pages",
            );
            applyBtn.onclick = () => applyThisPageToAll(card);
            card.appendChild(applyBtn);

            pagesGrid.appendChild(card);
          }
        }

        updatePageRangeDisplay();
        updatePreview();
      }

      function updatePageRangeDisplay() {
        const start = parseInt(pageStart.value) || 1;
        const end = parseInt(pageEnd.value) || totalPagesCount;
        const effectiveEnd =
          end === 0 ? totalPagesCount : Math.min(end, totalPagesCount);

        document.querySelectorAll(".page-card").forEach((card) => {
          const pageNum = parseInt(card.dataset.pageNum);
          if (pageNum < start || pageNum > effectiveEnd) {
            card.classList.add("out-of-range");
          } else {
            card.classList.remove("out-of-range");
          }
        });

        updatePreview();
      }

      function getPreviewFont(pdfFont) {
        const map = {
          Helvetica: "Arial, sans-serif",
          "Helvetica-Bold": "Arial Black, Arial, sans-serif",
          Courier: "Courier New, monospace",
          "Times-Roman": "Times New Roman, serif",
        };
        return map[pdfFont] || "Arial, sans-serif";
      }

      function getWatermarkDimensions(el) {
        const currentTransform = el.style.transform;
        el.style.transform = "translate(-50%, -50%)";

        const rect = el.getBoundingClientRect();
        const baseWidth = rect.width;
        const baseHeight = rect.height;

        el.style.transform = currentTransform;

        const rotationRad = ((parseFloat(rotation.value) || 0) * Math.PI) / 180;
        const cos = Math.abs(Math.cos(rotationRad));
        const sin = Math.abs(Math.sin(rotationRad));

        const rotatedWidth = baseWidth * cos + baseHeight * sin;
        const rotatedHeight = baseWidth * sin + baseHeight * cos;

        return {
          width: rotatedWidth,
          height: rotatedHeight,
          baseWidth: baseWidth,
          baseHeight: baseHeight,
        };
      }

      function updatePreview() {
        clearError();
        const type = document.querySelector(
          "input[name='wmType']:checked",
        ).value;

        document.querySelectorAll(".page-card").forEach((card) => {
          const old = card.querySelector(".watermark-preview");

          let storedLeft = null;
          let storedTop = null;
          let storedTransform = null;
          let storedCanvasLeft = null;
          let storedCanvasTop = null;

          if (old && (old.dataset.actualLeft || old.dataset.actualTop)) {
            storedLeft = old.dataset.actualLeft;
            storedTop = old.dataset.actualTop;
            storedTransform = old.style.transform;
            storedCanvasLeft = old.dataset.canvasLeft;
            storedCanvasTop = old.dataset.canvasTop;
          }

          if (old) old.remove();

          if (card.classList.contains("out-of-range")) return;

          const canvas = card.querySelector("canvas");
          const wm = document.createElement("div");
          wm.className = "watermark-preview";
          wm.style.opacity = opacity.value;
          const visualScale =
            canvas.offsetWidth / parseFloat(card.dataset.baseWidth);

          wm.style.fontSize = fontSize.value * visualScale + "px";

          const rotationValue = parseFloat(rotation.value) || 0;

          if (type === "image") {
            if (!wmImage.files[0]) return;
            wm.classList.add("has-image");
            const img = document.createElement("img");
            img.src = URL.createObjectURL(wmImage.files[0]);
            img.alt = "Watermark image";
            const baseImgWidth = card.dataset.imgWidth
              ? parseFloat(card.dataset.imgWidth)
              : 150;

            img.style.width = baseImgWidth * visualScale + "px";
            img.style.height = "auto";

            wm.appendChild(img);
          } else {
            wm.innerText = wmText.value;
            wm.style.color = textColor.value;
            wm.style.fontWeight = watermarkData.bold ? "bold" : "normal";
            wm.style.fontStyle = watermarkData.italic ? "italic" : "normal";
            wm.style.textDecoration = watermarkData.underline
              ? "underline"
              : "none";
            wm.style.fontFamily = getPreviewFont(fontFamily.value);
          }

          wm.style.position = "absolute";
          wm.style.left = "-9999px";
          wm.style.top = "-9999px";
          applyTransform(wm, false);
          card.appendChild(wm);

          const dims = getWatermarkDimensions(wm);
          const padding = 10;
          const canvasOffsetLeft = canvas.offsetLeft;
          const canvasOffsetTop = canvas.offsetTop;

          let left, top;

          if (storedLeft && storedTop) {
            left = parseFloat(storedLeft);
            top = parseFloat(storedTop);
            applyTransform(wm, position.value === "center");
            wm.dataset.actualLeft = storedLeft;
            wm.dataset.actualTop = storedTop;
            if (storedCanvasLeft) wm.dataset.canvasLeft = storedCanvasLeft;
            if (storedCanvasTop) wm.dataset.canvasTop = storedCanvasTop;
          } else {
            switch (position.value) {
              case "top-left":
                left = canvasOffsetLeft + padding;
                top = canvasOffsetTop + padding;
                applyTransform(wm, false);
                break;

              case "top-right":
                left =
                  canvasOffsetLeft + canvas.offsetWidth - dims.width - padding;
                top = canvasOffsetTop + padding;
                applyTransform(wm, false);
                break;

              case "bottom-left":
                left = canvasOffsetLeft + padding;
                top =
                  canvasOffsetTop + canvas.offsetHeight - dims.height - padding;
                applyTransform(wm, false);
                break;

              case "bottom-right":
                left =
                  canvasOffsetLeft + canvas.offsetWidth - dims.width - padding;
                top =
                  canvasOffsetTop + canvas.offsetHeight - dims.height - padding;
                applyTransform(wm, false);
                break;

              default:
                left = canvasOffsetLeft + canvas.offsetWidth / 2;
                top = canvasOffsetTop + canvas.offsetHeight / 2;
                applyTransform(wm, true);
            }
          }

          wm.style.left = left + "px";
          wm.style.top = top + "px";

          if (type === "image") {
            const handles = ["tl", "tr", "bl", "br"];
            handles.forEach((pos) => {
              const handle = document.createElement("div");
              handle.className = `resize-handle resize-handle-${pos}`;
              handle.setAttribute("role", "button");
              handle.setAttribute(
                "aria-label",
                `Resize watermark from ${pos} corner`,
              );
              wm.appendChild(handle);
              makeResizable(wm, wm.querySelector("img"), handle, pos, card);
            });
          }

          makeDraggable(wm, card);
        });
      }

      function makeDraggable(el, card) {
        el.addEventListener("pointerdown", (e) => {
          if (e.target.classList.contains("resize-handle")) return;

          e.preventDefault();
          el.setPointerCapture(e.pointerId);

          const canvas = card.querySelector("canvas");
          const canvasRect = canvas.getBoundingClientRect();
          const cardRect = card.getBoundingClientRect();
          const canvasOffsetLeft = canvasRect.left - cardRect.left;
          const canvasOffsetTop = canvasRect.top - cardRect.top;

          const startLeft = parseFloat(el.style.left) || 0;
          const startTop = parseFloat(el.style.top) || 0;
          const startX = e.clientX;
          const startY = e.clientY;

          function move(ev) {
            const deltaX = ev.clientX - startX;
            const deltaY = ev.clientY - startY;

            let centerX = startLeft + deltaX;
            let centerY = startTop + deltaY;

            let canvasRelativeCenterX = centerX - canvasOffsetLeft;
            let canvasRelativeCenterY = centerY - canvasOffsetTop;

            el.style.left = centerX + "px";
            el.style.top = centerY + "px";

            applyTransform(el, position.value === "center");

            el.dataset.actualLeft = centerX;
            el.dataset.actualTop = centerY;
            el.dataset.canvasLeft = canvasRelativeCenterX;
            el.dataset.canvasTop = canvasRelativeCenterY;

            const dims = getWatermarkDimensions(el);
            el.dataset.wmWidth = dims.width;
            el.dataset.wmHeight = dims.height;
            el.dataset.wmBaseWidth = dims.baseWidth;
            el.dataset.wmBaseHeight = dims.baseHeight;

            showApplyButton(card);
          }

          function up(ev) {
            el.releasePointerCapture(ev.pointerId);
            el.removeEventListener("pointermove", move);
            el.removeEventListener("pointerup", up);
          }

          el.addEventListener("pointermove", move);
          el.addEventListener("pointerup", up);
        });
      }

      function makeResizable(el, img, handle, position, card) {
        handle.addEventListener("pointerdown", (e) => {
          e.preventDefault();
          e.stopPropagation();

          handle.setPointerCapture(e.pointerId);

          const startWidth = img.offsetWidth;
          const startX = e.clientX;
          const aspectRatio = img.offsetHeight / startWidth;

          const canvas = card.querySelector("canvas");
          const visualScale =
            canvas.offsetWidth / parseFloat(card.dataset.baseWidth);

          const baseWidth =
            parseFloat(card.dataset.imgWidth) || startWidth / visualScale;

          function move(ev) {
            let diffX = ev.clientX - startX;
            let diff = position === "br" || position === "tr" ? diffX : -diffX;

            let newBaseWidth = baseWidth + diff / visualScale;
            newBaseWidth = Math.max(50, Math.min(400, newBaseWidth));

            const newWidth = newBaseWidth * visualScale;
            img.style.width = newWidth + "px";
            img.style.height = newWidth * aspectRatio + "px";

            card.dataset.imgWidth = newBaseWidth;

            const dims = getWatermarkDimensions(el);
            el.dataset.wmWidth = dims.width;
            el.dataset.wmHeight = dims.height;
            el.dataset.wmBaseWidth = dims.baseWidth;
            el.dataset.wmBaseHeight = dims.baseHeight;

            showApplyButton(card);
          }

          function up(ev) {
            handle.releasePointerCapture(ev.pointerId);
            handle.removeEventListener("pointermove", move);
            handle.removeEventListener("pointerup", up);
          }

          handle.addEventListener("pointermove", move);
          handle.addEventListener("pointerup", up);
        });
      }

      function showApplyButton(card) {
        const applyBtn = card.querySelector(".page-apply-btn");
        if (applyBtn) {
          applyBtn.classList.add("show");
        }
      }

      function applyThisPageToAll(sourceCard) {
        const sourceWm = sourceCard.querySelector(".watermark-preview");
        if (!sourceWm) return;

        const refLeft = sourceWm.dataset.actualLeft
          ? sourceWm.dataset.actualLeft + "px"
          : sourceWm.style.left;
        const refTop = sourceWm.dataset.actualTop
          ? sourceWm.dataset.actualTop + "px"
          : sourceWm.style.top;
        const refTransform = sourceWm.style.transform;

        let refWidth = null;
        let refHeight = null;
        const refImg = sourceWm.querySelector("img");
        if (refImg) {
          refWidth = refImg.style.width;
          refHeight = refImg.style.height;
        }

        document.querySelectorAll(".page-card").forEach((card) => {
          if (card.classList.contains("out-of-range")) return;
          if (card === sourceCard) return;

          const wm = card.querySelector(".watermark-preview");
          if (wm) {
            wm.style.left = refLeft;
            wm.style.top = refTop;
            wm.style.transform = refTransform;

            if (sourceWm.dataset.actualLeft)
              wm.dataset.actualLeft = sourceWm.dataset.actualLeft;
            if (sourceWm.dataset.actualTop)
              wm.dataset.actualTop = sourceWm.dataset.actualTop;
            if (sourceWm.dataset.canvasLeft)
              wm.dataset.canvasLeft = sourceWm.dataset.canvasLeft;
            if (sourceWm.dataset.canvasTop)
              wm.dataset.canvasTop = sourceWm.dataset.canvasTop;
            if (sourceWm.dataset.wmWidth)
              wm.dataset.wmWidth = sourceWm.dataset.wmWidth;
            if (sourceWm.dataset.wmHeight)
              wm.dataset.wmHeight = sourceWm.dataset.wmHeight;
            if (sourceWm.dataset.wmBaseWidth)
              wm.dataset.wmBaseWidth = sourceWm.dataset.wmBaseWidth;
            if (sourceWm.dataset.wmBaseHeight)
              wm.dataset.wmBaseHeight = sourceWm.dataset.wmBaseHeight;

            if (refWidth) {
              const img = wm.querySelector("img");
              if (img) {
                img.style.width = refWidth;
                if (refHeight) img.style.height = refHeight;
              }
            }

            if (sourceCard.dataset.imgWidth) {
              card.dataset.imgWidth = sourceCard.dataset.imgWidth;
              card.dataset.imgHeight = sourceCard.dataset.imgHeight;
            }
          }

          const applyBtn = card.querySelector(".page-apply-btn");
          if (applyBtn) {
            applyBtn.classList.remove("show");
          }
        });

        const sourceApplyBtn = sourceCard.querySelector(".page-apply-btn");
        if (sourceApplyBtn) {
          sourceApplyBtn.classList.remove("show");
        }

        showSuccess("âœ“ Applied to all pages in range!");
      }

      const debouncedUpdatePreview = debounce(updatePreview, 100);

      fontSize.addEventListener("input", debouncedUpdatePreview);
      opacity.addEventListener("input", debouncedUpdatePreview);
      rotation.addEventListener("input", debouncedUpdatePreview);

      wmText.addEventListener("input", updatePreview);
      position.addEventListener("change", () => {
        document.querySelectorAll(".watermark-preview").forEach((wm) => {
          delete wm.dataset.actualLeft;
          delete wm.dataset.actualTop;
          delete wm.dataset.canvasLeft;
          delete wm.dataset.canvasTop;
        });
        updatePreview();
      });

      fontFamily.addEventListener("change", updatePreview);

      pageStart.addEventListener(
        "input",
        debounce(updatePageRangeDisplay, 100),
      );
      pageEnd.addEventListener("input", debounce(updatePageRangeDisplay, 100));

      wmImage.addEventListener("change", updatePreview);

      watermarkBtn.onclick = async () => {
        clearError();

        if (files.length === 0) {
          showError("Please upload at least one PDF file first!");
          return;
        }

        const type = document.querySelector(
          "input[name='wmType']:checked",
        ).value;

        if (type === "text" && !wmText.value.trim()) {
          showError("Please enter watermark text!");
          return;
        }

        if (type === "image" && !wmImage.files[0]) {
          showError("Please select a watermark image!");
          return;
        }

        const pages = [];
        document.querySelectorAll(".page-card").forEach((card) => {
          const wm = card.querySelector(".watermark-preview");
          if (!wm) return;

          const canvas = card.querySelector("canvas");
          const canvasWidth = canvas.offsetWidth;
          const canvasHeight = canvas.offsetHeight;

          const canvasRect = canvas.getBoundingClientRect();
          const cardRect = card.getBoundingClientRect();
          const canvasOffsetLeft = canvasRect.left - cardRect.left;
          const canvasOffsetTop = canvasRect.top - cardRect.top;

          const dims = getWatermarkDimensions(wm);
          const wmWidth = dims.width;
          const wmHeight = dims.height;

          let canvasRelativeX, canvasRelativeY;

          const isCenterTransform = wm.style.transform.includes(
            "translate(-50%, -50%)",
          );

          if (wm.dataset.actualLeft && wm.dataset.actualTop) {
            const cardRelativeLeft = parseFloat(wm.dataset.actualLeft);
            const cardRelativeTop = parseFloat(wm.dataset.actualTop);

            canvasRelativeX = cardRelativeLeft - canvasOffsetLeft;
            canvasRelativeY = cardRelativeTop - canvasOffsetTop;

            if (!isCenterTransform) {
              canvasRelativeX += wmWidth / 2;
              canvasRelativeY += wmHeight / 2;
            }
          } else {
            const cardRelativeLeft = parseFloat(wm.style.left);
            const cardRelativeTop = parseFloat(wm.style.top);

            canvasRelativeX = cardRelativeLeft - canvasOffsetLeft;
            canvasRelativeY = cardRelativeTop - canvasOffsetTop;

            if (!isCenterTransform) {
              canvasRelativeX += wmWidth / 2;
              canvasRelativeY += wmHeight / 2;
            }
          }

          const leftPercent = (canvasRelativeX / canvasWidth) * 100;
          const topPercent = (canvasRelativeY / canvasHeight) * 100;

          let alignment = "center";
          switch (position.value) {
            case "top-left":
            case "bottom-left":
              alignment = "left";
              break;
            case "top-right":
            case "bottom-right":
              alignment = "right";
              break;
            default:
              alignment = "center";
          }

          const pageData = {
            pageNum: parseInt(card.dataset.pageNum),
            left: leftPercent + "%",
            top: topPercent + "%",
            rotation: -parseFloat(rotation.value),
            position: alignment,
          };

          if (type === "image") {
            const img = wm.querySelector("img");
            if (img) {
              const imgWidthPercent = (img.offsetWidth / canvasWidth) * 100;
              pageData.widthPercent = imgWidthPercent;
            }
          }

          pages.push(pageData);
        });

        const formData = new FormData();
        files.forEach((f) => formData.append("files", f));

        formData.append("type", type);
        formData.append("text", wmText.value);
        formData.append("fontSize", fontSize.value);
        formData.append("opacity", opacity.value);
        formData.append("rotation", rotation.value);
        formData.append("fontFamily", fontFamily.value);
        formData.append("color", textColor.value);
        formData.append("bold", watermarkData.bold);
        formData.append("italic", watermarkData.italic);
        formData.append("underline", watermarkData.underline);
        formData.append("pageStart", pageStart.value);
        formData.append("pageEnd", pageEnd.value);
        formData.append("positions", JSON.stringify(pages));

        if (type === "image") {
          formData.append("image", wmImage.files[0]);
        }

        watermarkBtn.disabled = true;
        watermarkBtn.classList.add("btn-loading");
        watermarkBtn.querySelector(".btn-spinner").style.display =
          "inline-block";
        watermarkBtn.querySelector(".btn-text").style.display = "none";

        try {
          const res = await fetch(BACKEND_URL, {
            method: "POST",
            body: formData,
          });

          if (!res.ok) throw new Error("Failed to add watermark");

          const blob = await res.blob();
          const url = URL.createObjectURL(blob);

          downloadBtn.href = url;
          downloadBtn.download = "watermarked.pdf";
          shareBtn.href = url;

          uploadSection.style.display = "none";
          fileList.style.display = "none";
          pagesGrid.style.display = "none";
          wmOptions.style.display = "none";
          watermarkBtn.style.display = "none";
          errorMsg.style.display = "none";
          document.querySelector(".note-box").style.display = "none";
          resultBtns.style.display = "block";

          const isSmallDevice = window.matchMedia("(max-width: 768px)").matches;

          if (!isSmallDevice) {
            pdfFrame.src = url;
            pdfPreview.style.display = "block";
          }

          fileNameLink.onclick = (e) => {
            e.preventDefault();
            isSmallDevice
              ? window.open(url, "_blank")
              : pdfPreview.scrollIntoView({ behavior: "smooth" });
          };
          window.scrollTo({ top: 0, behavior: "smooth" });
        } catch (error) {
          showError("Error: " + error.message);
        } finally {
          watermarkBtn.disabled = false;
          watermarkBtn.classList.remove("btn-loading");
          watermarkBtn.querySelector(".btn-spinner").style.display = "none";
          watermarkBtn.querySelector(".btn-text").style.display =
            "inline-block";
        }
      };

      resetBtn.onclick = () => {
        clearError();
        successMsg.classList.remove("show");
        files = [];
        totalPagesCount = 0;
        pdfUpload.value = "";
        uploadSection.style.display = "block";
        fileList.innerHTML = "";
        fileList.style.display = "none";
        pagesGrid.innerHTML = "";
        pagesGrid.style.display = "none";
        wmOptions.style.display = "none";
        watermarkBtn.style.display = "inline-flex";
        watermarkBtn.disabled = false;
        resultBtns.style.display = "none";
        document.querySelector(".note-box").style.display = "block";

        wmText.value = "";
        fontSize.value = 36;
        opacity.value = 0.3;
        rotation.value = 0;
        position.value = "center";
        fontFamily.value = "Helvetica";
        pageStart.value = 1;
        pageEnd.value = 0;
        textColor.value = "#000000";
        textColorHex.value = "#000000";
        watermarkData = { bold: false, italic: false, underline: false };
        boldBtn.classList.remove("active");
        italicBtn.classList.remove("active");
        underlineBtn.classList.remove("active");
        boldBtn.setAttribute("aria-pressed", "false");
        italicBtn.setAttribute("aria-pressed", "false");
        underlineBtn.setAttribute("aria-pressed", "false");

        wmImage.value = "";

        document.querySelector("input[name='wmType'][value='text']").checked =
          true;
        document.getElementById("textControls").style.display = "flex";
        document.getElementById("imageControls").style.display = "none";

        pdfFrame.src = "";
        pdfPreview.style.display = "none";
        window.scrollTo({ top: 0, behavior: "smooth" });
      };
    </script>
  </body>
</html>
