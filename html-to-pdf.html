<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>HTML to PDF Online Free | NextoPDF</title>
    <meta
      name="description"
      content="Convert HTML files and websites to PDF online with advanced options."
    />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&family=Inter:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="./css/style.css" />

    <style>
      .btn-loading {
        pointer-events: none;
        opacity: 0.7;
      }
      .btn-loading .btn-text {
        display: none;
      }
      .btn-loading .btn-spinner {
        display: inline-block;
      }
      .btn-spinner {
        display: none;
      }
      #htmlUpload {
        display: none;
      }
      
      .options-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin: 20px 0;
      }
      
      .option-group {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
      }
      
      .option-group h4 {
        margin: 0 0 10px 0;
        font-size: 14px;
        color: #333;
        font-weight: 600;
      }
      
      .option-group select,
      .option-group input[type="text"] {
        width: 100%;
        padding: 8px 12px;
        border: 1px solid #ddd;
        border-radius: 6px;
        font-size: 14px;
        background: white;
      }
      
      .radio-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      
      .radio-option {
        display: flex;
        align-items: center;
        gap: 8px;
      }
      
      .radio-option input[type="radio"] {
        margin: 0;
      }
      
      .checkbox-option {
        display: flex;
        align-items: center;
        gap: 8px;
        margin: 8px 0;
      }
      
      .checkbox-option input[type="checkbox"] {
        margin: 0;
      }
      
      .url-input-section {
        background: #e8f4f8;
        border: 2px dashed #3b82f6;
        padding: 20px;
        border-radius: 8px;
        margin: 15px 0;
      }
      
      .url-input-section input[type="text"] {
        width: 100%;
        padding: 12px;
        border: 1px solid #3b82f6;
        border-radius: 6px;
        font-size: 14px;
      }
      
      .divider {
        text-align: center;
        margin: 20px 0;
        position: relative;
      }
      
      .divider::before {
        content: '';
        position: absolute;
        left: 0;
        right: 0;
        top: 50%;
        height: 1px;
        background: #ddd;
      }
      
      .divider span {
        background: white;
        padding: 0 15px;
        position: relative;
        color: #666;
        font-size: 14px;
      }
      
      .note-box {
        background: #f0f9ff;
        border-left: 4px solid #3b82f6;
        padding: 12px 16px;
        margin-top: 15px;
        font-size: 14px;
        border-radius: 4px;
      }
    </style>
  </head>

  <body>
    <section id="header-placeholder"></section>

    <section class="merge-tool">
      <div class="container">
        <h1>NextoPDF - HTML to PDF Converter</h1>
        <p>
          Convert HTML files or websites to PDF with advanced customization options
        </p>

        <div class="upload-section">
          <!-- URL Input Section -->
          <div class="url-input-section" id="urlSection">
            <h4 style="margin-top: 0;">
              <i class="fa fa-globe"></i> Convert Website URL to PDF
            </h4>
            <input 
              type="text" 
              id="urlInput" 
              placeholder="https://example.com" 
            />
          </div>

          <div class="divider">
            <span>OR</span>
          </div>

          <!-- File Upload Section -->
          <div id="uploadSection">
            <label for="htmlUpload" class="upload-label">
              <i class="fa fa-upload"></i> Choose HTML Files
            </label>
            <input type="file" id="htmlUpload" accept=".html,.htm" multiple />
          </div>

          <ul id="fileList" class="file-list" style="display: none"></ul>

          <!-- Conversion Options -->
          <div class="options-grid">
            <!-- Screen Size -->
            <div class="option-group">
              <h4><i class="fa fa-desktop"></i> Screen Size</h4>
              <select id="screenSize">
                <option value="1358">Your screen (1358px)</option>
                <option value="1920">Desktop HD (1920px)</option>
                <option value="1440">Desktop (1440px)</option>
                <option value="768">Tablet (768px)</option>
                <option value="320">Mobile (320px)</option>
              </select>
            </div>

            <!-- Page Size -->
            <div class="option-group">
              <h4><i class="fa fa-file"></i> Page Size</h4>
              <select id="pageSize">
                <option value="A4">A4 (210x297 mm)</option>
                <option value="A3">A3 (297x420 mm)</option>
                <option value="A5">A5 (148x210 mm)</option>
                <option value="US_Letter">US Letter (216x279 mm)</option>
              </select>
              <div class="checkbox-option" style="margin-top: 10px;">
                <input type="checkbox" id="longPage" />
                <label for="longPage">One long page</label>
              </div>
            </div>

            <!-- Orientation -->
            <div class="option-group">
              <h4><i class="fa fa-arrows-alt"></i> Orientation</h4>
              <div class="radio-group">
                <div class="radio-option">
                  <input type="radio" name="orientation" value="portrait" id="portrait" checked />
                  <label for="portrait">Portrait</label>
                </div>
                <div class="radio-option">
                  <input type="radio" name="orientation" value="landscape" id="landscape" />
                  <label for="landscape">Landscape</label>
                </div>
              </div>
            </div>

            <!-- Page Margin -->
            <div class="option-group">
              <h4><i class="fa fa-expand"></i> Page Margin</h4>
              <div class="radio-group">
                <div class="radio-option">
                  <input type="radio" name="margin" value="none" id="marginNone" />
                  <label for="marginNone">No margin</label>
                </div>
                <div class="radio-option">
                  <input type="radio" name="margin" value="small" id="marginSmall" checked />
                  <label for="marginSmall">Small</label>
                </div>
                <div class="radio-option">
                  <input type="radio" name="margin" value="big" id="marginBig" />
                  <label for="marginBig">Big</label>
                </div>
              </div>
            </div>
          </div>

          <!-- HTML Settings -->
          <div class="option-group" style="margin-top: 20px;">
            <h4><i class="fa fa-cog"></i> HTML Settings</h4>
            <div class="checkbox-option">
              <input type="checkbox" id="blockAds" />
              <label for="blockAds">Try to block ads</label>
            </div>
            <div class="checkbox-option">
              <input type="checkbox" id="removeOverlays" />
              <label for="removeOverlays">Remove overlay popups</label>
            </div>
          </div>

          <!-- Convert Button -->
          <button id="convertBtn" class="cta-button" style="margin-top: 20px;">
            <span class="btn-spinner">
              <i class="fa fa-spinner fa-spin"></i>
            </span>
            <span class="btn-text">
              <i class="fa fa-file-pdf"></i> Convert to PDF
            </span>
          </button>

          <p id="errorMsg" class="error-text" style="display: none"></p>

          <div class="note-box" id="noteBox">
            ðŸ’¡ Upload HTML files or enter a website URL. All styles, colors, and layout will be preserved in the PDF.
          </div>

          <!-- Result Section -->
          <div id="resultBtns" style="display: none; margin-top: 15px">
            <div class="result-card"><i class="fa fa-file-pdf"></i></div>
            <p class="file-name">
              <a href="#" id="fileNameLink">converted.pdf</a>
            </p>
            <a
              id="downloadBtn"
              href="#"
              class="cta-button"
              download="converted.pdf"
            >
              <i class="fa fa-download"></i> Download PDF
            </a>
            <button id="resetBtn" class="secondary-btn">
              <i class="fa fa-rotate-right"></i> Convert Another
            </button>
          </div>
        </div>

        <!-- PDF Preview -->
        <div id="pdfPreview" style="display: none; margin-top: 30px">
          <h4>Preview PDF</h4>
          <iframe
            id="pdfFrame"
            width="100%"
            height="600"
            style="border-radius: 12px; border: 1px solid #e5e7eb"
          ></iframe>
        </div>
      </div>
    </section>

    <section id="footer-placeholder"></section>
    <script src="./js/app.js"></script>

    <script>
      const BACKEND_URL = `${BACKEND_BASE_URL}/html-to-pdf`;

      const htmlInput = document.getElementById("htmlUpload");
      const urlInput = document.getElementById("urlInput");
      const fileList = document.getElementById("fileList");
      const convertBtn = document.getElementById("convertBtn");
      const errorMsg = document.getElementById("errorMsg");
      const resultBtns = document.getElementById("resultBtns");
      const downloadBtn = document.getElementById("downloadBtn");
      const resetBtn = document.getElementById("resetBtn");
      const fileNameLink = document.getElementById("fileNameLink");
      const uploadSection = document.getElementById("uploadSection");
      const urlSection = document.getElementById("urlSection");
      const pdfPreview = document.getElementById("pdfPreview");
      const pdfFrame = document.getElementById("pdfFrame");
      const noteBox = document.getElementById("noteBox");

      let selectedFiles = [];

      htmlInput.addEventListener("change", () => {
        errorMsg.style.display = "none";
        selectedFiles = Array.from(htmlInput.files);

        if (selectedFiles.length === 0) return;

        fileList.style.display = "block";
        fileList.innerHTML = selectedFiles
          .map(
            (file, index) => `
          <li>
              <i class="fa fa-code" style="margin-right:10px;"></i>
              <span>${file.name}</span>
              <i class="fa fa-times delete-file" data-index="${index}"></i>
          </li>`
          )
          .join("");
      });

      fileList.addEventListener("click", (e) => {
        if (e.target.classList.contains("delete-file")) {
          const index = parseInt(e.target.dataset.index);
          selectedFiles.splice(index, 1);

          if (selectedFiles.length === 0) {
            fileList.style.display = "none";
            fileList.innerHTML = "";
            htmlInput.value = "";
          } else {
            // Refresh the file list display
            htmlInput.dispatchEvent(new Event("change"));
          }
        }
      });

      convertBtn.addEventListener("click", async () => {
        const url = urlInput.value.trim();
        
        if (!selectedFiles.length && !url) {
          errorMsg.textContent = "Please upload HTML files or enter a URL";
          errorMsg.style.display = "block";
          return;
        }

        convertBtn.classList.add("btn-loading");
        const formData = new FormData();

        // Add files if any
        selectedFiles.forEach((file) => {
          formData.append("files", file);
        });

        // Add URL if provided
        if (url) {
          formData.append("url", url);
        }

        // Add options
        formData.append("screen_size", document.getElementById("screenSize").value);
        formData.append("page_size", document.getElementById("pageSize").value);
        formData.append(
          "orientation",
          document.querySelector('input[name="orientation"]:checked').value
        );
        formData.append(
          "margin",
          document.querySelector('input[name="margin"]:checked').value
        );
        formData.append("long_page", document.getElementById("longPage").checked);
        formData.append("block_ads", document.getElementById("blockAds").checked);
        formData.append(
          "remove_overlays",
          document.getElementById("removeOverlays").checked
        );

        try {
          const res = await fetch(BACKEND_URL, {
            method: "POST",
            body: formData,
          });

          if (!res.ok) {
            const error = await res.json();
            throw new Error(error.error || "Conversion failed");
          }

          const blob = await res.blob();
          const blobUrl = URL.createObjectURL(blob);

          downloadBtn.href = blobUrl;
          fileNameLink.href = blobUrl;

          resultBtns.style.display = "block";
          uploadSection.style.display = "none";
          urlSection.style.display = "none";
          convertBtn.style.display = "none";
          fileList.style.display = "none";
          noteBox.style.display = "none";
          document.querySelector(".options-grid").style.display = "none";
          document.querySelector(".option-group:last-of-type").style.display = "none";

          pdfFrame.src = blobUrl;
          pdfPreview.style.display = "block";
        } catch (err) {
          errorMsg.textContent = err.message;
          errorMsg.style.display = "block";
        } finally {
          convertBtn.classList.remove("btn-loading");
        }
      });

      resetBtn.addEventListener("click", () => {
        selectedFiles = [];
        fileList.innerHTML = "";
        fileList.style.display = "none";
        urlInput.value = "";
        uploadSection.style.display = "block";
        urlSection.style.display = "block";
        resultBtns.style.display = "none";
        convertBtn.style.display = "inline-flex";
        pdfPreview.style.display = "none";
        noteBox.style.display = "block";
        document.querySelector(".options-grid").style.display = "grid";
        document.querySelector(".option-group:last-of-type").style.display = "block";
        pdfFrame.src = "";
        errorMsg.style.display = "none";
      });
    </script>
  </body>
</html>