<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Primary Meta Tags -->
    <title>
      Add Page Numbers to PDF Online Free - Customize Page Numbering | PDFMaster
    </title>
    <meta
      name="title"
      content="Add Page Numbers to PDF Online Free - Customize Page Numbering | PDFMaster"
    />
    <meta
      name="description"
      content="Add customizable page numbers to your PDF files online for free. Choose position, font, color, and format. Fast, secure, and easy-to-use PDF page numbering tool. No registration required."
    />
    <meta
      name="keywords"
      content="add page numbers to PDF, PDF page numbering, number PDF pages, PDF editor online, customize page numbers, PDF numbering tool, add numbers to PDF free"
    />
    <meta name="author" content="PDFMaster" />
    <meta
      name="robots"
      content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"
    />
    <meta name="google-adsense-account" content="ca-pub-5797619165090350" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://pdfmaster.com/add-page-numbers" />
    <meta
      property="og:title"
      content="Add Page Numbers to PDF Online Free - Customize Page Numbering | PDFMaster"
    />
    <meta
      property="og:description"
      content="Add customizable page numbers to your PDF files online for free. Choose position, font, color, and format. Fast, secure, and easy-to-use."
    />
    <meta
      property="og:image"
      content="https://pdfmaster.com/images/add-page-numbers-og.png"
    />
    <meta property="og:site_name" content="PDFMaster" />
    <meta property="og:locale" content="en_US" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="https://pdfmaster.com/add-page-numbers" />
    <meta
      name="twitter:title"
      content="Add Page Numbers to PDF Online Free - Customize Page Numbering | PDFMaster"
    />
    <meta
      name="twitter:description"
      content="Add customizable page numbers to your PDF files online for free. Choose position, font, color, and format."
    />
    <meta
      name="twitter:image"
      content="https://pdfmaster.com/images/add-page-numbers-twitter.png"
    />

    <!-- Canonical URL -->
    <link rel="canonical" href="https://pdfmaster.com/add-page-numbers" />

    <!-- Structured Data / Schema.org -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "PDFMaster - Add Page Numbers to PDF",
        "url": "https://pdfmaster.com/add-page-numbers",
        "description": "Free online tool to add customizable page numbers to PDF files with position, font, and color options",
        "applicationCategory": "UtilitiesApplication",
        "operatingSystem": "Any",
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "USD"
        },
        "featureList": [
          "Add page numbers to unlimited PDF files",
          "Customize position and format",
          "Choose fonts and colors",
          "Set custom text and ranges",
          "Secure and private processing",
          "No registration required",
          "Works in browser"
        ]
      }
    </script>

    <!-- Breadcrumb Schema -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "Home",
            "item": "https://pdfmaster.com"
          },
          {
            "@type": "ListItem",
            "position": 2,
            "name": "Add Page Numbers",
            "item": "https://pdfmaster.com/add-page-numbers"
          }
        ]
      }
    </script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&family=Inter:wght@400;500&display=swap"
      rel="stylesheet"
    />

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <!-- CSS -->
    <link rel="stylesheet" href="./css/style.css" />

    <!-- Favicon -->
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="./images/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="./images/favicon-16x16.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="./images/apple-touch-icon.png"
    />

    <style>
      /* Accessibility: Skip to main content link */
      .skip-to-main {
        position: absolute;
        top: -40px;
        left: 0;
        background: #4f46e5;
        color: white;
        padding: 8px 16px;
        text-decoration: none;
        z-index: 100;
        border-radius: 0 0 4px 0;
        font-weight: 500;
      }

      .skip-to-main:focus {
        top: 0;
      }

      /* Screen reader only text */
      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border-width: 0;
      }

      /* Responsive subtitle styling */
      .subtitle {
        font-size: 18px;
        color: #555;
        margin-bottom: 30px;
        line-height: 1.6;
      }

      @media (max-width: 768px) {
        .subtitle {
          font-size: 16px;
        }
      }

      /* Ad section spacing */
      .ad-section {
        min-height: 100px;
      }

      .btn-loading .btn-spinner {
        display: inline-block;
      }

      .btn-loading .btn-text {
        display: none;
      }

      .btn-spinner {
        display: none;
      }

      /* ===== STICKY OPTIONS PANEL AT BOTTOM ===== */
      .options-panel {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        display: none;
        background: white;
        z-index: 1000;
        overflow-y: auto;
        border-top: 3px solid #4f46e5;
        box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.15);
        max-height: 220px;
        padding: 28px 16px 14px;
        transition: max-height 0.3s ease;
      }

      .btn-conainer {
        position: fixed;
        bottom: 179px;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 999;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      #errorMsg {
        position: absolute;
        top: -25px;
      }

      .options-panel.show {
        display: block;
      }

      /* Scrollbar styling */
      .options-panel::-webkit-scrollbar {
        width: 5px;
      }

      .options-panel::-webkit-scrollbar-track {
        background: #f1f1f1;
      }

      .options-panel::-webkit-scrollbar-thumb {
        background: #4f46e5;
        border-radius: 4px;
      }

      .options-panel::-webkit-scrollbar-thumb:hover {
        background: #4338ca;
      }

      /* Panel Container */
      .panel-flex {
        max-width: 1600px;
        margin: 0 auto;
        text-align: left;
      }

      /* Options Grid Layout */
      .panel-flex {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        gap: 10px;
        align-items: flex-end;
      }

      .option-group {
        display: flex;
        flex-direction: column;
        min-width: 0;
      }

      .option-group label {
        display: block;
        font-weight: 600;
        margin-bottom: 6px;
        color: #1e3a8a;
        font-size: 11px;
      }

      .option-group label i {
        margin-right: 6px;
        color: #4f46e5;
        font-size: 12px;
        width: 14px;
        text-align: center;
      }

      .option-group select,
      .option-group input[type="number"],
      .option-group input[type="text"] {
        width: 100%;
        padding: 7px 9px;
        border-radius: 6px;
        border: 1px solid #e5e7eb;
        font-size: 12px;
        transition: border-color 0.2s;
        background: #fafafa;
        box-sizing: border-box;
        min-width: 0;
      }

      .option-group select:focus,
      .option-group input:focus {
        outline: none;
        border-color: #4f46e5;
        background: white;
        box-shadow: 0 0 0 2px rgba(79, 70, 229, 0.1);
      }

      .option-group input[type="number"]::-webkit-inner-spin-button,
      .option-group input[type="number"]::-webkit-outer-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }

      .option-group input[type="number"] {
        -moz-appearance: textfield;
        appearance: textfield;
      }

      .option-group input[type="color"] {
        width: 50px;
        height: 36px;
        cursor: pointer;
        padding: 3px;
        border-radius: 6px;
        border: 1px solid #e5e7eb;
        background: #fafafa;
        box-sizing: border-box;
      }

      .option-group input[type="color"]::-webkit-color-swatch-wrapper {
        padding: 2px;
      }

      .option-group input[type="color"]::-webkit-color-swatch {
        border: 1px solid #e5e7eb;
        border-radius: 4px;
      }

      .option-group input[type="color"]:focus {
        outline: none;
        border-color: #4f46e5;
        background: white;
        box-shadow: 0 0 0 2px rgba(79, 70, 229, 0.1);
      }

      .format-toggles {
        display: flex;
        gap: 6px;
      }

      .format-btn {
        flex: 1;
        padding: 7px 8px;
        border: 2px solid #e5e7eb;
        background: #fafafa;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.2s;
        font-weight: 600;
        font-size: 13px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-sizing: border-box;
      }

      .format-btn:hover {
        border-color: #4f46e5;
        background: #f0f1ff;
      }

      .format-btn.active {
        border-color: #4f46e5;
        background: #4f46e5;
        color: white;
        box-shadow: 0 2px 6px rgba(79, 70, 229, 0.3);
      }

      .format-btn i {
        font-size: 13px;
      }

      .pages-grid {
        display: flex;
        flex-direction: column;
        gap: 30px;
        margin: 30px auto;
        padding: 20px;
        background: white;
        border-radius: 12px;
        border: 2px dashed #e5e7eb;
        max-width: 900px;
      }

      .pages-grid:empty::after {
        content: "Upload PDF files to see preview";
        display: flex;
        align-items: center;
        justify-content: center;
        color: #9ca3af;
        font-size: 14px;
        min-height: 200px;
      }

      .page-card {
        position: relative;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        width: fit-content;
        max-width: 100%;
        transition: all 0.3s ease;
        margin: 0 auto;
      }

      .page-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      .page-number-badge {
        position: absolute;
        top: -19px;
        left: 8px;
        background: #4f46e5;
        color: white;
        padding: 4px 10px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 600;
        z-index: 10;
      }

      .page-card canvas {
        display: block;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        position: relative;
        border: 1px solid #e5e7eb;
        max-width: min(100%, 800px) !important;
        height: auto !important;
        width: auto !important;
      }

      .page-number-preview {
        position: absolute;
        font-weight: 700;
        pointer-events: none;
        z-index: 5;
        white-space: nowrap;
        line-height: normal;
      }

      .out-of-range {
        opacity: 0.4;
        pointer-events: none;
      }

      .result-btns-container {
        display: flex;
        gap: 10px;
        justify-content: center;
        flex-wrap: wrap;
        margin-top: 20px;
      }

      /* Improve delete button accessibility */
      .delete-file {
        background: #ef4444;
        border: none;
        color: white;
        border-radius: 50%;
        width: 24px;
        height: 24px;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        transition: background 0.3s ease;
      }
      .delete-file i {
        color: #fff;
      }
      .delete-file:hover,
      .delete-file:focus {
        background: #dc2626;
      }

      @media (min-width: 1400px) {
        .panel-flex {
          grid-template-columns: repeat(5, 1fr);
        }
        .btn-conainer {
          bottom: 114px;
        }
      }

      @media (min-width: 1200px) and (max-width: 1399px) {
        .panel-flex {
          grid-template-columns: repeat(4, 1fr);
        }
      }

      @media (min-width: 992px) and (max-width: 1199px) {
        .panel-flex {
          grid-template-columns: repeat(3, 1fr);
        }

        .options-panel {
          max-height: 240px;
        }
      }

      @media (min-width: 768px) and (max-width: 991px) {
        .panel-flex {
          grid-template-columns: repeat(2, 1fr);
        }

        .options-panel {
          max-height: 260px;
          padding: 28px 14px 12px;
        }

        .pages-grid {
          gap: 25px;
          padding: 15px;
        }
        .btn-conainer {
          bottom: 250px;
        }
      }

      @media (min-width: 600px) and (max-width: 767px) {
        .panel-flex {
          grid-template-columns: repeat(2, 1fr);
          gap: 8px;
        }

        .options-panel {
          max-height: 280px;
          padding: 28px 12px 10px;
        }

        .btn-conainer {
          bottom: 267px;
        }

        .option-group label {
          font-size: 10px;
          margin-bottom: 5px;
        }

        .option-group select,
        .option-group input {
          font-size: 11px;
          padding: 6px 8px;
        }

        .option-group input[type="color"] {
          width: 45px;
          height: 32px;
        }

        .format-btn {
          padding: 7px;
          font-size: 12px;
        }

        .pages-grid {
          gap: 20px;
          padding: 12px;
        }

        .page-number-badge {
          font-size: 10px;
          padding: 3px 8px;
        }
      }

      @media (max-width: 599px) {
        .panel-flex {
          grid-template-columns: 1fr 1fr;
          gap: 6px;
        }

        .options-panel {
          max-height: 300px;
          padding: 28px 10px;
        }

        .btn-conainer {
          bottom: 277px;
        }

        .option-group label {
          font-size: 10px;
          margin-bottom: 4px;
        }

        .option-group label i {
          font-size: 11px;
          width: 12px;
        }

        .option-group select,
        .option-group input {
          font-size: 11px;
          padding: 5px 7px;
        }

        .option-group input[type="color"] {
          width: 40px;
          height: 32px;
        }

        .format-toggles {
          gap: 4px;
        }

        .format-btn {
          padding: 6px;
          font-size: 11px;
        }

        .format-btn i {
          font-size: 11px;
        }

        .pages-grid {
          gap: 20px;
          padding: 10px;
        }

        .page-number-badge {
          font-size: 10px;
          padding: 3px 7px;
        }
      }

      @media (max-width: 480px) {
        .options-panel {
          max-height: 200px;
        }

        .panel-flex {
          gap: 5px;
        }

        .option-group select,
        .option-group input {
          font-size: 10px;
          padding: 4px 6px;
        }

        .option-group input[type="color"] {
          width: 38px;
          height: 30px;
        }

        .format-btn {
          padding: 5px;
        }
      }

      /* ===== DRAGGABLE PAGE NUMBER STYLES ===== */
      .page-number-preview {
        pointer-events: auto !important;
        cursor: move !important;
        transition:
          transform 0.1s ease,
          box-shadow 0.1s ease,
          border 0.1s ease;
        border-radius: 4px;
        padding: 2px 4px;
        background: transparent;
        border: 1px solid transparent;
        user-select: none !important;
        z-index: 5 !important;
      }

      .page-number-preview:hover {
        border: 1px dashed #4f46e5 !important;
        background: rgba(79, 70, 229, 0.05) !important;
        box-shadow: 0 0 8px rgba(79, 70, 229, 0.2) !important;
      }

      .page-number-preview:active,
      .page-number-preview.dragging {
        cursor: grabbing !important;
        border: 1px solid #4f46e5 !important;
        box-shadow: 0 0 15px rgba(79, 70, 229, 0.4) !important;
        background: rgba(79, 70, 229, 0.1) !important;
        z-index: 100 !important;
        transform: scale(1.02);
      }

      .page-number-preview:focus {
        outline: 2px solid #4f46e5;
        outline-offset: 2px;
      }

      /* Apply to All Button */
      .page-apply-btn {
        position: absolute;
        bottom: -25px;
        right: 10px;
        background: #4f46e5;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 8px;
        font-size: 13px;
        font-weight: 600;
        cursor: pointer;
        display: none;
        z-index: 20;
        box-shadow: 0 2px 10px rgba(79, 70, 229, 0.3);
        transition: all 0.3s ease;
        white-space: nowrap;
      }

      .page-apply-btn:hover {
        background: #4338ca !important;
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(79, 70, 229, 0.4) !important;
      }

      .page-apply-btn:active {
        transform: translateY(0) !important;
      }

      .page-apply-btn:focus {
        outline: 2px solid #4338ca;
        outline-offset: 2px;
      }

      .page-apply-btn i {
        margin-right: 6px;
        font-size: 12px;
      }

      /* Success Toast */
      .success-toast {
        position: fixed !important;
        top: 70px !important;
        right: 20px !important;
        background: #10b981 !important;
        color: white !important;
        padding: 12px 20px !important;
        border-radius: 8px !important;
        font-weight: 600 !important;
        z-index: 9999 !important;
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3) !important;
        animation: slideIn 0.3s ease !important;
      }

      /* Animation Keyframes */
      @keyframes slideIn {
        from {
          transform: translateX(100%);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }

      @keyframes slideOut {
        from {
          transform: translateX(0);
          opacity: 1;
        }
        to {
          transform: translateX(100%);
          opacity: 0;
        }
      }

      /* Responsive adjustments for draggable elements */
      @media (max-width: 768px) {
        .page-apply-btn {
          bottom: -25px;
          padding: 6px 12px;
          font-size: 12px;
        }

        .page-apply-btn i {
          margin-right: 4px;
          font-size: 11px;
        }

        .page-number-preview {
          padding: 1px 3px;
        }
      }

      @media (max-width: 480px) {
        .page-apply-btn {
          bottom: -25px;
          padding: 5px 10px;
          font-size: 11px;
        }

        .page-apply-btn i {
          margin-right: 3px;
        }

        .page-number-preview {
          font-size: 90% !important;
        }
        .btn-conainer {
          bottom: 206px;
        }
        #addNumbersBtn {
          padding: 12px 14px;
          font-size: 14px;
        }
      }
    </style>

    <!-- Google AdSense (Replace with your AdSense ID) -->
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5797619165090350"
      crossorigin="anonymous"
    ></script>
  </head>

  <body>
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="skip-to-main">Skip to main content</a>

    <!-- Header -->
    <section id="header-placeholder"></section>

    <!-- Main Content -->
    <main id="main-content">
      <!-- Page Numbering Tool Section -->
      <section class="merge-tool" aria-labelledby="page-number-heading">
        <div class="container">
          <h1 id="page-number-heading">Add Page Numbers to PDF Online Free</h1>
          <p class="subtitle">
            Add customizable page numbers to your PDF files in seconds. Choose
            position, font, color, and format. Fast, secure, and completely
            free. No registration required.
          </p>

          <div class="upload-section">
            <div id="uploadSection">
              <label for="pdfUpload" class="upload-label" tabindex="0">
                <i class="fa fa-upload" aria-hidden="true"></i>
                <span>Choose PDF files</span>
              </label>
              <input
                type="file"
                id="pdfUpload"
                accept=".pdf"
                multiple
                aria-label="Select PDF files to add page numbers"
              />
            </div>

            <ul
              id="fileList"
              class="file-list"
              style="display: none"
              role="list"
              aria-label="Selected PDF files"
            ></ul>

            <!-- OPTIONS PANEL -->
            <div
              id="optionsContainer"
              class="options-panel"
              role="region"
              aria-label="Page numbering options"
            >
              <div class="btn-conainer">
                <p
                  id="errorMsg"
                  class="error-text"
                  style="display: none"
                  role="alert"
                  aria-live="polite"
                ></p>
                <button
                  id="addNumbersBtn"
                  class="cta-button"
                  style="margin-top: 15px"
                  aria-label="Add page numbers to selected PDFs"
                >
                  <span class="btn-spinner"
                    ><i class="fa fa-spinner fa-spin" aria-hidden="true"></i
                  ></span>
                  <span class="btn-text"
                    ><i class="fa fa-list-ol" aria-hidden="true"></i
                  ></span>
                  Add Page Numbers
                </button>
              </div>
              <div class="panel-flex">
                <div class="option-group">
                  <label for="position"
                    ><i class="fas fa-map-marker-alt" aria-hidden="true"></i>
                    Position</label
                  >
                  <select
                    id="position"
                    aria-label="Select page number position"
                  >
                    <option value="bottom-center">Bottom Center</option>
                    <option value="bottom-right">Bottom Right</option>
                    <option value="bottom-left">Bottom Left</option>
                    <option value="top-center">Top Center</option>
                    <option value="top-right">Top Right</option>
                    <option value="top-left">Top Left</option>
                  </select>
                </div>

                <div class="option-group">
                  <label for="fontFamily"
                    ><i class="fas fa-font" aria-hidden="true"></i> Font
                    Style</label
                  >
                  <select id="fontFamily" aria-label="Select font style">
                    <option value="helvetica">Helvetica</option>
                    <option value="times">Times Roman</option>
                    <option value="courier">Courier</option>
                    <option value="symbol">Symbol</option>
                    <option value="zapfdingbats">Zapf Dingbats</option>
                  </select>
                </div>

                <div class="option-group">
                  <label for="fontSize"
                    ><i class="fas fa-text-height" aria-hidden="true"></i> Font
                    Size</label
                  >
                  <input
                    type="number"
                    id="fontSize"
                    value="12"
                    min="8"
                    max="48"
                    aria-label="Font size in points"
                  />
                </div>

                <div class="option-group">
                  <label for="fontColor"
                    ><i class="fas fa-palette" aria-hidden="true"></i> Font
                    Color</label
                  >
                  <input
                    type="color"
                    id="fontColor"
                    value="#000000"
                    aria-label="Select font color"
                  />
                </div>

                <div class="option-group">
                  <label
                    ><i class="fas fa-bold" aria-hidden="true"></i>
                    Format</label
                  >
                  <div
                    class="format-toggles"
                    role="group"
                    aria-label="Text formatting options"
                  >
                    <button
                      type="button"
                      class="format-btn"
                      id="boldBtn"
                      title="Bold"
                      aria-label="Toggle bold formatting"
                      aria-pressed="false"
                    >
                      <i class="fas fa-bold" aria-hidden="true"></i>
                    </button>
                    <button
                      type="button"
                      class="format-btn"
                      id="italicBtn"
                      title="Italic"
                      aria-label="Toggle italic formatting"
                      aria-pressed="false"
                    >
                      <i class="fas fa-italic" aria-hidden="true"></i>
                    </button>
                    <button
                      type="button"
                      class="format-btn"
                      id="underlineBtn"
                      title="Underline"
                      aria-label="Toggle underline formatting"
                      aria-pressed="false"
                    >
                      <i class="fas fa-underline" aria-hidden="true"></i>
                    </button>
                  </div>
                </div>

                <div class="option-group">
                  <label for="customText"
                    ><i class="fas fa-edit" aria-hidden="true"></i> Custom Text
                    (e.g., Page {n} of {total})</label
                  >
                  <input
                    type="text"
                    id="customText"
                    placeholder="e.g., Page {n} of {total}"
                    aria-label="Custom text format"
                  />
                </div>

                <div class="option-group">
                  <label for="startPage"
                    ><i class="fas fa-play" aria-hidden="true"></i> Start
                    Page</label
                  >
                  <input
                    type="number"
                    id="startPage"
                    value="1"
                    min="1"
                    aria-label="First page to number"
                  />
                </div>

                <div class="option-group">
                  <label for="endPage"
                    ><i class="fas fa-stop" aria-hidden="true"></i> End
                    Page</label
                  >
                  <input
                    type="number"
                    id="endPage"
                    value=""
                    min="1"
                    placeholder="Last page"
                    aria-label="Last page to number"
                  />
                </div>

                <div class="option-group">
                  <label for="startNumber"
                    ><i class="fas fa-hashtag" aria-hidden="true"></i> Start
                    Number</label
                  >
                  <input
                    type="number"
                    id="startNumber"
                    value="1"
                    min="1"
                    aria-label="Starting page number"
                  />
                </div>
              </div>
            </div>

            <!-- PREVIEW -->
            <div
              id="pagesGrid"
              class="pages-grid"
              style="display: none"
              role="region"
              aria-label="PDF preview with page numbers"
            ></div>

            <div
              id="resultBtns"
              style="display: none; margin-top: 30px"
              role="region"
              aria-label="Processing results"
            >
              <div class="result-card">
                <i class="fa fa-file-pdf" aria-hidden="true"></i>
              </div>
              <p class="file-name">
                <a href="#" id="fileNameLink" aria-label="View numbered PDF"
                  >page_numbered.pdf</a
                >
              </p>
              <div class="result-btns-container">
                <a
                  id="downloadBtn"
                  class="cta-button"
                  aria-label="Download numbered PDF"
                >
                  <i class="fa fa-download" aria-hidden="true"></i> Download PDF
                </a>
                <a
                  id="shareBtn"
                  class="cta-button"
                  aria-label="Share numbered PDF"
                  ><i class="fa fa-share-alt" aria-hidden="true"></i> Share</a
                >
                <button
                  id="resetBtn"
                  class="secondary-btn"
                  aria-label="Reset and add numbers to another PDF"
                >
                  <i class="fa fa-rotate-right" aria-hidden="true"></i> Add
                  Another PDF
                </button>
              </div>
            </div>

            <p class="note" id="noteText">
              <i class="fa fa-info-circle" aria-hidden="true"></i>
              Supported format: PDF. You can upload multiple files at once.
            </p>
          </div>

          <div id="pdfPreview" style="display: none; margin-top: 30px">
            <h2>Preview PDF with Page Numbers</h2>
            <iframe
              id="pdfFrame"
              width="100%"
              height="600"
              title="PDF preview with page numbers"
              style="border-radius: 12px; border: 1px solid #e5e7eb"
            ></iframe>
          </div>
        </div>
      </section>

      <!-- AdSense Ad Placeholder (Above the fold) -->
      <section class="ad-section" style="margin: 40px 0; text-align: center">
        <div class="container">
          <ins
            class="adsbygoogle"
            style="display: block"
            data-ad-client="ca-pub-5797619165090350"
            data-ad-slot="XXXXXXXXXX"
            data-ad-format="auto"
            data-full-width-responsive="true"
          ></ins>
          <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
        </div>
      </section>

      <!-- How to Add Page Numbers Section -->
      <section class="features" style="background: #f9fafb">
        <div class="container">
          <h2>How to Add Page Numbers to PDF Files</h2>
          <p
            style="
              text-align: center;
              color: #555;
              margin-bottom: 40px;
              max-width: 800px;
              margin-left: auto;
              margin-right: auto;
            "
          >
            Follow these simple steps to add professional page numbers to your
            PDF documents using our free online tool.
          </p>

          <div class="feature-grid">
            <div class="feature-card">
              <div
                style="
                  font-size: 48px;
                  color: #4f46e5;
                  font-weight: bold;
                  margin-bottom: 10px;
                "
              >
                1
              </div>
              <h3>Upload PDF Files</h3>
              <p>
                Click "Choose PDF files" and select one or more PDF documents
                from your device. You can upload multiple files to batch process
                them with the same page number settings.
              </p>
            </div>
            <div class="feature-card">
              <div
                style="
                  font-size: 48px;
                  color: #4f46e5;
                  font-weight: bold;
                  margin-bottom: 10px;
                "
              >
                2
              </div>
              <h3>Customize Settings</h3>
              <p>
                Choose your preferred position, font style, size, color, and
                format. Set custom text patterns like "Page {n} of {total}" and
                define which pages to number.
              </p>
            </div>
            <div class="feature-card">
              <div
                style="
                  font-size: 48px;
                  color: #4f46e5;
                  font-weight: bold;
                  margin-bottom: 10px;
                "
              >
                3
              </div>
              <h3>Preview & Download</h3>
              <p>
                Preview how page numbers will appear on your PDF. Once
                satisfied, click "Add Page Numbers" and download your numbered
                PDF file instantly.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- Why Add Page Numbers Section -->
      <section class="benefits" style="background: white; padding: 60px 20px">
        <div class="container">
          <h2>Why Use Our PDF Page Numbering Tool?</h2>
          <div class="feature-grid">
            <div class="feature-card">
              <i
                class="fas fa-sliders-h"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Fully Customizable</h3>
              <p>
                Choose from multiple positions, fonts, colors, and formats. Add
                custom text with page number variables for complete control over
                appearance.
              </p>
            </div>
            <div class="feature-card">
              <i
                class="fas fa-eye"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Live Preview</h3>
              <p>
                See exactly how your page numbers will look before processing.
                Preview all pages with real-time updates as you adjust settings.
              </p>
            </div>
            <div class="feature-card">
              <i
                class="fas fa-bolt"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Lightning Fast</h3>
              <p>
                Add page numbers to multiple PDFs in seconds with our optimized
                processing. No waiting in queues or slow uploads.
              </p>
            </div>
            <div class="feature-card">
              <i
                class="fas fa-shield-alt"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Secure & Private</h3>
              <p>
                Your files are processed securely and never stored on our
                servers. Complete privacy guaranteed for all your documents.
              </p>
            </div>
            <div class="feature-card">
              <i
                class="fas fa-dollar-sign"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>100% Free</h3>
              <p>
                Add page numbers to unlimited PDF files without any charges,
                subscriptions, or hidden fees. Free forever for everyone.
              </p>
            </div>
            <div class="feature-card">
              <i
                class="fas fa-mobile-alt"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Works Everywhere</h3>
              <p>
                Use on any device - Windows, Mac, Linux, iOS, or Android. Works
                perfectly in all modern browsers.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- AdSense Ad Placeholder (Mid-content) -->
      <section
        class="ad-section"
        style="
          margin: 40px 0;
          text-align: center;
          background: #f9fafb;
          padding: 40px 20px;
        "
      >
        <div class="container">
          <ins
            class="adsbygoogle"
            style="display: block"
            data-ad-client="ca-pub-5797619165090350"
            data-ad-slot="XXXXXXXXXX"
            data-ad-format="auto"
            data-full-width-responsive="true"
          ></ins>
          <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
        </div>
      </section>

      <!-- Detailed Guide Section -->
      <section class="features" style="background: white">
        <div class="container">
          <h2>Complete Guide to Adding Page Numbers to PDFs</h2>
          <div style="max-width: 900px; margin: 0 auto; text-align: left">
            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              Why Add Page Numbers to PDF Documents?
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 25px">
              Page numbers are essential for professional documents, making it
              easier for readers to navigate, reference specific sections, and
              maintain organization. Whether you're preparing reports, academic
              papers, ebooks, manuals, or legal documents, page numbers provide
              a clear reference system that improves readability and
              professionalism. They help readers keep track of their position in
              longer documents and enable accurate citations and
              cross-references. In business settings, numbered pages facilitate
              discussions during meetings and presentations, while in academic
              contexts, they're often required for proper formatting and
              submission standards.
            </p>

            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              Common Use Cases for PDF Page Numbering
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 15px">
              There are numerous situations where adding page numbers to PDFs
              becomes essential:
            </p>
            <ul
              style="
                color: #555;
                line-height: 1.8;
                margin-bottom: 25px;
                padding-left: 25px;
              "
            >
              <li style="margin-bottom: 10px">
                <strong>Academic Papers:</strong> Theses, dissertations,
                research papers, and essays require proper page numbering for
                academic standards and citation purposes.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Business Reports:</strong> Annual reports, financial
                statements, and business proposals need page numbers for
                professional presentation and easy navigation.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Ebooks and Manuals:</strong> User guides, instruction
                manuals, and digital books benefit from page numbers for quick
                reference and table of contents accuracy.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Legal Documents:</strong> Contracts, agreements, and
                legal briefs require page numbering for formal documentation and
                reference during proceedings.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Presentations:</strong> Slide decks and presentation
                handouts become more professional and easier to follow with page
                numbers.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Newsletters and Magazines:</strong> Digital publications
                need page numbers for reader convenience and content
                organization.
              </li>
            </ul>

            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              Understanding Page Number Customization Options
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 15px">
              Our tool offers comprehensive customization to match your
              document's style and requirements:
            </p>
            <ul
              style="
                color: #555;
                line-height: 1.8;
                margin-bottom: 25px;
                padding-left: 25px;
              "
            >
              <li style="margin-bottom: 10px">
                <strong>Position Options:</strong> Place page numbers at the top
                or bottom of pages, aligned to the left, center, or right.
                Bottom center is most common for formal documents, while top
                right is popular for academic papers.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Font Styles:</strong> Choose from Helvetica for modern
                documents, Times Roman for traditional formats, or Courier for
                technical documents. Each font conveys a different professional
                tone.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Font Size:</strong> Adjust from 8pt to 48pt to match
                your document's overall typography. Standard sizes are 10-12pt
                for most documents.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Color Selection:</strong> Match page numbers to your
                document's color scheme or use traditional black for maximum
                readability.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Text Formatting:</strong> Apply bold, italic, or
                underline to emphasize or style page numbers according to your
                preference.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Custom Text Patterns:</strong> Use variables like {n}
                for current page number and {total} for total pages to create
                formats like "Page 1 of 10" or "1/10".
              </li>
              <li style="margin-bottom: 10px">
                <strong>Page Range:</strong> Number only specific pages by
                setting start and end page values, useful for excluding cover
                pages or appendices.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Starting Number:</strong> Begin numbering from any
                number, allowing for continuation from previous documents or
                sections.
              </li>
            </ul>

            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              Best Practices for Professional Page Numbering
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 15px">
              Follow these guidelines to ensure your page numbers enhance
              document professionalism:
            </p>
            <ul
              style="
                color: #555;
                line-height: 1.8;
                margin-bottom: 25px;
                padding-left: 25px;
              "
            >
              <li style="margin-bottom: 10px">
                For formal documents, use bottom center position with a simple
                number format without additional text.
              </li>
              <li style="margin-bottom: 10px">
                Match the font style and size to your document's body text for
                visual consistency.
              </li>
              <li style="margin-bottom: 10px">
                Leave cover pages and title pages unnumbered by setting the
                start page to 2 or later.
              </li>
              <li style="margin-bottom: 10px">
                Use "Page X of Y" format for shorter documents to help readers
                gauge document length.
              </li>
              <li style="margin-bottom: 10px">
                Ensure sufficient margin space around page numbers so they don't
                overlap with content.
              </li>
              <li style="margin-bottom: 10px">
                Preview the entire document before finalizing to check page
                number placement on all pages.
              </li>
              <li style="margin-bottom: 10px">
                For documents with different sections, consider using different
                numbering schemes (Roman numerals for preface, Arabic for main
                content).
              </li>
            </ul>

            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              How Our Page Numbering Tool Works
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 25px">
              Our online PDF page numbering tool uses advanced PDF manipulation
              technology to add numbers to your documents while preserving all
              original content, formatting, and quality. The process begins when
              you upload your PDF files. Our system renders a preview of each
              page, allowing you to see exactly how the page numbers will appear
              with your chosen settings. You can adjust position, font, color,
              and format in real-time, with the preview updating instantly. Once
              you're satisfied with the preview, our server processes the PDF,
              embedding the page numbers directly into the document at the
              precise coordinates you've specified. The entire process maintains
              the original PDF quality, including all images, text, links, and
              formatting. Your numbered PDF is then ready for immediate
              download.
            </p>

            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              Tips for Different Document Types
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 15px">
              Different types of documents benefit from specific page numbering
              approaches:
            </p>
            <ul
              style="
                color: #555;
                line-height: 1.8;
                margin-bottom: 25px;
                padding-left: 25px;
              "
            >
              <li style="margin-bottom: 10px">
                <strong>Academic Papers:</strong> Use bottom center or top right
                position with simple Arabic numerals. Exclude the title page
                from numbering.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Business Reports:</strong> Consider adding "Page X of Y"
                format in the footer with company branding colors.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Ebooks:</strong> Use a discreet font size and position
                that doesn't distract from content, typically bottom center with
                small font.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Legal Documents:</strong> Use traditional formatting
                with page numbers in the bottom right corner, often with
                document name or case number.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Presentations:</strong> Place numbers in bottom right
                corner with slightly larger font for visibility when projected.
              </li>
            </ul>

            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              Security and Privacy Considerations
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 25px">
              When adding page numbers to PDFs online, document security is
              important, especially for confidential business reports, legal
              documents, or personal information. Our tool prioritizes your
              privacy by using secure encrypted connections for all file
              transfers. Files are processed on secure servers and automatically
              deleted immediately after processing is complete. We never access,
              read, or store the content of your documents. However, for
              extremely sensitive documents, you might consider processing them
              on a secure, private network. The tool works equally well offline
              if you prefer to use desktop software for maximum security, though
              our online version offers convenience without compromising your
              document privacy.
            </p>

            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              Troubleshooting Common Issues
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 15px">
              If you encounter problems while adding page numbers, here are
              solutions to common issues:
            </p>
            <ul
              style="
                color: #555;
                line-height: 1.8;
                margin-bottom: 25px;
                padding-left: 25px;
              "
            >
              <li style="margin-bottom: 10px">
                <strong>Numbers appear in wrong position:</strong> Check your
                position settings and preview before processing. Different page
                sizes may require adjustment.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Preview not showing:</strong> Ensure your browser
                supports PDF preview. Try refreshing the page or using a
                different browser.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Numbers overlapping content:</strong> Choose a different
                position or adjust font size to avoid content overlap.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Wrong pages numbered:</strong> Double-check start page
                and end page settings before clicking "Add Page Numbers."
              </li>
              <li style="margin-bottom: 10px">
                <strong>File won't upload:</strong> Ensure your file is a valid
                PDF and not password-protected. Remove password protection first
                if needed.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Custom text not working:</strong> Verify you're using
                the correct variable syntax: {n} for page number, {total} for
                total pages.
              </li>
            </ul>

            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              Advanced Page Numbering Techniques
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 25px">
              For more sophisticated documents, consider these advanced
              approaches. You can process different sections separately with
              different numbering schemes - for example, use Roman numerals (i,
              ii, iii) for the introduction and table of contents, then switch
              to Arabic numerals (1, 2, 3) for the main content. To achieve
              this, split your PDF into sections, number each section
              appropriately, then merge them back together. For documents with
              landscape and portrait pages, you may want to adjust page number
              positions differently for each orientation. Some documents benefit
              from chapter-specific numbering like "2-1, 2-2, 2-3" for pages in
              chapter 2, which you can achieve by using custom text with the
              chapter number included.
            </p>
          </div>
        </div>
      </section>

      <!-- FAQ Section -->
      <section class="features" style="background: #f9fafb">
        <div class="container">
          <h2>Frequently Asked Questions About Adding Page Numbers to PDFs</h2>
          <div style="max-width: 800px; margin: 0 auto; text-align: left">
            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Is it free to add page numbers to PDFs?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Yes, our PDF page numbering tool is completely free with no
                hidden charges, subscriptions, or premium features. You can add
                page numbers to unlimited PDF files as many times as you need.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Can I customize the position of page numbers?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Absolutely! You can place page numbers in six different
                positions: top left, top center, top right, bottom left, bottom
                center, or bottom right. Choose the position that best suits
                your document style.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Will adding page numbers affect my PDF quality?
              </h3>
              <p style="color: #555; line-height: 1.8">
                No, adding page numbers does not reduce quality. The original
                PDF content, images, text, and formatting remain unchanged. Page
                numbers are added as a new layer on top of your existing
                document.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Can I add page numbers to specific pages only?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Yes! Use the "Start Page" and "End Page" options to number only
                specific page ranges. This is useful for excluding cover pages,
                title pages, or appendices from numbering.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                What font styles are available for page numbers?
              </h3>
              <p style="color: #555; line-height: 1.8">
                We offer five professional font styles: Helvetica, Times Roman,
                Courier, Symbol, and Zapf Dingbats. You can also adjust font
                size from 8pt to 48pt and choose any color you need.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Can I add custom text with page numbers?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Yes! Use the custom text field to create formats like "Page {n}
                of {total}" where {n} represents the current page number and
                {total} represents total pages. You can add any text around
                these variables.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Is my document secure when using this tool?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Yes, your documents are processed securely using encrypted
                connections. Files are automatically deleted from our servers
                immediately after processing, and we never access or store your
                document content.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Can I preview page numbers before downloading?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Yes! Our tool provides a live preview showing exactly how page
                numbers will appear on each page. You can adjust all settings
                and see changes in real-time before processing your PDF.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Can I start numbering from a number other than 1?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Yes! Use the "Start Number" option to begin numbering from any
                number you choose. This is useful when continuing numbering from
                a previous document or section.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Does this work on mobile devices?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Yes! Our page numbering tool works perfectly on all mobile
                devices including smartphones and tablets running iOS or
                Android. The interface is fully responsive and touch-friendly.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Can I add page numbers to multiple PDFs at once?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Yes! You can upload multiple PDF files and apply the same page
                number settings to all of them at once, saving time when
                processing batches of similar documents.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                What if my PDF is password-protected?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Password-protected PDFs cannot be processed directly. You'll
                need to remove the password protection first, then you can add
                page numbers to the unlocked file.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                How long does it take to add page numbers?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Most PDFs are processed in just a few seconds. The exact time
                depends on file size and number of pages, but typically you'll
                have your numbered PDF ready to download within 10-30 seconds.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- AdSense Ad Placeholder (Bottom) -->
      <section
        class="ad-section"
        style="
          margin: 40px 0;
          text-align: center;
          background: white;
          padding: 40px 20px;
        "
      >
        <div class="container">
          <ins
            class="adsbygoogle"
            style="display: block"
            data-ad-client="ca-pub-5797619165090350"
            data-ad-slot="XXXXXXXXXX"
            data-ad-format="auto"
            data-full-width-responsive="true"
          ></ins>
          <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
        </div>
      </section>

      <!-- Related Tools Section -->
      <section class="benefits" style="background: #f9fafb">
        <div class="container">
          <h2>Related PDF Tools You Might Need</h2>
          <div class="feature-grid">
            <div class="feature-card">
              <i
                class="fas fa-object-group"
                style="font-size: 40px; color: #4f46e5; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Merge PDF</h3>
              <p>
                Combine multiple PDF files into a single document quickly and
                easily.
              </p>
              <a
                href="/merge"
                class="cta-button"
                style="font-size: 14px; padding: 8px 16px; margin-top: 10px"
                >Merge PDFs</a
              >
            </div>
            <div class="feature-card">
              <i
                class="fas fa-cut"
                style="font-size: 40px; color: #4f46e5; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Split PDF</h3>
              <p>
                Extract specific pages or split large PDFs into multiple smaller
                files.
              </p>
              <a
                href="/split"
                class="cta-button"
                style="font-size: 14px; padding: 8px 16px; margin-top: 10px"
                >Split PDF</a
              >
            </div>
            <div class="feature-card">
              <i
                class="fas fa-compress"
                style="font-size: 40px; color: #4f46e5; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Compress PDF</h3>
              <p>
                Reduce PDF file size to make it easier to email or upload
                online.
              </p>
              <a
                href="/compress-pdf"
                class="cta-button"
                style="font-size: 14px; padding: 8px 16px; margin-top: 10px"
                >Compress PDF</a
              >
            </div>
          </div>
        </div>
      </section>

      <!-- CTA Section -->
      <section
        class="hero"
        style="
          padding: 60px 20px;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        "
      >
        <div class="container">
          <h2 style="font-size: 32px; margin-bottom: 15px; color: white">
            Ready to Add Page Numbers to Your PDFs?
          </h2>
          <p style="margin-bottom: 25px; color: white">
            Start numbering your PDF files now. Customize position, font, and
            format. Fast, secure, and completely free.
          </p>
          <a
            href="#main-content"
            class="cta-button"
            style="background: white; color: #667eea"
          >
            <i class="fas fa-arrow-up" aria-hidden="true"></i> Add Page Numbers
            Now
          </a>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <section id="footer-placeholder"></section>

    <!-- PDF.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>

    <!-- JS -->
    <script src="./js/app.js"></script>

    <script>
  const BACKEND_URL = `http://127.0.0.1:8080/add-page-numbers`;

  pdfjsLib.GlobalWorkerOptions.workerSrc =
    "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";

  const pdfUpload = document.getElementById("pdfUpload");
  const fileList = document.getElementById("fileList");
  const addNumbersBtn = document.getElementById("addNumbersBtn");
  const errorMsg = document.getElementById("errorMsg");
  const resultBtns = document.getElementById("resultBtns");
  const downloadBtn = document.getElementById("downloadBtn");
  const resetBtn = document.getElementById("resetBtn");
  const pdfPreview = document.getElementById("pdfPreview");
  const pdfFrame = document.getElementById("pdfFrame");
  const uploadSection = document.getElementById("uploadSection");
  const pagesGrid = document.getElementById("pagesGrid");
  const fileNameLink = document.getElementById("fileNameLink");
  const shareBtn = document.getElementById("shareBtn");

  const optionsContainer = document.getElementById("optionsContainer");
  const position = document.getElementById("position");
  const fontFamily = document.getElementById("fontFamily");
  const fontSize = document.getElementById("fontSize");
  const fontColor = document.getElementById("fontColor");
  const boldBtn = document.getElementById("boldBtn");
  const italicBtn = document.getElementById("italicBtn");
  const underlineBtn = document.getElementById("underlineBtn");
  const customText = document.getElementById("customText");
  const startPage = document.getElementById("startPage");
  const endPage = document.getElementById("endPage");
  const startNumber = document.getElementById("startNumber");

  let files = [];
  let totalPages = 0;
  let pageNumberInstances = []; // Store page number positions for each page
  let isDraggingGlobal = false;

  function clearError() {
    errorMsg.textContent = "";
    errorMsg.style.display = "none";
  }

  function showError(msg) {
    errorMsg.textContent = msg;
    errorMsg.style.display = "block";
  }

  function showSuccess(msg) {
    // Remove any existing success messages
    const existingSuccess = document.querySelector(".success-toast");
    if (existingSuccess) existingSuccess.remove();

    const toast = document.createElement("div");
    toast.className = "success-toast";
    toast.textContent = msg;

    document.body.appendChild(toast);

    // Auto-remove after 3 seconds
    setTimeout(() => {
      toast.style.animation = "slideOut 0.3s ease";
      setTimeout(() => {
        if (toast.parentNode) {
          toast.parentNode.removeChild(toast);
        }
      }, 300);
    }, 3000);
  }

  // Format button toggles with ARIA updates
  [boldBtn, italicBtn, underlineBtn].forEach((btn) => {
    btn.addEventListener("click", () => {
      const isActive = btn.classList.toggle("active");
      btn.setAttribute("aria-pressed", isActive);
      updateAllPreviews();
    });
  });

  // File upload handler
  pdfUpload.addEventListener("change", async () => {
    const newFiles = Array.from(pdfUpload.files);
    newFiles.forEach((file) => {
      if (
        !files.some((f) => f.name === file.name && f.size === file.size)
      ) {
        files.push(file);
      }
    });
    pdfUpload.value = "";
    renderFileList();
    await loadPDFs();
  });

  function renderFileList() {
    if (!files.length) {
      fileList.style.display = "none";
      return;
    }
    fileList.style.display = "block";
    fileList.innerHTML = "";
    files.forEach((f, i) => {
      const li = document.createElement("li");
      li.innerHTML = `
      <span><i class="fa fa-file-pdf pdf-icon" aria-hidden="true"></i> ${f.name}</span>
      <button class="delete-file" data-i="${i}" aria-label="Remove ${f.name}"><i class="fa fa-times" aria-hidden="true"></i></button>
    `;
      fileList.appendChild(li);
    });
  }

  fileList.addEventListener("click", async (e) => {
    const deleteBtn = e.target.closest(".delete-file");
    if (deleteBtn) {
      files.splice(deleteBtn.dataset.i, 1);
      renderFileList();
      await loadPDFs();
    }
  });

  async function loadPDFs() {
    clearError();
    pagesGrid.innerHTML = "";
    totalPages = 0;
    pageNumberInstances = [];

    if (!files.length) {
      pagesGrid.style.display = "none";
      optionsContainer.style.display = "none";
      return;
    }

    pagesGrid.style.display = "flex";
    optionsContainer.style.display = "block";

    let pageNo = 1;

    for (const file of files) {
      const pdf = await pdfjsLib.getDocument(URL.createObjectURL(file))
        .promise;
      totalPages += pdf.numPages;

      for (let i = 1; i <= pdf.numPages; i++) {
        const page = await pdf.getPage(i);

        const maxWidth =
          window.innerWidth < 768 ? window.innerWidth - 40 : 800;
        const viewport = page.getViewport({ scale: 1 });
        const displayScale = Math.min(maxWidth / viewport.width, 1);

        const renderScale = displayScale * (window.devicePixelRatio || 2);
        const scaledViewport = page.getViewport({ scale: renderScale });

        const canvas = document.createElement("canvas");
        canvas.width = scaledViewport.width;
        canvas.height = scaledViewport.height;

        await page.render({
          canvasContext: canvas.getContext("2d"),
          viewport: scaledViewport,
        }).promise;

        canvas.style.width = viewport.width * displayScale + "px";
        canvas.style.height = viewport.height * displayScale + "px";

        const card = document.createElement("div");
        card.className = "page-card";
        card.dataset.pageNum = pageNo;
        card.dataset.scale = displayScale;
        card.dataset.baseWidth = viewport.width;
        card.dataset.baseHeight = viewport.height;

        const badge = document.createElement("div");
        badge.className = "page-number-badge";
        badge.textContent = `Page ${pageNo}`;
        badge.setAttribute("aria-hidden", "true");
        card.appendChild(badge);

        card.appendChild(canvas);

        pagesGrid.appendChild(card);

        // Initialize page number position data
        pageNumberInstances[pageNo - 1] = {
          pageNum: pageNo,
          left: null,
          top: null,
          customLeft: null,
          customTop: null,
          dragged: false,
          scale: displayScale,
          baseWidth: viewport.width,
          baseHeight: viewport.height,
          isCustomPosition: false,
          dropdownPosition: position.value,
        };

        pageNo++;
      }
    }

    updatePageRangeDisplay();
    updateAllPreviews();
  }

  function makeDraggable(preview, card) {
    let isDragging = false;
    let startX, startY;
    let initialLeft, initialTop;
    const canvas = card.querySelector("canvas");
    const pageNum = parseInt(card.dataset.pageNum);
    const pageData = pageNumberInstances[pageNum - 1];

    const startDrag = (e) => {
      e.preventDefault();
      e.stopPropagation();
      isDragging = true;
      isDraggingGlobal = true;

      const clientX = e.clientX || (e.touches && e.touches[0].clientX);
      const clientY = e.clientY || (e.touches && e.touches[0].clientY);

      startX = clientX;
      startY = clientY;
      initialLeft = parseFloat(preview.style.left) || 0;
      initialTop = parseFloat(preview.style.top) || 0;

      preview.classList.add("dragging");
      preview.style.zIndex = "100";
      preview.style.cursor = "grabbing";

      document.addEventListener("mousemove", drag);
      document.addEventListener("mouseup", stopDrag);
      document.addEventListener("touchmove", dragTouch, { passive: false });
      document.addEventListener("touchend", stopDrag);
    };

    const drag = (e) => {
      if (!isDragging) return;
      e.preventDefault();

      const clientX = e.clientX || (e.touches && e.touches[0].clientX);
      const clientY = e.clientY || (e.touches && e.touches[0].clientY);

      if (!clientX || !clientY) return;

      const dx = clientX - startX;
      const dy = clientY - startY;

      let newLeft = initialLeft + dx;
      let newTop = initialTop + dy;

      // Get preview dimensions
      const previewRect = preview.getBoundingClientRect();
      const canvasRect = canvas.getBoundingClientRect();
      const cardRect = card.getBoundingClientRect();

      // Constrain within canvas bounds
      const minX = canvasRect.left - cardRect.left;
      const maxX = minX + canvasRect.width - previewRect.width;
      const minY = canvasRect.top - cardRect.top;
      const maxY = minY + canvasRect.height - previewRect.height;

      newLeft = Math.max(minX, Math.min(newLeft, maxX));
      newTop = Math.max(minY, Math.min(newTop, maxY));

      preview.style.left = newLeft + "px";
      preview.style.top = newTop + "px";

      // Update page number instance data
      if (pageNum && pageNumberInstances[pageNum - 1]) {
        pageNumberInstances[pageNum - 1].customLeft = newLeft;
        pageNumberInstances[pageNum - 1].customTop = newTop;
        pageNumberInstances[pageNum - 1].dragged = true;
        pageNumberInstances[pageNum - 1].isCustomPosition = true;

        // Show "Apply to All" button for this page
        const applyBtn = card.querySelector(".page-apply-btn");
        if (applyBtn) {
          applyBtn.style.display = "block";
        }
      }
    };

    const dragTouch = (e) => {
      if (!isDragging) return;
      e.preventDefault();
      const touch = e.touches[0];

      const dx = touch.clientX - startX;
      const dy = touch.clientY - startY;

      let newLeft = initialLeft + dx;
      let newTop = initialTop + dy;

      // Get preview dimensions
      const previewRect = preview.getBoundingClientRect();
      const canvasRect = canvas.getBoundingClientRect();
      const cardRect = card.getBoundingClientRect();

      // Constrain within canvas bounds
      const minX = canvasRect.left - cardRect.left;
      const maxX = minX + canvasRect.width - previewRect.width;
      const minY = canvasRect.top - cardRect.top;
      const maxY = minY + canvasRect.height - previewRect.height;

      newLeft = Math.max(minX, Math.min(newLeft, maxX));
      newTop = Math.max(minY, Math.min(newTop, maxY));

      preview.style.left = newLeft + "px";
      preview.style.top = newTop + "px";

      // Update page number instance data
      if (pageNum && pageNumberInstances[pageNum - 1]) {
        pageNumberInstances[pageNum - 1].customLeft = newLeft;
        pageNumberInstances[pageNum - 1].customTop = newTop;
        pageNumberInstances[pageNum - 1].dragged = true;
        pageNumberInstances[pageNum - 1].isCustomPosition = true;

        // Show "Apply to All" button for this page
        const applyBtn = card.querySelector(".page-apply-btn");
        if (applyBtn) {
          applyBtn.style.display = "block";
        }
      }
    };

    const stopDrag = () => {
      if (!isDragging) return;

      isDragging = false;
      isDraggingGlobal = false;
      preview.classList.remove("dragging");
      preview.style.zIndex = "5";
      preview.style.cursor = "move";

      document.removeEventListener("mousemove", drag);
      document.removeEventListener("mouseup", stopDrag);
      document.removeEventListener("touchmove", dragTouch);
      document.removeEventListener("touchend", stopDrag);
    };

    // Mouse events
    preview.addEventListener("mousedown", startDrag);

    // Touch events
    preview.addEventListener(
      "touchstart",
      (e) => {
        if (e.touches.length === 1) {
          startDrag(e);
        }
      },
      { passive: false }
    );

    // Prevent default drag behavior
    preview.addEventListener("dragstart", (e) => {
      e.preventDefault();
    });
  }

  function createPageNumberPreview(card) {
    const canvas = card.querySelector("canvas");
    const pageNum = parseInt(card.dataset.pageNum);

    const startPageNum = parseInt(startPage.value) || 1;
    const endPageNum = parseInt(endPage.value) || totalPages;

    if (pageNum < startPageNum || pageNum > endPageNum) {
      return null;
    }

    const startNumValue = parseInt(startNumber.value) || 1;
    const displayNum = startNumValue + (pageNum - startPageNum);

    let text = customText.value || "{n}";
    text = text.replace(/\{n\}/g, displayNum);
    text = text.replace(/\{total\}/g, totalPages);

    const preview = document.createElement("div");
    preview.className = "page-number-preview";
    preview.textContent = text;
    preview.dataset.pageNum = pageNum;
    preview.setAttribute("draggable", "true");
    preview.setAttribute("role", "button");
    preview.setAttribute(
      "aria-label",
      `Page number ${displayNum} - drag to reposition`
    );
    preview.setAttribute("tabindex", "0");

    const visualScale =
      canvas.offsetWidth / parseFloat(card.dataset.baseWidth);
    preview.style.fontSize =
      (parseInt(fontSize.value) || 12) * visualScale + "px";
    preview.style.color = fontColor.value;
    preview.style.fontWeight = boldBtn.classList.contains("active")
      ? "bold"
      : "normal";
    preview.style.fontStyle = italicBtn.classList.contains("active")
      ? "italic"
      : "normal";
    preview.style.textDecoration = underlineBtn.classList.contains("active")
      ? "underline"
      : "none";

    const fonts = {
      helvetica: "Arial, sans-serif",
      times: "Times New Roman, serif",
      courier: "Courier New, monospace",
      symbol: "Symbol, serif",
      zapfdingbats: "Zapf Dingbats, serif",
    };
    preview.style.fontFamily = fonts[fontFamily.value] || fonts.helvetica;

    preview.style.position = "absolute";
    preview.style.cursor = "move";
    preview.style.userSelect = "none";
    preview.style.zIndex = "5";
    preview.style.pointerEvents = "auto";

    // Get page number instance data
    const pageData = pageNumberInstances[pageNum - 1];

    let left, top;

    // Check if page has a custom position that should be used
    if (
      pageData &&
      pageData.dragged &&
      pageData.customLeft !== null &&
      pageData.customTop !== null &&
      pageData.isCustomPosition
    ) {
      // Use saved custom position
      left = pageData.customLeft;
      top = pageData.customTop;
    } else {
      // Calculate default position based on selected option
      const ctx = canvas.getContext("2d");
      ctx.font = `${(parseInt(fontSize.value) || 12) * visualScale}px ${preview.style.fontFamily}`;
      const previewWidth = ctx.measureText(text).width;
      const previewHeight = (parseInt(fontSize.value) || 12) * visualScale;

      const margin = 20 * visualScale;
      const pos = position.value;
      const canvasLeft = canvas.offsetLeft || 0;
      const canvasTop = canvas.offsetTop || 0;

      if (pos.startsWith("top")) {
        top = canvasTop + margin;
      } else {
        top = canvasTop + canvas.offsetHeight - margin - previewHeight;
      }

      if (pos.includes("left")) {
        left = canvasLeft + margin;
      } else if (pos.includes("right")) {
        left = canvasLeft + canvas.offsetWidth - margin - previewWidth;
      } else {
        left = canvasLeft + (canvas.offsetWidth - previewWidth) / 2;
      }

      // Update page number instance data
      if (!pageNumberInstances[pageNum - 1]) {
        pageNumberInstances[pageNum - 1] = {
          pageNum: pageNum,
          left: left,
          top: top,
          customLeft: null,
          customTop: null,
          dragged: false,
          scale: visualScale,
          baseWidth: parseFloat(card.dataset.baseWidth),
          baseHeight: parseFloat(card.dataset.baseHeight),
          isCustomPosition: false,
          dropdownPosition: pos,
        };
      } else {
        pageNumberInstances[pageNum - 1].left = left;
        pageNumberInstances[pageNum - 1].top = top;
        pageNumberInstances[pageNum - 1].dropdownPosition = pos;
      }
    }

    preview.style.left = left + "px";
    preview.style.top = top + "px";

    return preview;
  }

  function updatePreview(card) {
    const pageNum = parseInt(card.dataset.pageNum);

    // Remove existing preview
    const oldPreview = card.querySelector(".page-number-preview");
    if (oldPreview) oldPreview.remove();

    // Create new preview
    const preview = createPageNumberPreview(card);
    if (!preview) return;

    card.appendChild(preview);

    // Initialize dragging
    makeDraggable(preview, card);

    // Check if we need to create or update the Apply button
    let applyBtn = card.querySelector(".page-apply-btn");
    if (!applyBtn) {
      // Create "Apply to All" button if it doesn't exist
      applyBtn = document.createElement("button");
      applyBtn.className = "page-apply-btn";
      applyBtn.innerHTML =
        '<i class="fa fa-clone" aria-hidden="true"></i> Apply to All';
      applyBtn.setAttribute(
        "aria-label",
        "Apply this page number position to all pages"
      );
      applyBtn.setAttribute("title", "Apply this position to all pages");
      applyBtn.onclick = (e) => {
        e.stopPropagation();
        applyThisPageToAll(card);
      };
      card.appendChild(applyBtn);
    }

    // Show/hide Apply button based on whether this page has a custom position
    const pageData = pageNumberInstances[pageNum - 1];
    if (pageData && pageData.dragged && pageData.isCustomPosition) {
      applyBtn.style.display = "block";
    } else {
      applyBtn.style.display = "none"; // Hide when using dropdown position
    }

    // Keyboard navigation
    preview.addEventListener("keydown", (e) => {
      if (e.key === " " || e.key === "Enter") {
        e.preventDefault();
        preview.focus();
      } else if (e.key.startsWith("Arrow")) {
        e.preventDefault();
        movePreviewWithArrow(e.key, preview, card);
      }
    });

    // Focus styling
    preview.addEventListener("focus", () => {
      preview.style.outline = "2px solid #4f46e5";
      preview.style.outlineOffset = "2px";
    });

    preview.addEventListener("blur", () => {
      preview.style.outline = "";
      preview.style.outlineOffset = "";
    });
  }

  function movePreviewWithArrow(key, preview, card) {
    if (isDraggingGlobal) return;

    const step = 5;
    let left = parseFloat(preview.style.left) || 0;
    let top = parseFloat(preview.style.top) || 0;
    const canvas = card.querySelector("canvas");
    const canvasRect = canvas.getBoundingClientRect();
    const cardRect = card.getBoundingClientRect();
    const previewRect = preview.getBoundingClientRect();
    const pageNum = parseInt(preview.dataset.pageNum);

    // Constrain movement within canvas
    const minX = canvasRect.left - cardRect.left;
    const maxX = minX + canvasRect.width - previewRect.width;
    const minY = canvasRect.top - cardRect.top;
    const maxY = minY + canvasRect.height - previewRect.height;

    switch (key) {
      case "ArrowLeft":
        left = Math.max(minX, left - step);
        break;
      case "ArrowRight":
        left = Math.min(maxX, left + step);
        break;
      case "ArrowUp":
        top = Math.max(minY, top - step);
        break;
      case "ArrowDown":
        top = Math.min(maxY, top + step);
        break;
    }

    preview.style.left = left + "px";
    preview.style.top = top + "px";

    // Update page number instance data
    if (pageNum && pageNumberInstances[pageNum - 1]) {
      pageNumberInstances[pageNum - 1].customLeft = left;
      pageNumberInstances[pageNum - 1].customTop = top;
      pageNumberInstances[pageNum - 1].dragged = true;
      pageNumberInstances[pageNum - 1].isCustomPosition = true;

      // Show "Apply to All" button
      const applyBtn = card.querySelector(".page-apply-btn");
      if (applyBtn) {
        applyBtn.style.display = "block";
      }
    }
  }

  function applyThisPageToAll(sourceCard) {
    const sourcePreview = sourceCard.querySelector(".page-number-preview");
    if (!sourcePreview) {
      showError("No page number found on this page");
      return;
    }

    const sourcePageNum = parseInt(sourcePreview.dataset.pageNum);
    const sourceData = pageNumberInstances[sourcePageNum - 1];

    if (
      !sourceData ||
      !sourceData.dragged ||
      !sourceData.isCustomPosition
    ) {
      showError(
        "Please drag the page number to a position first before applying to all"
      );
      return;
    }

    const sourceLeft = parseFloat(sourcePreview.style.left);
    const sourceTop = parseFloat(sourcePreview.style.top);
    const sourceCanvas = sourceCard.querySelector("canvas");

    if (!sourceCanvas) {
      showError("Canvas not found");
      return;
    }

    // Get relative position within the canvas
    const canvasOffsetLeft = sourceCanvas.offsetLeft || 0;
    const canvasOffsetTop = sourceCanvas.offsetTop || 0;

    const relativeX = sourceLeft - canvasOffsetLeft;
    const relativeY = sourceTop - canvasOffsetTop;

    // Get all page cards
    const allCards = document.querySelectorAll(".page-card");
    let appliedCount = 0;

    allCards.forEach((card) => {
      if (card === sourceCard) return;
      if (card.classList.contains("out-of-range")) return;

      const canvas = card.querySelector("canvas");
      if (!canvas) return;

      const pageNum = parseInt(card.dataset.pageNum);
      if (!pageNum) return;

      // Calculate new position for this page
      const newLeft = (canvas.offsetLeft || 0) + relativeX;
      const newTop = (canvas.offsetTop || 0) + relativeY;

      // Constrain within canvas bounds
      const canvasRect = canvas.getBoundingClientRect();
      const cardRect = card.getBoundingClientRect();
      const previewWidth = sourcePreview.offsetWidth;
      const previewHeight = sourcePreview.offsetHeight;

      const minX = canvasRect.left - cardRect.left;
      const maxX = minX + canvasRect.width - previewWidth;
      const minY = canvasRect.top - cardRect.top;
      const maxY = minY + canvasRect.height - previewHeight;

      const constrainedLeft = Math.max(minX, Math.min(newLeft, maxX));
      const constrainedTop = Math.max(minY, Math.min(newTop, maxY));

      // Update page number instance
      if (!pageNumberInstances[pageNum - 1]) {
        pageNumberInstances[pageNum - 1] = {
          pageNum: pageNum,
          customLeft: null,
          customTop: null,
          dragged: false,
          isCustomPosition: false,
        };
      }

      pageNumberInstances[pageNum - 1].customLeft = constrainedLeft;
      pageNumberInstances[pageNum - 1].customTop = constrainedTop;
      pageNumberInstances[pageNum - 1].dragged = false; // Set to false so button doesn't show
      pageNumberInstances[pageNum - 1].isCustomPosition = false; // Set to false so button doesn't show

      // Update preview position if it exists
      const preview = card.querySelector(".page-number-preview");
      if (preview) {
        preview.style.left = constrainedLeft + "px";
        preview.style.top = constrainedTop + "px";
      }

      // Hide "Apply to All" button on this card
      const applyBtn = card.querySelector(".page-apply-btn");
      if (applyBtn) {
        applyBtn.style.display = "none";
      }

      appliedCount++;
    });

    // Also hide "Apply to All" button on source card
    const sourceApplyBtn = sourceCard.querySelector(".page-apply-btn");
    if (sourceApplyBtn) {
      sourceApplyBtn.style.display = "none";
    }

    // Reset source page's dragged state too
    if (sourceData) {
      sourceData.dragged = false;
      sourceData.isCustomPosition = false;
    }

    showSuccess(
      ` Page number position applied to ${appliedCount + 1} pages!`
    );
  }

  function updateAllPreviews() {
    if (isDraggingGlobal) return;

    document.querySelectorAll(".page-card").forEach((card) => {
      updatePreview(card);
    });
  }

  function updatePageRangeDisplay() {
    const start = parseInt(startPage.value) || 1;
    const end = parseInt(endPage.value) || totalPages;
    const effectiveEnd = end === 0 ? totalPages : Math.min(end, totalPages);

    document.querySelectorAll(".page-card").forEach((card) => {
      const pageNum = parseInt(card.dataset.pageNum);
      if (pageNum < start || pageNum > effectiveEnd) {
        card.classList.add("out-of-range");
      } else {
        card.classList.remove("out-of-range");
      }
    });

    updateAllPreviews();
  }

  // Position dropdown change handler
  position.addEventListener("change", () => {
    const selectedPosition = position.value;

    // When dropdown changes, reset ALL pages to dropdown position
    document.querySelectorAll(".page-card").forEach((card) => {
      const pageNum = parseInt(card.dataset.pageNum);
      if (pageNumberInstances[pageNum - 1]) {
        // Reset to dropdown position
        pageNumberInstances[pageNum - 1].dragged = false;
        pageNumberInstances[pageNum - 1].isCustomPosition = false;
        pageNumberInstances[pageNum - 1].customLeft = null;
        pageNumberInstances[pageNum - 1].customTop = null;
        pageNumberInstances[pageNum - 1].dropdownPosition =
          selectedPosition;
      }
    });

    updateAllPreviews();
  });

  // Add event listeners for other options changes
  [
    fontFamily,
    fontSize,
    fontColor,
    customText,
    startPage,
    endPage,
    startNumber,
  ].forEach((el) => {
    if (el) {
      el.addEventListener("change", updateAllPreviews);
      el.addEventListener("input", updateAllPreviews);
    }
  });

// COMPLETELY REWRITTEN to match watermark code EXACTLY
function calculatePagePositions() {
  const pagePositions = [];
  
  document.querySelectorAll(".page-card").forEach((card) => {
    if (card.classList.contains("out-of-range")) return;

    const preview = card.querySelector(".page-number-preview");
    if (!preview) return;

    const canvas = card.querySelector("canvas");
    const pageNum = parseInt(card.dataset.pageNum);
    const pageData = pageNumberInstances[pageNum - 1];

    // Get positions
    const canvasRect = canvas.getBoundingClientRect();
    const cardRect = card.getBoundingClientRect();
    const previewRect = preview.getBoundingClientRect();

    // Calculate canvas offset relative to card
    const canvasOffsetLeft = canvasRect.left - cardRect.left;
    const canvasOffsetTop = canvasRect.top - cardRect.top;

    // Get preview position relative to card
    const previewLeft = parseFloat(preview.style.left) || 0;
    const previewTop = parseFloat(preview.style.top) || 0;

    // Calculate position relative to canvas
    let canvasRelativeX, canvasRelativeY;

    // Check if text is centered (transform has translate(-50%, -50%))
    const isCenterTransform = preview.style.transform.includes('translate(-50%, -50%)');
    
    if (isCenterTransform) {
      // For centered text, the left/top is already at the center
      canvasRelativeX = previewLeft - canvasOffsetLeft;
      canvasRelativeY = previewTop - canvasOffsetTop;
    } else {
      // For left/right aligned, we need to add half width/height to get center
      canvasRelativeX = (previewLeft - canvasOffsetLeft) + (previewRect.width / 2);
      canvasRelativeY = (previewTop - canvasOffsetTop) + (previewRect.height / 2);
    }

    // Convert to percentages (CENTER position, like watermark)
    const leftPercent = (canvasRelativeX / canvasRect.width) * 100;
    const topPercent = ((canvasRect.height - canvasRelativeY) / canvasRect.height) * 100;

    // Determine alignment
    let alignment = "center";
    if (pageData && pageData.isCustomPosition) {
      // For custom dragged positions, check the transform
      if (preview.style.transform.includes('translate(-50%, -50%)')) {
        alignment = "center";
      } else {
        // Check if near left or right edge
        const textWidth = previewRect.width;
        const textLeft = previewLeft - canvasOffsetLeft;
        
        if (textLeft < 20) alignment = "left";
        else if (textLeft > canvasRect.width - textWidth - 20) alignment = "right";
        else alignment = "center";
      }
    } else {
      // Use dropdown position
      const pos = position.value;
      if (pos.includes("left")) alignment = "left";
      else if (pos.includes("right")) alignment = "right";
      else alignment = "center";
    }

    pagePositions.push({
      pageNum: pageNum,
      left: leftPercent.toFixed(2) + "%",
      top: topPercent.toFixed(2) + "%",
      position: alignment,  // 'left', 'center', 'right'
      isCustomPosition: pageData ? pageData.isCustomPosition : false,
    });
    
    console.log(`Page ${pageNum}:`, {
      center: `${leftPercent.toFixed(2)}%, ${topPercent.toFixed(2)}%`,
      alignment: alignment
    });
  });
  
  return pagePositions;
}

  addNumbersBtn.addEventListener("click", async () => {
    clearError();
    if (!files.length) {
      showError("Please select at least one PDF file");
      return;
    }

    // Calculate positions using the corrected function
    const pagePositions = calculatePagePositions();

    console.log("Sending page positions to backend:", pagePositions);

    const fd = new FormData();
    files.forEach((f) => fd.append("files", f));
    fd.append(
      "options",
      JSON.stringify({
        position: position.value,
        fontFamily: fontFamily.value,
        fontSize: parseInt(fontSize.value),
        fontColor: fontColor.value,
        bold: boldBtn.classList.contains("active"),
        italic: italicBtn.classList.contains("active"),
        underline: underlineBtn.classList.contains("active"),
        customText: customText.value,
        startPage: parseInt(startPage.value),
        endPage: parseInt(endPage.value) || totalPages,
        startNumber: parseInt(startNumber.value),
        positions: pagePositions,
      }),
    );

    addNumbersBtn.disabled = true;
    addNumbersBtn.classList.add("btn-loading");

    try {
      console.log("Sending request to backend...");
      const res = await fetch(BACKEND_URL, {
        method: "POST",
        body: fd,
      });

      if (!res.ok) {
        const errorText = await res.text();
        console.error("Backend error:", errorText);
        throw new Error(errorText || "Failed to add page numbers");
      }

      const blob = await res.blob();
      const url = URL.createObjectURL(blob);

      downloadBtn.href = url;
      downloadBtn.download = "page-numbered.pdf";
      shareBtn.href = url;

      resultBtns.style.display = "block";
      uploadSection.style.display = "none";
      addNumbersBtn.style.display = "none";
      fileList.style.display = "none";
      pagesGrid.style.display = "none";
      optionsContainer.style.display = "none";

      const isSmallDevice = window.matchMedia("(max-width: 768px)").matches;

      if (!isSmallDevice) {
        pdfFrame.src = url;
        pdfPreview.style.display = "block";
      }

      fileNameLink.onclick = (e) => {
        e.preventDefault();
        isSmallDevice
          ? window.open(url, "_blank")
          : pdfPreview.scrollIntoView({ behavior: "smooth" });
      };
      window.scrollTo({ top: 0, behavior: "smooth" });
    } catch (err) {
      console.error("Error:", err);
      showError(err.message || "Error adding page numbers");
    } finally {
      addNumbersBtn.disabled = false;
      addNumbersBtn.classList.remove("btn-loading");
    }
  });

  resetBtn.addEventListener("click", () => {
    files = [];
    totalPages = 0;
    pageNumberInstances = [];
    pdfUpload.value = "";
    fileList.innerHTML = "";
    fileList.style.display = "none";
    pagesGrid.innerHTML = "";
    pagesGrid.style.display = "none";
    resultBtns.style.display = "none";
    pdfPreview.style.display = "none";
    uploadSection.style.display = "block";
    optionsContainer.style.display = "none";
    addNumbersBtn.style.display = "block";
    clearError();
    window.scrollTo({ top: 0, behavior: "smooth" });
  });

  // Keyboard accessibility for upload label
  document
    .querySelector(".upload-label")
    .addEventListener("keypress", (e) => {
      if (e.key === "Enter" || e.key === " ") {
        e.preventDefault();
        pdfUpload.click();
      }
    });

  // Prevent text selection while dragging
  document.addEventListener("selectstart", (e) => {
    if (isDraggingGlobal) {
      e.preventDefault();
    }
  });

  // Handle window resize
  let resizeTimeout;
  window.addEventListener("resize", () => {
    clearTimeout(resizeTimeout);
    resizeTimeout = setTimeout(() => {
      updateAllPreviews();
    }, 250);
  });

  // Initialize if there are any files on page load (for page refresh)
  window.addEventListener("load", () => {
    if (files.length > 0) {
      loadPDFs();
    }
  });
</script>
  </body>
</html>
