<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Primary Meta Tags -->
    <title>
      PDF to PowerPoint Converter Online Free - Convert PDF to PPTX | NextoPDF
    </title>
    <meta
      name="title"
      content="PDF to PowerPoint Converter Online Free - Convert PDF to PPTX | NextoPDF"
    />
    <meta
      name="description"
      content="Convert PDF to PowerPoint (PPTX) with automatic OCR detection. Transform scanned PDFs into editable presentations. Supports 14+ languages. Free and secure."
    />
    <meta
      name="keywords"
      content="PDF to PowerPoint, PDF to PPTX, convert PDF to PPT, PDF converter, online PDF to PowerPoint, free PDF to PPTX converter, PDF to slides, OCR PowerPoint"
    />
    <meta name="author" content="NextoPDF" />
    <meta
      name="robots"
      content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"
    />

    <!-- Canonical URL -->
    <link rel="canonical" href="https://nextopdf.com/pdf-to-ppt" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://nextopdf.com/pdf-to-ppt" />
    <meta
      property="og:title"
      content="PDF to PowerPoint Converter Online Free - Convert PDF to PPTX | NextoPDF"
    />
    <meta
      property="og:description"
      content="Convert PDF to PowerPoint presentations online for free. Transform your PDF documents into editable PPTX slides with OCR support."
    />
    <meta
      property="og:image"
      content="https://nextopdf.com/images/pdf-to-ppt-og.png"
    />
    <meta property="og:site_name" content="NextoPDF" />
    <meta property="og:locale" content="en_US" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="https://nextopdf.com/pdf-to-ppt" />
    <meta
      name="twitter:title"
      content="PDF to PowerPoint Converter Online Free - Convert PDF to PPTX | NextoPDF"
    />
    <meta
      name="twitter:description"
      content="Convert PDF to PowerPoint presentations online for free. Transform your PDF documents into editable PPTX slides."
    />
    <meta
      name="twitter:image"
      content="https://nextopdf.com/images/pdf-to-ppt-twitter.png"
    />
    <meta name="google-adsense-account" content="ca-pub-5797619165090350" />

    <!-- Structured Data / Schema.org -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "NextoPDF - PDF to PowerPoint Converter",
        "url": "https://nextopdf.com/pdf-to-ppt",
        "description": "Free online tool to convert PDF files to PowerPoint presentations with OCR support",
        "applicationCategory": "UtilitiesApplication",
        "operatingSystem": "Any",
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "USD"
        },
        "featureList": [
          "Convert PDF to PPTX format",
          "OCR support for scanned PDFs",
          "14+ language support",
          "Maintain formatting and layout",
          "Secure and private processing",
          "No registration required"
        ]
      }
    </script>

    <!-- Breadcrumb Schema -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "Home",
            "item": "https://nextopdf.com"
          },
          {
            "@type": "ListItem",
            "position": 2,
            "name": "PDF to PowerPoint",
            "item": "https://nextopdf.com/pdf-to-ppt"
          }
        ]
      }
    </script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&family=Inter:wght@400;500;600&display=swap"
      rel="stylesheet"
    />

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />

    <!-- CSS -->
    <link rel="stylesheet" href="./css/style.css" />

    <!-- Favicon -->
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="./images/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="./images/favicon-16x16.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="./images/apple-touch-icon.png"
    />

    <style>
      /* Accessibility: Skip to main content link */
      .skip-to-main {
        position: absolute;
        top: -40px;
        left: 0;
        background: #4f46e5;
        color: white;
        padding: 8px 16px;
        text-decoration: none;
        z-index: 100;
        border-radius: 0 0 4px 0;
        font-weight: 500;
      }

      .skip-to-main:focus {
        top: 0;
      }

      /* Additional accessibility improvements */
      button:focus,
      a:focus,
      input:focus {
        outline: 2px solid #4f46e5;
        outline-offset: 2px;
      }

      /* Screen reader only text */
      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border-width: 0;
      }

      /* Enhanced Multi-select dropdown styles */
      .multi-select {
        position: relative;
        width: 100%;
        margin-top: 10px;
        margin-bottom: 20px;
      }

      .select-label {
        font-weight: 600;
        font-size: 16px;
        color: #1f2937;
        margin-bottom: 8px;
        display: block;
      }

      .select-box {
        border: 2px solid #e5e7eb;
        border-radius: 10px;
        padding: 12px 14px;
        background: #fff;
        cursor: pointer;
        min-height: 48px;
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        align-items: center;
        transition: all 0.2s ease;
        position: relative;
      }

      .select-box:hover {
        border-color: #4f46e5;
        box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.05);
      }

      .select-box.open {
        border-color: #4f46e5;
        box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.1);
        background: #fafafa;
      }

      .select-box::after {
        content: "\f078";
        font-family: "Font Awesome 6 Free";
        font-weight: 900;
        position: absolute;
        right: 14px;
        top: 50%;
        transform: translateY(-50%);
        color: #6b7280;
        transition: transform 0.2s ease;
        pointer-events: none;
      }

      .select-box.open::after {
        transform: translateY(-50%) rotate(180deg);
      }

      .select-placeholder {
        color: #9ca3af;
        font-size: 14px;
        user-select: none;
      }

      .tag {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: #fff;
        padding: 6px 12px;
        border-radius: 8px;
        font-size: 13px;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        font-weight: 500;
        box-shadow: 0 2px 4px rgba(102, 126, 234, 0.2);
        transition: all 0.2s ease;
      }

      .tag:hover {
        box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
        transform: translateY(-1px);
      }

      .tag .remove-tag {
        cursor: pointer;
        font-size: 16px;
        opacity: 0.9;
        transition: opacity 0.2s;
        width: 18px;
        height: 18px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.2);
      }

      .tag .remove-tag:hover {
        opacity: 1;
        background: rgba(255, 255, 255, 0.3);
      }

      #dropdown {
        display: none;
        position: absolute;
        width: 100%;
        background: white;
        border: 2px solid #4f46e5;
        border-radius: 10px;
        max-height: 320px;
        overflow: hidden;
        z-index: 1000;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        margin-top: 6px;
        animation: dropdownSlide 0.2s ease;
      }

      @keyframes dropdownSlide {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      #dropdown.show {
        display: flex;
        flex-direction: column;
      }

      #dropdown input {
        width: calc(100% - 60px);
        margin: 12px 14px;
        padding: 10px 14px;
        border: 2px solid #e5e7eb;
        border-radius: 8px;
        font-size: 14px;
        transition: all 0.2s ease;
        flex-shrink: 0;
      }

      #dropdown input:focus {
        outline: none;
        border-color: #4f46e5;
        box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
      }

      #dropdown input::placeholder {
        color: #9ca3af;
      }

      #options {
        overflow-y: auto;
        max-height: 240px;
      }

      .option {
        padding: 12px 16px;
        cursor: pointer;
        transition: all 0.15s ease;
        font-size: 14px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        position: relative;
      }

      .option:hover {
        background: #f3f4f6;
      }

      .option.selected {
        background: #ede9fe;
        color: #6d28d9;
        font-weight: 500;
      }

      .option.selected::after {
        content: "\f00c";
        font-family: "Font Awesome 6 Free";
        font-weight: 900;
        color: #6d28d9;
        font-size: 12px;
      }

      /* File list styling */
      .file-list {
        list-style: none;
        padding: 0;
        margin: 20px 0;
      }

      .file-list li {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 14px 18px;
        background: #f9fafb;
        border-radius: 10px;
        margin-bottom: 10px;
        border: 2px solid #e5e7eb;
        transition: all 0.2s ease;
      }

      .file-list li:hover {
        border-color: #d1d5db;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      }

      .file-list li .pdf-icon {
        color: #ef4444;
        margin-right: 12px;
        font-size: 20px;
      }

      .file-info {
        display: flex;
        align-items: center;
        flex: 1;
      }

      .file-name-text {
        font-weight: 500;
        color: #1f2937;
      }

      .delete-file {
        background: #ef4444;
        border: none;
        color: white;
        border-radius: 50%;
        width: 32px;
        height: 32px;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        flex-shrink: 0;
      }

      .delete-file i {
        color: #fff;
      }

      .delete-file:hover,
      .delete-file:focus {
        background: #dc2626;
        transform: scale(1.1);
      }

      /* Loading state */
      .btn-loading {
        pointer-events: none;
        opacity: 0.7;
      }

      .btn-loading .btn-text {
        display: none;
      }

      .btn-spinner {
        display: none;
      }

      .btn-loading .btn-spinner {
        display: inline-block;
      }

      /* Enhanced Error messages */
      .error-text {
        color: #dc2626;
        font-size: 14px;
        margin-top: 12px;
        padding: 12px 16px;
        background: #fee2e2;
        border-left: 4px solid #dc2626;
        border-radius: 8px;
        display: none;
        animation: slideIn 0.3s ease;
      }

      .error-text::before {
        content: "\f06a";
        font-family: "Font Awesome 6 Free";
        font-weight: 900;
        margin-right: 8px;
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Note styling */
      .note {
        background: #eff6ff;
        border-left: 4px solid #3b82f6;
        padding: 14px 18px;
        border-radius: 8px;
        font-size: 14px;
        color: #1e40af;
        margin-top: 20px;
        line-height: 1.6;
      }

      .note i {
        margin-right: 8px;
      }

      /* Smooth scrollbar for dropdown */
      #options::-webkit-scrollbar {
        width: 8px;
      }

      #options::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 10px;
      }

      #options::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 10px;
      }

      #options::-webkit-scrollbar-thumb:hover {
        background: #94a3b8;
      }

      /* Result buttons container */
      .result-btns-container {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        justify-content: center;
      }

      /* Responsive subtitle styling */
      .subtitle {
        font-size: 18px;
        color: #555;
        margin-bottom: 30px;
        line-height: 1.6;
      }

      /* Ad section spacing */
      .ad-section {
        min-height: 100px;
      }

      /* OCR Choice Dialog Styles */
      .ocr-dialog {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 99999;
        animation: fadeIn 0.3s ease;
        backdrop-filter: blur(5px);
      }

      .ocr-dialog.show {
        display: flex;
      }

      .ocr-dialog-content {
        background: white;
        position: relative;
        border-radius: 24px;
        padding: 35px;
        max-width: 500px;
        width: 90%;
        box-shadow: 0 25px 60px rgba(0, 0, 0, 0.3);
        animation: slideUp 0.3s ease;
      }

      .ocr-dialog-content h3 {
        color: #1f2937;
        margin-bottom: 15px;
        font-size: 24px;
        display: flex;
        align-items: center;
      }

      .ocr-dialog-content p {
        color: #4b5563;
        margin-bottom: 10px;
        line-height: 1.6;
        font-size: 16px;
      }

      .dialog-subtitle {
        font-weight: 600;
        color: #374151;
        margin-top: 20px;
        margin-bottom: 15px;
      }

      .ocr-dialog-options {
        display: flex;
        flex-direction: column;
        gap: 15px;
        margin: 20px 0;
      }

      .ocr-dialog-options button {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 25px 20px;
        border-radius: 16px;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 2px solid transparent;
        width: 100%;
        text-align: center;
      }

      .option-title {
        font-size: 18px;
        font-weight: 700;
        margin: 8px 0 5px;
      }

      .ocr-dialog-options button .option-desc {
        font-size: 14px;
        opacity: 0.9;
        color: inherit;
        line-height: 1.5;
      }

      .ocr-dialog-options .cta-button {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
      }

      .ocr-dialog-options .cta-button:hover {
        transform: translateY(-3px);
        box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
      }

      .ocr-dialog-options .secondary-btn {
        background: white;
        color: #4b5563;
        border: 2px solid #e5e7eb;
      }

      .ocr-dialog-options .secondary-btn:hover {
        border-color: #667eea;
        background: #f9fafb;
        transform: translateY(-3px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      }

      .text-btn {
        position: absolute;
        top: 34px;
        right: 15px;
        background: red;
        border: none;
        color: #fff;
        font-size: 20px;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 999999;
        cursor: pointer;
      }

      .text-btn:hover {
        color: #ef4444;
        background: #fef2f2;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes slideUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Processing Dialog Styles */
      .processing-dialog {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        backdrop-filter: blur(5px);
      }

      .processing-dialog.show {
        display: flex;
      }

      .processing-dialog-content {
        background: white;
        border-radius: 20px;
        padding: 40px;
        max-width: 400px;
        width: 90%;
        text-align: center;
        box-shadow: 0 25px 60px rgba(0, 0, 0, 0.3);
      }

      .spinner {
        width: 80px;
        height: 80px;
        border: 4px solid #f3f4f6;
        border-top: 4px solid #667eea;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 20px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      @media (max-width: 768px) {
        .subtitle {
          font-size: 16px;
        }

        .result-btns-container {
          flex-direction: column;
        }

        .result-btns-container .cta-button,
        .result-btns-container .secondary-btn {
          width: 100%;
        }
      }
    </style>

    <!-- Google AdSense -->
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5797619165090350"
      crossorigin="anonymous"
    ></script>
  </head>

  <body>
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="skip-to-main">Skip to main content</a>

    <!-- Header -->
    <section id="header-placeholder"></section>

    <!-- Main Content -->
    <main id="main-content">
      <!-- PDF to PPT Tool Section -->
      <section class="merge-tool" aria-labelledby="ppt-heading">
        <div class="container">
          <h1 id="ppt-heading">
            NextoPDF - PDF to PowerPoint Converter with OCR
          </h1>
          <p class="subtitle">
            Convert PDF to PowerPoint presentations with automatic OCR
            detection. Transform scanned PDFs into editable slides. Supports 14+
            languages. Fast, secure, and completely free.
          </p>

          <div class="upload-section">
            <div id="uploadSection">
              <label
                for="pdfUpload"
                class="upload-label"
                tabindex="0"
                role="button"
                aria-label="Choose PDF file to upload"
              >
                <i class="fa fa-upload" aria-hidden="true"></i>
                <span>Choose PDF File</span>
              </label>
              <input
                type="file"
                id="pdfUpload"
                accept=".pdf"
                aria-label="Select PDF file to convert to PowerPoint"
              />
            </div>

            <ul
              id="fileList"
              class="file-list"
              role="list"
              aria-label="Selected PDF file"
              style="display: none"
            ></ul>

            <!-- Language Selection -->
            <label class="select-label" for="selectBox" id="languageLabel">
              OCR Languages
              <span style="font-weight: 400; color: #6b7280; font-size: 14px">
                (For scanned PDFs - Select one or more)
              </span>
            </label>
            <div class="multi-select">
              <div
                class="select-box"
                id="selectBox"
                role="button"
                tabindex="0"
                aria-labelledby="languageLabel"
                aria-expanded="false"
                aria-haspopup="listbox"
              >
                <span class="tag">English</span>
              </div>
              <div id="dropdown" role="listbox" aria-labelledby="languageLabel">
                <input
                  type="text"
                  id="searchLang"
                  placeholder="Search language..."
                  aria-label="Search for languages"
                />
                <div id="options"></div>
              </div>
            </div>

            <button
              id="convertBtn"
              class="cta-button"
              aria-label="Convert PDF to PowerPoint"
            >
              <span class="btn-spinner" aria-hidden="true">
                <i class="fa fa-spinner fa-spin"></i>
                Processing...
              </span>
              <span class="btn-text">
                <i class="fa fa-file-powerpoint" aria-hidden="true"></i>
                Convert to PowerPoint
              </span>
            </button>

            <p
              class="error-text"
              id="errorMsg"
              role="alert"
              aria-live="polite"
            ></p>

            <!-- Result Section -->
            <div
              id="resultBtns"
              style="display: none; margin-top: 20px"
              role="region"
              aria-label="Conversion results"
            >
              <div id="resultCard" class="result-card">
                <i
                  class="fa fa-file-powerpoint"
                  aria-hidden="true"
                  style="font-size: 60px; color: white"
                ></i>
              </div>
              <p class="file-name">
                <a href="#" id="fileNameLink" aria-label="View converted PPTX"
                  >presentation.pptx</a
                >
              </p>

              <div class="result-btns-container">
                <a
                  id="downloadBtn"
                  href="#"
                  class="cta-button"
                  download="presentation.pptx"
                  aria-label="Download PowerPoint presentation"
                >
                  <i class="fa fa-download" aria-hidden="true"></i> Download
                </a>
                <button
                  id="shareBtn"
                  class="cta-button"
                  aria-label="Share PowerPoint presentation"
                >
                  <i class="fa fa-share-alt" aria-hidden="true"></i> Share
                </button>
                <button
                  id="resetBtn"
                  class="secondary-btn"
                  aria-label="Convert another PDF"
                >
                  <i class="fa fa-rotate-right" aria-hidden="true"></i> Convert
                  Another PDF
                </button>
              </div>
            </div>

            <p class="note">
              <i class="fa fa-info-circle" aria-hidden="true"></i>
              <strong>Smart Conversion:</strong> Text-based PDFs will have
              selectable text in PowerPoint. Scanned/image-based PDFs will be
              converted to images with OCR text in speaker notes. Select
              multiple languages if your document contains text in different
              languages.
            </p>
          </div>
        </div>
      </section>

      <!-- AdSense Ad Placeholder (Above the fold) -->
      <section class="ad-section" style="margin: 40px 0; text-align: center">
        <div class="container">
          <script
            async
            src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5797619165090350"
            crossorigin="anonymous"
          ></script>
          <!-- PDF to PPT ads 1 -->
          <ins
            class="adsbygoogle"
            style="display: block"
            data-ad-client="ca-pub-5797619165090350"
            data-ad-slot="7553156845"
            data-ad-format="auto"
            data-full-width-responsive="true"
          ></ins>
          <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
        </div>
      </section>

      <!-- How to Convert Section -->
      <section class="features" style="background: #f9fafb">
        <div class="container">
          <h2>How to Convert PDF to PowerPoint Online</h2>
          <p
            style="
              text-align: center;
              color: #555;
              margin-bottom: 40px;
              max-width: 800px;
              margin-left: auto;
              margin-right: auto;
            "
          >
            Follow these simple steps to convert your PDF documents into
            editable PowerPoint presentations using our free online tool.
          </p>

          <div class="feature-grid">
            <div class="feature-card">
              <div
                style="
                  font-size: 48px;
                  color: #4f46e5;
                  font-weight: bold;
                  margin-bottom: 10px;
                "
              >
                1
              </div>
              <h3>Upload PDF File</h3>
              <p>
                Click "Choose PDF File" button and select your PDF document from
                your device. Supported file types include both text-based and
                scanned PDFs.
              </p>
            </div>
            <div class="feature-card">
              <div
                style="
                  font-size: 48px;
                  color: #4f46e5;
                  font-weight: bold;
                  margin-bottom: 10px;
                "
              >
                2
              </div>
              <h3>Select Languages</h3>
              <p>
                Choose OCR languages if your PDF contains scanned images or text
                in multiple languages. This ensures accurate text recognition
                and conversion.
              </p>
            </div>
            <div class="feature-card">
              <div
                style="
                  font-size: 48px;
                  color: #4f46e5;
                  font-weight: bold;
                  margin-bottom: 10px;
                "
              >
                3
              </div>
              <h3>Convert & Download</h3>
              <p>
                Click "Convert to PowerPoint" and wait a few moments. Once
                converted, download your PPTX file immediately to your device
                for editing.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- Why Convert PDFs Section -->
      <section class="benefits" style="background: white; padding: 60px 20px">
        <div class="container">
          <h2>Why Use Our PDF to PowerPoint Converter?</h2>
          <div class="feature-grid">
            <div class="feature-card">
              <i
                class="fas fa-bolt"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Lightning Fast</h3>
              <p>
                Convert PDF files to PowerPoint in seconds with our optimized
                processing. No waiting in queues or slow uploads.
              </p>
            </div>
            <div class="feature-card">
              <i
                class="fas fa-shield-alt"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Secure & Private</h3>
              <p>
                Your files are processed securely. We never store your PDFs on
                our servers. Complete privacy and security guaranteed.
              </p>
            </div>
            <div class="feature-card">
              <i
                class="fas fa-dollar-sign"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>100% Free</h3>
              <p>
                Convert unlimited PDF files to PowerPoint without any charges,
                subscriptions, or hidden fees. Free forever for everyone.
              </p>
            </div>
            <div class="feature-card">
              <i
                class="fas fa-user-lock"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>No Registration</h3>
              <p>
                Start converting PDFs immediately without creating an account or
                providing personal information.
              </p>
            </div>
            <div class="feature-card">
              <i
                class="fas fa-mobile-alt"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Works Everywhere</h3>
              <p>
                Use on any device - Windows, Mac, Linux, iOS, or Android. Works
                perfectly in all modern browsers.
              </p>
            </div>
            <div class="feature-card">
              <i
                class="fas fa-language"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Multi-Language OCR</h3>
              <p>
                Support for 14+ languages with advanced OCR technology for
                scanned PDFs and image-based documents.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- AdSense Ad Placeholder (Mid-content) -->
      <section
        class="ad-section"
        style="
          margin: 40px 0;
          text-align: center;
          background: #f9fafb;
          padding: 40px 20px;
        "
      >
        <div class="container">
          <script
            async
            src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5797619165090350"
            crossorigin="anonymous"
          ></script>
          <!-- PDF to PPT ads 2 -->
          <ins
            class="adsbygoogle"
            style="display: block"
            data-ad-client="ca-pub-5797619165090350"
            data-ad-slot="7553156845"
            data-ad-format="auto"
            data-full-width-responsive="true"
          ></ins>
          <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
        </div>
      </section>

      <!-- Detailed Guide Section -->
      <section class="features" style="background: white">
        <div class="container">
          <h2>Complete Guide to PDF to PowerPoint Conversion</h2>
          <div style="max-width: 900px; margin: 0 auto; text-align: left">
            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              What Does PDF to PowerPoint Conversion Mean?
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 25px">
              Converting PDF to PowerPoint means transforming a static PDF
              document into an editable PPTX presentation file. This process
              extracts content, images, and formatting from your PDF and
              recreates them as PowerPoint slides. When you convert PDFs to
              PowerPoint, you gain the ability to edit text, modify layouts, add
              animations, and customize the presentation according to your
              needs. This is particularly useful when you receive PDF reports,
              documents, or presentations that you need to modify, update, or
              repurpose for your own presentations.
            </p>

            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              Common Reasons to Convert PDF to PowerPoint
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 15px">
              There are numerous practical situations where converting PDFs to
              PowerPoint becomes essential:
            </p>
            <ul
              style="
                color: #555;
                line-height: 1.8;
                margin-bottom: 25px;
                padding-left: 25px;
              "
            >
              <li style="margin-bottom: 10px">
                <strong>Business Presentations:</strong> Convert PDF reports,
                whitepapers, or proposals into editable PowerPoint presentations
                for meetings and pitches.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Educational Materials:</strong> Transform PDF lecture
                notes, textbooks, or research papers into presentation slides
                for teaching or studying.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Content Repurposing:</strong> Reuse existing PDF content
                by converting it to PowerPoint for webinars, training sessions,
                or workshops.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Collaboration:</strong> Convert PDFs to PPTX format to
                enable team members to collaborate and edit presentations
                together.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Template Creation:</strong> Use PDF designs as a
                starting point to create custom PowerPoint templates for your
                organization.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Archive Modernization:</strong> Update old PDF
                presentations to modern PowerPoint format with new branding and
                features.
              </li>
            </ul>

            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              How Our PDF to PowerPoint Converter Works
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 25px">
              Our online PDF to PowerPoint converter uses advanced technology to
              transform your documents accurately. The tool first analyzes your
              PDF to determine if it's text-based or image-based (scanned). For
              text-based PDFs, we extract the content directly, maintaining
              formatting, fonts, and layout. For scanned or image-based PDFs, we
              employ OCR (Optical Character Recognition) technology to recognize
              and extract text from images. The converter then intelligently
              organizes the content into PowerPoint slides, preserving the
              visual structure of your original PDF while making the content
              fully editable in PPTX format.
            </p>

            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              Understanding OCR Technology for Scanned PDFs
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 25px">
              Optical Character Recognition (OCR) is a crucial technology for
              converting scanned PDFs or image-based documents to PowerPoint.
              When you upload a scanned PDF, our OCR engine analyzes the images,
              identifies text characters, and converts them into editable text.
              This process supports multiple languages including English, Hindi,
              Bengali, Spanish, French, German, Italian, Portuguese, Russian,
              Japanese, Korean, Chinese (Simplified and Traditional), Arabic,
              Thai, and Vietnamese. You can select multiple languages if your
              document contains text in different scripts, ensuring accurate
              recognition across all content.
            </p>

            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              Tips for Best Conversion Results
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 15px">
              To achieve the best results when converting your PDFs to
              PowerPoint, consider these helpful tips:
            </p>
            <ul
              style="
                color: #555;
                line-height: 1.8;
                margin-bottom: 25px;
                padding-left: 25px;
              "
            >
              <li style="margin-bottom: 10px">
                Use high-quality PDF files for better conversion accuracy,
                especially for scanned documents
              </li>
              <li style="margin-bottom: 10px">
                Select all relevant OCR languages before conversion if your
                document is multilingual
              </li>
              <li style="margin-bottom: 10px">
                For best results with scanned PDFs, ensure the original scan was
                done at 300 DPI or higher
              </li>
              <li style="margin-bottom: 10px">
                Review the converted PowerPoint file and make manual adjustments
                to formatting if needed
              </li>
              <li style="margin-bottom: 10px">
                If your PDF has complex layouts, you may need to reorganize some
                content in PowerPoint after conversion
              </li>
              <li style="margin-bottom: 10px">
                Keep backup copies of your original PDF files before conversion
              </li>
            </ul>

            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              Security and Privacy Considerations
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 25px">
              When converting PDFs online, security is paramount, especially
              with sensitive business or personal documents. Our tool
              prioritizes your privacy by using encrypted connections for all
              file transfers. Files are processed securely and automatically
              deleted from our servers immediately after conversion is complete.
              We never access, store, or share the content of your documents.
              However, if you're working with highly confidential information,
              consider using the tool on a secure, private network. All
              conversions are performed with enterprise-grade security measures
              to protect your data.
            </p>

            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              Troubleshooting Common Conversion Issues
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 15px">
              If you encounter problems while converting PDFs to PowerPoint,
              here are solutions to common issues:
            </p>
            <ul
              style="
                color: #555;
                line-height: 1.8;
                margin-bottom: 25px;
                padding-left: 25px;
              "
            >
              <li style="margin-bottom: 10px">
                <strong>File won't upload:</strong> Ensure your PDF isn't
                password-protected. Remove password protection first before
                conversion.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Conversion is slow:</strong> Large files or scanned PDFs
                with many pages may take longer to process. Please be patient.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Text not recognized:</strong> For scanned PDFs, ensure
                you've selected the correct OCR languages that match your
                document.
              </li>
              <li style="margin-bottom: 10px">
                <strong>Formatting issues:</strong> Complex PDF layouts may
                require manual adjustments in PowerPoint after conversion.
              </li>
              <li style="margin-bottom: 10px">
                <strong>File size too large:</strong> If your PDF exceeds size
                limits, try compressing it first or splitting it into smaller
                sections.
              </li>
            </ul>

            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              Editing Your Converted PowerPoint Presentation
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 25px">
              After converting your PDF to PowerPoint, you have full editing
              capabilities. You can modify text content, change fonts and
              colors, rearrange slides, add or remove images, insert animations
              and transitions, and customize the design to match your branding.
              The converted PPTX file is compatible with Microsoft PowerPoint,
              Google Slides, LibreOffice Impress, and other presentation
              software. This flexibility allows you to enhance and personalize
              your presentation beyond what was possible in the original PDF
              format. You can also export the edited presentation back to PDF if
              needed.
            </p>
          </div>
        </div>
      </section>

      <!-- FAQ Section -->
      <section class="features" style="background: #f9fafb">
        <div class="container">
          <h2>Frequently Asked Questions About PDF to PowerPoint Conversion</h2>
          <div style="max-width: 800px; margin: 0 auto; text-align: left">
            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Is it really free to convert PDF to PowerPoint on this website?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Yes, absolutely! Our PDF to PowerPoint converter is completely
                free with no hidden charges, subscriptions, or premium features.
                You can convert unlimited files as many times as you need
                without any cost.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Will the converted PowerPoint file maintain the original
                formatting?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Our converter strives to maintain as much of the original
                formatting as possible, including fonts, colors, images, and
                layout. However, some complex PDF layouts may require minor
                adjustments after conversion.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Can I convert scanned PDFs to PowerPoint?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Yes! Our tool includes OCR technology that can recognize text in
                scanned PDFs and convert them to editable PowerPoint
                presentations. Select the appropriate languages for best
                results.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Is it safe to convert confidential documents online?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Yes, your privacy is protected. We use secure encrypted
                connections and automatically delete all files immediately after
                processing. Your documents are never stored or accessed by
                anyone.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                What languages does the OCR support?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Our OCR technology supports 14+ languages including English,
                Hindi, Bengali, Spanish, French, German, Italian, Portuguese,
                Russian, Japanese, Korean, Chinese (Simplified and Traditional),
                Arabic, Thai, and Vietnamese.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Can I edit the PowerPoint file after conversion?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Yes! The converted file is a fully editable PPTX format that can
                be opened and modified in Microsoft PowerPoint, Google Slides,
                or any compatible presentation software.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Can I convert PDF to PowerPoint on mobile devices?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Yes! Our converter works perfectly on all devices including
                smartphones and tablets running iOS or Android. The interface is
                fully responsive and mobile-friendly.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                What's the maximum file size I can convert?
              </h3>
              <p style="color: #555; line-height: 1.8">
                You can convert PDF files up to 50MB in size. For best
                performance, we recommend files under 20MB. Larger files may
                take longer to process.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Do I need to install any software?
              </h3>
              <p style="color: #555; line-height: 1.8">
                No installation required! Our tool works entirely in your web
                browser. Just visit the page, upload your PDF, and convert
                instantly without downloading or installing anything.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                How long does the conversion process take?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Most conversions complete in 10-30 seconds depending on file
                size and complexity. Scanned PDFs with OCR processing may take
                slightly longer.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Can I convert password-protected PDFs?
              </h3>
              <p style="color: #555; line-height: 1.8">
                No, password-protected PDFs cannot be converted directly. You'll
                need to remove the password protection first before conversion.
              </p>
            </div>

            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Will images in my PDF be included in the PowerPoint?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Yes, all images from your PDF will be included in the converted
                PowerPoint presentation, maintaining their quality and
                positioning as much as possible.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- AdSense Ad Placeholder (Bottom) -->
      <section
        class="ad-section"
        style="
          margin: 40px 0;
          text-align: center;
          background: white;
          padding: 40px 20px;
        "
      >
        <div class="container">
          <script
            async
            src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5797619165090350"
            crossorigin="anonymous"
          ></script>
          <!-- PDF to PPT ads 3 -->
          <ins
            class="adsbygoogle"
            style="display: block"
            data-ad-client="ca-pub-5797619165090350"
            data-ad-slot="7553156845"
            data-ad-format="auto"
            data-full-width-responsive="true"
          ></ins>
          <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
        </div>
      </section>

      <!-- Related Tools Section -->
      <section class="benefits" style="background: #f9fafb">
        <div class="container">
          <h2>Related PDF Tools You Might Need</h2>
          <div class="feature-grid">
            <div class="feature-card">
              <i
                class="fas fa-file-pdf"
                style="font-size: 40px; color: #4f46e5; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Merge PDF</h3>
              <p>
                Combine multiple PDF files into a single document quickly and
                easily.
              </p>
              <a
                href="/merge"
                class="cta-button"
                style="font-size: 14px; padding: 8px 16px; margin-top: 10px"
                >Merge PDF</a
              >
            </div>
            <div class="feature-card">
              <i
                class="fas fa-compress"
                style="font-size: 40px; color: #4f46e5; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Compress PDF</h3>
              <p>
                Reduce PDF file size to make it easier to email or upload
                online.
              </p>
              <a
                href="/compress-pdf"
                class="cta-button"
                style="font-size: 14px; padding: 8px 16px; margin-top: 10px"
                >Compress PDF</a
              >
            </div>
            <div class="feature-card">
              <i
                class="fas fa-file-word"
                style="font-size: 40px; color: #4f46e5; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>PDF to Word</h3>
              <p>
                Convert PDF documents to editable Word format while maintaining
                formatting.
              </p>
              <a
                href="/pdf-to-word"
                class="cta-button"
                style="font-size: 14px; padding: 8px 16px; margin-top: 10px"
                >PDF to Word</a
              >
            </div>
          </div>
        </div>
      </section>

      <!-- CTA Section -->
      <section
        class="hero"
        style="
          padding: 60px 20px;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        "
      >
        <div class="container">
          <h2 style="font-size: 32px; margin-bottom: 15px; color: white">
            Ready to Convert Your PDF to PowerPoint?
          </h2>
          <p style="margin-bottom: 25px; color: white">
            Start transforming your PDF documents into editable presentations
            now. Fast, secure, and completely free. No registration needed.
          </p>
          <a
            href="#main-content"
            class="cta-button"
            style="background: white; color: #667eea"
          >
            <i class="fas fa-arrow-up" aria-hidden="true"></i> Convert PDF Now
          </a>
        </div>
      </section>
    </main>

    <!-- OCR Choice Dialog (Hidden by default) -->
    <div
      id="ocrChoiceDialog"
      class="ocr-dialog"
      role="dialog"
      aria-labelledby="ocrDialogTitle"
      aria-modal="true"
    >
      <div class="ocr-dialog-content">
        <h3 id="ocrDialogTitle">
          <i
            class="fa fa-search"
            aria-hidden="true"
            style="margin-right: 10px; color: #667eea"
          ></i>
          OCR Detection Required
        </h3>
        <p>Your PDF appears to be image-based (scanned document or images).</p>
        <p class="dialog-subtitle">Choose how to process:</p>
        <div class="ocr-dialog-options">
          <!-- <button id="ocrOption" class="cta-button" aria-label="Process with OCR">
            <i class="fa fa-magic" aria-hidden="true" style="font-size: 24px; margin-bottom: 8px;"></i>
            <span class="option-title">OCR Processing</span>
            <span class="option-desc">Extract text from images - text will be editable and searchable in PowerPoint (slower but better)</span>
          </button> -->
          <button
            id="imageOption"
            class="secondary-btn"
            aria-label="Convert as images only"
          >
            <i
              class="fa fa-image"
              aria-hidden="true"
              style="font-size: 24px; margin-bottom: 8px"
            ></i>
            <span class="option-title">Image-Only</span>
            <span class="option-desc"
              >Convert as images without OCR - faster but text won't be
              selectable</span
            >
          </button>
        </div>
        <button
          id="cancelOption"
          class="text-btn"
          aria-label="Cancel conversion"
        >
          <i class="fa fa-times" aria-hidden="true"></i>
        </button>
      </div>
    </div>

    <!-- Processing Dialog (Hidden by default) -->
    <div
      id="processingDialog"
      class="processing-dialog"
      role="dialog"
      aria-labelledby="processingTitle"
      aria-modal="true"
    >
      <div class="processing-dialog-content">
        <div class="spinner" aria-hidden="true"></div>
        <h3
          id="processingTitle"
          style="color: #1f2937; margin-bottom: 10px; font-size: 22px"
        >
          Converting PDF to PowerPoint
        </h3>
        <p style="color: #6b7280; margin-bottom: 15px; font-size: 15px">
          Processing your file...
        </p>
        <p style="color: #9ca3af; font-size: 13px">
          This may take a moment. Please don't close this page.
        </p>
      </div>
    </div>

    <!-- Footer -->
    <section id="footer-placeholder"></section>

    <!-- JS -->
    <script src="./js/app.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
      const BACKEND_URL = `http://127.0.0.1:8080/pdf-to-ppt`;
      const CHECK_TEXT_URL = `http://127.0.0.1:8080/check-pdf-text`;
      const MAX_FILE_SIZE = 50 * 1024 * 1024;

      const pdfInput = document.getElementById("pdfUpload");
      const fileList = document.getElementById("fileList");
      const convertBtn = document.getElementById("convertBtn");
      const errorMsg = document.getElementById("errorMsg");
      const resultBtns = document.getElementById("resultBtns");
      const downloadBtn = document.getElementById("downloadBtn");
      const shareBtn = document.getElementById("shareBtn");
      const resetBtn = document.getElementById("resetBtn");
      const fileNameLink = document.getElementById("fileNameLink");
      const uploadSection = document.getElementById("uploadSection");

      // Dialog elements
      const ocrDialog = document.getElementById("ocrChoiceDialog");
      const ocrOptionBtn = document.getElementById("ocrOption");
      const imageOptionBtn = document.getElementById("imageOption");
      const cancelOptionBtn = document.getElementById("cancelOption");
      const processingDialog = document.getElementById("processingDialog");

      // ============================================================================
      // STATE
      // ============================================================================

      let selectedFile = null;
      let convertedFileUrl = null;
      let convertedFileName = "presentation.pptx";
      let isConverting = false;

      // ============================================================================
      // LANGUAGE SELECTION
      // ============================================================================

      const languages = [
        ["eng", "English"],
        ["hin", "Hindi"],
        ["ben", "Bengali"],
        ["spa", "Spanish"],
        ["fra", "French"],
        ["deu", "German"],
        ["ita", "Italian"],
        ["por", "Portuguese"],
        ["rus", "Russian"],
        ["jpn", "Japanese"],
        ["kor", "Korean"],
        ["chi_sim", "Chinese Simplified"],
        ["chi_tra", "Chinese Traditional"],
        ["ara", "Arabic"],
        ["tha", "Thai"],
        ["vie", "Vietnamese"],
      ];

      let selectedLangs = ["eng"];

      const selectBox = document.getElementById("selectBox");
      const dropdown = document.getElementById("dropdown");
      const optionsDiv = document.getElementById("options");
      const searchInput = document.getElementById("searchLang");

      function renderOptions(filter = "") {
        optionsDiv.innerHTML = "";
        const filteredLangs = languages.filter((l) =>
          l[1].toLowerCase().includes(filter.toLowerCase()),
        );

        if (filteredLangs.length === 0) {
          optionsDiv.innerHTML =
            '<div style="padding: 20px; text-align: center; color: #9ca3af;">No languages found</div>';
          return;
        }

        filteredLangs.forEach((l) => {
          const div = document.createElement("div");
          div.className =
            "option" + (selectedLangs.includes(l[0]) ? " selected" : "");
          div.textContent = l[1];
          div.setAttribute("role", "option");
          div.setAttribute(
            "aria-selected",
            selectedLangs.includes(l[0]) ? "true" : "false",
          );
          div.onclick = () => toggleLang(l);
          optionsDiv.appendChild(div);
        });
      }

      function toggleLang(l) {
        hideError();
        if (selectedLangs.includes(l[0])) {
          selectedLangs = selectedLangs.filter((x) => x !== l[0]);
        } else {
          selectedLangs.push(l[0]);
        }
        updateTags();
        renderOptions(searchInput.value);
      }

      function updateTags() {
        selectBox.innerHTML = "";
        if (selectedLangs.length === 0) {
          selectBox.innerHTML =
            '<span class="select-placeholder">Select languages...</span>';
          return;
        }
        selectedLangs.forEach((code) => {
          const name = languages.find((l) => l[0] === code)[1];
          const tag = document.createElement("span");
          tag.className = "tag";
          tag.innerHTML = `${name} <span class="remove-tag" data-code="${code}" role="button" aria-label="Remove ${name}" tabindex="0"></span>`;
          selectBox.appendChild(tag);
        });

        selectBox.querySelectorAll(".remove-tag").forEach((btn) => {
          btn.onclick = (e) => {
            e.stopPropagation();
            const code = e.target.dataset.code;
            selectedLangs = selectedLangs.filter((x) => x !== code);
            updateTags();
            renderOptions(searchInput.value);
          };

          btn.onkeypress = (e) => {
            if (e.key === "Enter" || e.key === " ") {
              e.preventDefault();
              e.stopPropagation();
              const code = e.target.dataset.code;
              selectedLangs = selectedLangs.filter((x) => x !== code);
              updateTags();
              renderOptions(searchInput.value);
            }
          };
        });
      }

      selectBox.onclick = (e) => {
        if (e.target.classList.contains("remove-tag")) return;

        const isOpen = dropdown.classList.contains("show");
        dropdown.classList.toggle("show");
        selectBox.classList.toggle("open");
        selectBox.setAttribute("aria-expanded", !isOpen);

        if (!isOpen) {
          searchInput.focus();
          searchInput.value = "";
          renderOptions();
        }
      };

      searchInput.oninput = (e) => renderOptions(e.target.value);

      document.addEventListener("click", (e) => {
        if (!selectBox.contains(e.target) && !dropdown.contains(e.target)) {
          dropdown.classList.remove("show");
          selectBox.classList.remove("open");
          selectBox.setAttribute("aria-expanded", "false");
        }
      });

      selectBox.addEventListener("keypress", (e) => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          selectBox.click();
        }
      });

      renderOptions();
      updateTags();

      // ============================================================================
      // UTILITY FUNCTIONS
      // ============================================================================

      function hideError() {
        errorMsg.style.display = "none";
        errorMsg.textContent = "";
      }

      function showError(message) {
        errorMsg.textContent = message;
        errorMsg.style.display = "block";

        setTimeout(() => {
          if (errorMsg.textContent === message) {
            errorMsg.style.display = "none";
          }
        }, 7000);
      }

      function showSuccess(message) {
        let successMsg = document.getElementById("successMsg");
        if (!successMsg) {
          successMsg = document.createElement("div");
          successMsg.id = "successMsg";
          successMsg.className = "success-message";
          successMsg.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        color: white;
        padding: 15px 25px;
        border-radius: 10px;
        box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3);
        z-index: 10000;
        animation: slideInRight 0.3s ease;
        font-weight: 500;
      `;
          document.body.appendChild(successMsg);
        }

        successMsg.innerHTML = `<i class="fa fa-check-circle" aria-hidden="true" style="margin-right: 8px;"></i>${message}`;
        successMsg.style.display = "block";

        setTimeout(() => {
          successMsg.style.display = "none";
        }, 4000);
      }

      // ============================================================================
      // DIALOG FUNCTIONS
      // ============================================================================

      function showOCRChoiceDialog() {
        return new Promise((resolve) => {
          ocrDialog.classList.add("show");

          ocrOptionBtn.onclick = () => {
            ocrDialog.classList.remove("show");
            resolve("ocr");
          };

          imageOptionBtn.onclick = () => {
            ocrDialog.classList.remove("show");
            resolve("image");
          };

          cancelOptionBtn.onclick = () => {
            ocrDialog.classList.remove("show");
            resolve("cancel");
          };

          const escHandler = (e) => {
            if (e.key === "Escape") {
              ocrDialog.classList.remove("show");
              document.removeEventListener("keydown", escHandler);
              resolve("cancel");
            }
          };
          document.addEventListener("keydown", escHandler);
        });
      }

      function showProcessingDialog() {
        processingDialog.classList.add("show");
      }

      function hideProcessingDialog() {
        processingDialog.classList.remove("show");
      }

      // ============================================================================
      // FILE HANDLING
      // ============================================================================

      function renderFileList() {
        if (!selectedFile) {
          fileList.style.display = "none";
          return;
        }
        fileList.style.display = "block";
        fileList.innerHTML = "";

        const li = document.createElement("li");
        const fileSizeMB = (selectedFile.size / (1024 * 1024)).toFixed(2);
        li.innerHTML = `
      <div class="file-info">
        <i class="fa fa-file-pdf pdf-icon" aria-hidden="true"></i>
        <span class="file-name-text">${selectedFile.name}</span>
        <span style="color: #6b7280; font-size: 13px; margin-left: 8px;">(${fileSizeMB} MB)</span>
      </div>
      <button class="delete-file" onclick="removeFile()" aria-label="Remove ${selectedFile.name}">
        <i class="fa fa-times" aria-hidden="true"></i>
      </button>
    `;
        fileList.appendChild(li);
      }

      pdfInput.addEventListener("change", (e) => {
        hideError();

        if (pdfInput.files && pdfInput.files.length > 0) {
          const file = pdfInput.files[0];

          if (
            file.type !== "application/pdf" &&
            !file.name.toLowerCase().endsWith(".pdf")
          ) {
            showError("Please select a valid PDF file");
            pdfInput.value = "";
            selectedFile = null;
            renderFileList();
            return;
          }

          if (file.size > MAX_FILE_SIZE) {
            showError(
              `File size exceeds ${(MAX_FILE_SIZE / (1024 * 1024)).toFixed(0)}MB limit`,
            );
            pdfInput.value = "";
            selectedFile = null;
            renderFileList();
            return;
          }

          if (file.size === 0) {
            showError("Selected file is empty. Please choose a valid PDF.");
            pdfInput.value = "";
            selectedFile = null;
            renderFileList();
            return;
          }

          selectedFile = file;
          renderFileList();
          showSuccess(`File "${file.name}" selected successfully!`);
        } else {
          selectedFile = null;
          renderFileList();
        }
      });

      window.removeFile = function () {
        selectedFile = null;
        pdfInput.value = "";
        renderFileList();
        hideError();
      };

      async function checkPDFHasText(file) {
        const formData = new FormData();
        formData.append("file", file);

        try {
          const response = await fetch(CHECK_TEXT_URL, {
            method: "POST",
            body: formData,
          });

          if (!response.ok) {
            const errorData = await response.json().catch(() => ({}));
            throw new Error(errorData.error || "Failed to check PDF text");
          }

          const result = await response.json();
          return result.hasText;
        } catch (error) {
          return false;
        }
      }

      convertBtn.addEventListener("click", async () => {
        if (isConverting) {
          showError("Conversion already in progress. Please wait.");
          return;
        }

        if (!selectedFile) {
          showError("Please upload a PDF file");
          return;
        }

        if (selectedLangs.length === 0) {
          showError("Please select at least one language for OCR");
          return;
        }

        hideError();
        isConverting = true;
        convertBtn.classList.add("btn-loading");
        convertBtn.disabled = true;

        try {
          const hasText = await checkPDFHasText(selectedFile);

          let conversionMode = "auto";
          let finalHasText = hasText;

          if (hasText) {
            conversionMode = "auto";
            finalHasText = true;
          } else {
            const choice = await showOCRChoiceDialog();

            if (choice === "cancel") {
              isConverting = false;
              convertBtn.classList.remove("btn-loading");
              convertBtn.disabled = false;
              return;
            }

            conversionMode = choice;
            finalHasText = false;
          }

          showProcessingDialog();

          const formData = new FormData();
          formData.append("file", selectedFile);
          formData.append("lang", selectedLangs.join("+"));
          formData.append("mode", conversionMode);
          formData.append("has_text", finalHasText.toString());

          const res = await fetch(BACKEND_URL, {
            method: "POST",
            body: formData,
          });

          if (!res.ok) {
            const errorData = await res.json().catch(() => ({}));
            throw new Error(
              errorData.error || `Conversion failed (Status: ${res.status})`,
            );
          }

          const blob = await res.blob();

          if (blob.size === 0) {
            throw new Error("Received empty file from server");
          }

          const url = URL.createObjectURL(blob);
          convertedFileUrl = url;

          const baseName = selectedFile.name.replace(/\.pdf$/i, "");
          const filename = `${baseName}.pptx`;
          convertedFileName = filename;

          fileList.style.display = "none";
          convertBtn.style.display = "none";
          uploadSection.style.display = "none";
          document.querySelector(".note").style.display = "none";
          document.querySelector(".multi-select").style.display = "none";
          document.querySelector(".select-label").style.display = "none";
          resultBtns.style.display = "block";

          downloadBtn.href = url;
          downloadBtn.download = filename;
          fileNameLink.textContent = filename;
          fileNameLink.onclick = (e) => {
            e.preventDefault();
            window.open(url, "_blank");
          };

          if (!hasText && conversionMode === "ocr") {
            showSuccess(
              "Image-based PDF processed with OCR! Text is now editable.",
            );
          } else if (!hasText && conversionMode === "image") {
            showSuccess("Image-based PDF converted as images successfully!");
          } else {
            showSuccess("Text-based PDF converted successfully!");
          }
        } catch (err) {
          showError(err.message || "Conversion failed. Please try again.");
        } finally {
          hideProcessingDialog();
          isConverting = false;
          convertBtn.classList.remove("btn-loading");
          convertBtn.disabled = false;
        }
      });

      shareBtn.addEventListener("click", async () => {
        if (!convertedFileUrl) return;

        try {
          if (navigator.share && navigator.canShare) {
            const response = await fetch(convertedFileUrl);
            const blob = await response.blob();
            const file = new File([blob], convertedFileName, {
              type: "application/vnd.openxmlformats-officedocument.presentationml.presentation",
            });

            const shareData = {
              title: "PowerPoint Presentation",
              text: "Check out this PowerPoint presentation",
              files: [file],
            };

            if (navigator.canShare(shareData)) {
              await navigator.share(shareData);
              showSuccess("File shared successfully!");
            } else {
              await navigator.share({
                title: "PowerPoint Presentation",
                text: `I converted a PDF to PowerPoint`,
                url: window.location.href,
              });
            }
          } else {
            const tempInput = document.createElement("input");
            tempInput.value = window.location.href;
            document.body.appendChild(tempInput);
            tempInput.select();
            document.execCommand("copy");
            document.body.removeChild(tempInput);

            const originalText = shareBtn.innerHTML;
            shareBtn.innerHTML =
              '<i class="fa fa-check" aria-hidden="true"></i> Link Copied!';
            shareBtn.disabled = true;
            setTimeout(() => {
              shareBtn.innerHTML = originalText;
              shareBtn.disabled = false;
            }, 2000);

            showSuccess("Download link copied to clipboard!");
          }
        } catch (error) {
          if (error.name !== "AbortError") {
            showError("Sharing failed. You can still download the file.");
          }
        }
      });

      // ============================================================================
      // RESET FUNCTIONALITY
      // ============================================================================

      resetBtn.addEventListener("click", () => {
        if (convertedFileUrl) {
          URL.revokeObjectURL(convertedFileUrl);
        }

        selectedFile = null;
        selectedLangs = ["eng"];
        convertedFileUrl = null;
        convertedFileName = "presentation.pptx";
        isConverting = false;
        pdfInput.value = "";
        fileList.innerHTML = "";
        fileList.style.display = "none";
        uploadSection.style.display = "block";
        convertBtn.style.display = "inline-flex";
        convertBtn.classList.remove("btn-loading");
        convertBtn.disabled = false;
        resultBtns.style.display = "none";
        document.querySelector(".note").style.display = "block";
        document.querySelector(".multi-select").style.display = "block";
        document.querySelector(".select-label").style.display = "block";
        hideError();
        updateTags();
        renderOptions();
        window.scrollTo({ top: 0, behavior: "smooth" });
      });

      // ============================================================================
      // DRAG AND DROP
      // ============================================================================

      const uploadLabel = document.querySelector(".upload-label");

      ["dragenter", "dragover", "dragleave", "drop"].forEach((eventName) => {
        uploadLabel.addEventListener(
          eventName,
          (e) => {
            e.preventDefault();
            e.stopPropagation();
          },
          false,
        );
      });

      ["dragenter", "dragover"].forEach((eventName) => {
        uploadLabel.addEventListener(
          eventName,
          () => {
            uploadLabel.classList.add("drag-over");
            uploadLabel.style.transform = "scale(1.02)";
            uploadLabel.style.borderColor = "#4f46e5";
            uploadLabel.style.backgroundColor = "#f5f3ff";
          },
          false,
        );
      });

      ["dragleave", "drop"].forEach((eventName) => {
        uploadLabel.addEventListener(
          eventName,
          () => {
            uploadLabel.classList.remove("drag-over");
            uploadLabel.style.transform = "scale(1)";
            uploadLabel.style.borderColor = "";
            uploadLabel.style.backgroundColor = "";
          },
          false,
        );
      });

      uploadLabel.addEventListener("drop", (e) => {
        const dt = e.dataTransfer;
        const files = dt.files;

        if (files.length > 0) {
          const file = files[0];
          if (file.type === "application/pdf") {
            if (file.size > MAX_FILE_SIZE) {
              showError(
                `File size exceeds ${MAX_FILE_SIZE / (1024 * 1024)}MB limit`,
              );
              return;
            }
            selectedFile = file;
            const dataTransfer = new DataTransfer();
            dataTransfer.items.add(file);
            pdfInput.files = dataTransfer.files;
            renderFileList();
            showSuccess(`File "${file.name}" selected successfully!`);
          } else {
            showError("Please drop a PDF file");
          }
        }
      });

      // ============================================================================
      // KEYBOARD SHORTCUTS
      // ============================================================================

      document
        .querySelector(".upload-label")
        .addEventListener("keypress", (e) => {
          if (e.key === "Enter" || e.key === " ") {
            e.preventDefault();
            pdfInput.click();
          }
        });

      document.addEventListener("keydown", (e) => {
        if ((e.ctrlKey || e.metaKey) && e.key === "Enter") {
          if (
            selectedFile &&
            !isConverting &&
            convertBtn.style.display !== "none"
          ) {
            convertBtn.click();
          }
        }
      });

      // ============================================================================
      // CLEANUP
      // ============================================================================

      window.addEventListener("beforeunload", () => {
        if (convertedFileUrl) {
          URL.revokeObjectURL(convertedFileUrl);
        }
      });
    </script>
  </body>
</html>
