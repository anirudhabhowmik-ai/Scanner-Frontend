<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>
      PDF to PowerPoint Converter Online Free - Convert PDF to PPTX | NextoPDF
    </title>
    <meta
      name="title"
      content="PDF to PowerPoint Converter Online Free - Convert PDF to PPTX | NextoPDF"
    />
    <meta
      name="description"
      content="Convert PDF to PowerPoint (PPTX) with automatic OCR detection. Transform scanned PDFs into editable presentations. Supports 14+ languages. Free and secure."
    />
    <meta
      name="keywords"
      content="PDF to PowerPoint, PDF to PPTX, convert PDF to PPT, PDF converter, online PDF to PowerPoint, free PDF to PPTX converter, PDF to slides, OCR PowerPoint"
    />
    <meta name="author" content="NextoPDF" />
    <meta
      name="robots"
      content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"
    />
    <link rel="canonical" href="https://nextopdf.com/pdf-to-ppt" />

    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://nextopdf.com/pdf-to-ppt" />
    <meta
      property="og:title"
      content="PDF to PowerPoint Converter Online Free - Convert PDF to PPTX | NextoPDF"
    />
    <meta
      property="og:description"
      content="Convert PDF to PowerPoint presentations online for free. Transform your PDF documents into editable PPTX slides with OCR support."
    />
    <meta
      property="og:image"
      content="https://nextopdf.com/images/pdf-to-ppt-og.png"
    />
    <meta property="og:site_name" content="NextoPDF" />
    <meta property="og:locale" content="en_US" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="https://nextopdf.com/pdf-to-ppt" />
    <meta
      name="twitter:title"
      content="PDF to PowerPoint Converter Online Free - Convert PDF to PPTX | NextoPDF"
    />
    <meta
      name="twitter:description"
      content="Convert PDF to PowerPoint presentations online for free. Transform your PDF documents into editable PPTX slides."
    />
    <meta
      name="twitter:image"
      content="https://nextopdf.com/images/pdf-to-ppt-twitter.png"
    />
    <meta name="google-adsense-account" content="ca-pub-5797619165090350" />

    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "NextoPDF - PDF to PowerPoint Converter",
        "url": "https://nextopdf.com/pdf-to-ppt",
        "description": "Free online tool to convert PDF files to PowerPoint presentations with Google AI OCR support",
        "applicationCategory": "UtilitiesApplication",
        "operatingSystem": "Any",
        "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" },
        "featureList": [
          "Convert PDF to PPTX format",
          "Google AI OCR support for scanned PDFs",
          "Exact text positioning from selectable PDFs",
          "Maintain formatting and layout",
          "Secure and private processing",
          "No registration required"
        ]
      }
    </script>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&family=Inter:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="./css/style.css" />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="./images/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="./images/favicon-16x16.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="./images/apple-touch-icon.png"
    />

    <style>
      .skip-to-main {
        position: absolute;
        top: -40px;
        left: 0;
        background: #4f46e5;
        color: white;
        padding: 8px 16px;
        text-decoration: none;
        z-index: 100;
        border-radius: 0 0 4px 0;
        font-weight: 500;
      }
      .skip-to-main:focus {
        top: 0;
      }
      button:focus,
      a:focus,
      input:focus {
        outline: 2px solid #4f46e5;
        outline-offset: 2px;
      }
      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border-width: 0;
      }

      /* ── Multi-select dropdown ── */
      .multi-select {
        position: relative;
        width: 100%;
        margin-top: 10px;
        margin-bottom: 20px;
      }
      .select-label {
        font-weight: 600;
        font-size: 16px;
        color: #1f2937;
        margin-bottom: 8px;
        display: block;
      }
      .select-box {
        border: 2px solid #e5e7eb;
        border-radius: 10px;
        padding: 12px 14px;
        background: #fff;
        cursor: pointer;
        min-height: 48px;
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        align-items: center;
        transition: all 0.2s ease;
        position: relative;
      }
      .select-box:hover {
        border-color: #4f46e5;
        box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.05);
      }
      .select-box.open {
        border-color: #4f46e5;
        box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.1);
        background: #fafafa;
      }
      .select-box::after {
        content: "\f078";
        font-family: "Font Awesome 6 Free";
        font-weight: 900;
        position: absolute;
        right: 14px;
        top: 50%;
        transform: translateY(-50%);
        color: #6b7280;
        transition: transform 0.2s ease;
        pointer-events: none;
      }
      .select-box.open::after {
        transform: translateY(-50%) rotate(180deg);
      }
      .select-placeholder {
        color: #9ca3af;
        font-size: 14px;
        user-select: none;
      }
      .tag {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: #fff;
        padding: 6px 12px;
        border-radius: 8px;
        font-size: 13px;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        font-weight: 500;
        box-shadow: 0 2px 4px rgba(102, 126, 234, 0.2);
        transition: all 0.2s ease;
      }
      .tag:hover {
        box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
        transform: translateY(-1px);
      }
      .tag .remove-tag {
        cursor: pointer;
        font-size: 16px;
        opacity: 0.9;
        transition: opacity 0.2s;
        width: 18px;
        height: 18px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.2);
      }
      .tag .remove-tag:hover {
        opacity: 1;
        background: rgba(255, 255, 255, 0.3);
      }
      #dropdown {
        display: none;
        position: absolute;
        width: 100%;
        background: white;
        border: 2px solid #4f46e5;
        border-radius: 10px;
        max-height: 320px;
        overflow: hidden;
        z-index: 1000;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        margin-top: 6px;
        animation: dropdownSlide 0.2s ease;
      }
      @keyframes dropdownSlide {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      #dropdown.show {
        display: flex;
        flex-direction: column;
      }
      #dropdown input {
        width: calc(100% - 60px);
        margin: 12px 14px;
        padding: 10px 14px;
        border: 2px solid #e5e7eb;
        border-radius: 8px;
        font-size: 14px;
        transition: all 0.2s ease;
        flex-shrink: 0;
      }
      #dropdown input:focus {
        outline: none;
        border-color: #4f46e5;
        box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
      }
      #options {
        overflow-y: auto;
        max-height: 240px;
      }
      .option {
        padding: 12px 16px;
        cursor: pointer;
        transition: all 0.15s ease;
        font-size: 14px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        position: relative;
      }
      .option:hover {
        background: #f3f4f6;
      }
      .option.selected {
        background: #ede9fe;
        color: #6d28d9;
        font-weight: 500;
      }
      .option.selected::after {
        content: "\f00c";
        font-family: "Font Awesome 6 Free";
        font-weight: 900;
        color: #6d28d9;
        font-size: 12px;
      }
      #options::-webkit-scrollbar {
        width: 8px;
      }
      #options::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 10px;
      }
      #options::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 10px;
      }
      #options::-webkit-scrollbar-thumb:hover {
        background: #94a3b8;
      }

      /* ── File list ── */
      .file-list {
        list-style: none;
        padding: 0;
        margin: 20px 0;
      }
      .file-list li {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 14px 18px;
        background: #f9fafb;
        border-radius: 10px;
        margin-bottom: 10px;
        border: 2px solid #e5e7eb;
        transition: all 0.2s ease;
      }
      .file-list li:hover {
        border-color: #d1d5db;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      }
      .file-list li .pdf-icon {
        color: #ef4444;
        margin-right: 12px;
        font-size: 20px;
      }
      .file-info {
        display: flex;
        align-items: center;
        flex: 1;
      }
      .file-name-text {
        font-weight: 500;
        color: #1f2937;
      }
      .delete-file {
        background: #ef4444;
        border: none;
        color: white;
        border-radius: 50%;
        width: 32px;
        height: 32px;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        flex-shrink: 0;
      }
      .delete-file i {
        color: #fff;
      }
      .delete-file:hover,
      .delete-file:focus {
        background: #dc2626;
        transform: scale(1.1);
      }

      /* ── Button states ── */
      .btn-loading {
        pointer-events: none;
        opacity: 0.7;
      }
      .btn-loading .btn-text {
        display: none;
      }
      .btn-spinner {
        display: none;
      }
      .btn-loading .btn-spinner {
        display: inline-block;
      }

      /* ── Error / Note ── */
      .error-text {
        color: #dc2626;
        font-size: 14px;
        margin-top: 12px;
        padding: 12px 16px;
        background: #fee2e2;
        border-left: 4px solid #dc2626;
        border-radius: 8px;
        display: none;
        animation: slideIn 0.3s ease;
      }
      .error-text::before {
        content: "\f06a";
        font-family: "Font Awesome 6 Free";
        font-weight: 900;
        margin-right: 8px;
      }
      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .note {
        background: #eff6ff;
        border-left: 4px solid #3b82f6;
        padding: 14px 18px;
        border-radius: 8px;
        font-size: 14px;
        color: #1e40af;
        margin-top: 20px;
        line-height: 1.6;
      }
      .note i {
        margin-right: 8px;
      }

      /* ── Result buttons ── */
      .result-btns-container {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        justify-content: center;
      }
      .subtitle {
        font-size: 18px;
        color: #555;
        margin-bottom: 30px;
        line-height: 1.6;
      }
      .ad-section {
        min-height: 100px;
      }

      /* ── OCR Choice Dialog ── */
      .ocr-dialog {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 99999;
        animation: fadeIn 0.3s ease;
        backdrop-filter: blur(5px);
      }
      .ocr-dialog.show {
        display: flex;
      }
      .ocr-dialog-content {
        background: white;
        position: relative;
        border-radius: 24px;
        padding: 35px;
        max-width: 500px;
        width: 90%;
        box-shadow: 0 25px 60px rgba(0, 0, 0, 0.3);
        animation: slideUp 0.3s ease;
      }
      .ocr-dialog-content h3 {
        color: #1f2937;
        margin-bottom: 15px;
        font-size: 24px;
        display: flex;
        align-items: center;
      }
      .ocr-dialog-content p {
        color: #4b5563;
        margin-bottom: 10px;
        line-height: 1.6;
        font-size: 16px;
      }
      .dialog-subtitle {
        font-weight: 600;
        color: #374151;
        margin-top: 20px;
        margin-bottom: 15px;
      }
      .ocr-dialog-options {
        display: flex;
        flex-direction: column;
        gap: 15px;
        margin: 20px 0;
      }
      .ocr-dialog-options button {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 25px 20px;
        border-radius: 16px;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 2px solid transparent;
        width: 100%;
        text-align: center;
      }
      .option-title {
        font-size: 18px;
        font-weight: 700;
        margin: 8px 0 5px;
      }
      .ocr-dialog-options button .option-desc {
        font-size: 14px;
        opacity: 0.9;
        color: inherit;
        line-height: 1.5;
      }
      .ocr-dialog-options .cta-button {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
      }
      .ocr-dialog-options .cta-button:hover {
        transform: translateY(-3px);
        box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
      }
      .ocr-dialog-options .secondary-btn {
        background: white;
        color: #4b5563;
        border: 2px solid #e5e7eb;
      }
      .ocr-dialog-options .secondary-btn:hover {
        border-color: #667eea;
        background: #f9fafb;
        transform: translateY(-3px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      }
      .text-btn {
        position: absolute;
        top: 34px;
        right: 15px;
        background: red;
        border: none;
        color: #fff;
        font-size: 20px;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 999999;
        cursor: pointer;
      }
      .text-btn:hover {
        color: #ef4444;
        background: #fef2f2;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }
      @keyframes slideUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* ── Processing Dialog ── */
      .processing-dialog {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        backdrop-filter: blur(5px);
      }
      .processing-dialog.show {
        display: flex;
      }
      .processing-dialog-content {
        background: white;
        border-radius: 20px;
        padding: 40px;
        max-width: 420px;
        width: 90%;
        text-align: center;
        box-shadow: 0 25px 60px rgba(0, 0, 0, 0.3);
      }
      .spinner {
        width: 80px;
        height: 80px;
        border: 4px solid #f3f4f6;
        border-top: 4px solid #667eea;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 20px;
      }
      .processing-step {
        font-size: 13px;
        color: #6b7280;
        margin-top: 8px;
        min-height: 20px;
        transition: all 0.3s ease;
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* ── AI badge ── */
      .ai-badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        margin-left: 8px;
        vertical-align: middle;
      }

      @media (max-width: 768px) {
        .subtitle {
          font-size: 16px;
        }
        .result-btns-container {
          flex-direction: column;
        }
        .result-btns-container .cta-button,
        .result-btns-container .secondary-btn {
          width: 100%;
        }
      }
    </style>

    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5797619165090350"
      crossorigin="anonymous"
    ></script>
  </head>

  <body>
    <a href="#main-content" class="skip-to-main">Skip to main content</a>
    <section id="header-placeholder"></section>

    <main id="main-content">
      <!-- ════════════════════════════════════════════════════════ TOOL SECTION -->
      <section class="merge-tool" aria-labelledby="ppt-heading">
        <div class="container">
          <h1 id="ppt-heading">
            NextoPDF — PDF to PowerPoint Converter
            <span class="ai-badge"><i class="fa fa-robot"></i> Google AI</span>
          </h1>
          <p class="subtitle">
            Convert PDF to PowerPoint with pixel-accurate text positioning.
            Scanned PDFs are processed with Google AI Vision OCR. Fast, secure,
            and completely free.
          </p>

          <div class="upload-section">
            <!-- Upload area -->
            <div id="uploadSection">
              <label
                for="pdfUpload"
                class="upload-label"
                tabindex="0"
                role="button"
                aria-label="Choose PDF file to upload"
              >
                <i class="fa fa-upload" aria-hidden="true"></i>
                <span>Choose PDF File</span>
              </label>
              <input
                type="file"
                id="pdfUpload"
                accept=".pdf"
                aria-label="Select PDF file to convert to PowerPoint"
              />
            </div>

            <ul
              id="fileList"
              class="file-list"
              role="list"
              aria-label="Selected PDF file"
              style="display: none"
            ></ul>

            <!-- Language selector (shown for scanned PDFs) -->
            <div id="langSection" style="display: none">
              <label class="select-label" for="selectBox" id="languageLabel">
                OCR Language Hint
                <span style="font-weight: 400; color: #6b7280; font-size: 14px">
                  (Google AI auto-detects, this is a hint)</span
                >
              </label>
              <div class="multi-select">
                <div
                  class="select-box"
                  id="selectBox"
                  role="button"
                  tabindex="0"
                  aria-labelledby="languageLabel"
                  aria-expanded="false"
                  aria-haspopup="listbox"
                >
                  <span class="tag">English</span>
                </div>
                <div
                  id="dropdown"
                  role="listbox"
                  aria-labelledby="languageLabel"
                >
                  <input
                    type="text"
                    id="searchLang"
                    placeholder="Search language..."
                    aria-label="Search for languages"
                  />
                  <div id="options"></div>
                </div>
              </div>
            </div>

            <button
              id="convertBtn"
              class="cta-button"
              aria-label="Convert PDF to PowerPoint"
            >
              <span class="btn-spinner" aria-hidden="true"
                ><i class="fa fa-spinner fa-spin"></i> Processing...</span
              >
              <span class="btn-text"
                ><i class="fa fa-file-powerpoint" aria-hidden="true"></i>
                Convert to PowerPoint</span
              >
            </button>

            <p
              class="error-text"
              id="errorMsg"
              role="alert"
              aria-live="polite"
            ></p>

            <!-- Result section -->
            <div
              id="resultBtns"
              style="display: none; margin-top: 20px"
              role="region"
              aria-label="Conversion results"
            >
              <div id="resultCard" class="result-card">
                <i
                  class="fa fa-file-powerpoint"
                  aria-hidden="true"
                  style="font-size: 60px; color: white"
                ></i>
              </div>
              <p class="file-name">
                <a href="#" id="fileNameLink" aria-label="View converted PPTX"
                  >presentation.pptx</a
                >
              </p>
              <div class="result-btns-container">
                <a
                  id="downloadBtn"
                  href="#"
                  class="cta-button"
                  download="presentation.pptx"
                  aria-label="Download PowerPoint presentation"
                >
                  <i class="fa fa-download" aria-hidden="true"></i> Download
                </a>
                <button
                  id="shareBtn"
                  class="cta-button"
                  aria-label="Share PowerPoint presentation"
                >
                  <i class="fa fa-share-alt" aria-hidden="true"></i> Share
                </button>
                <button
                  id="resetBtn"
                  class="secondary-btn"
                  aria-label="Convert another PDF"
                >
                  <i class="fa fa-rotate-right" aria-hidden="true"></i> Convert
                  Another PDF
                </button>
              </div>
            </div>

            <p class="note">
              <i class="fa fa-info-circle" aria-hidden="true"></i>
              <strong>Smart Conversion:</strong>
              Text-based PDFs have selectable, editable text placed at exact
              original positions. Text inside images is kept as part of the
              image — never extracted twice. Scanned PDFs use Google AI Vision
              OCR to make text searchable.
            </p>
          </div>
        </div>
      </section>

      <!-- ════════════════════════════════════════════════════════ ADS 1 -->
      <section class="ad-section" style="margin: 40px 0; text-align: center">
        <div class="container">
          <ins
            class="adsbygoogle"
            style="display: block"
            data-ad-client="ca-pub-5797619165090350"
            data-ad-slot="7553156845"
            data-ad-format="auto"
            data-full-width-responsive="true"
          ></ins>
          <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
        </div>
      </section>

      <!-- ════════════════════════════════════════════════════════ HOW-TO -->
      <section class="features" style="background: #f9fafb">
        <div class="container">
          <h2>How to Convert PDF to PowerPoint Online</h2>
          <p
            style="
              text-align: center;
              color: #555;
              margin-bottom: 40px;
              max-width: 800px;
              margin-left: auto;
              margin-right: auto;
            "
          >
            Follow these simple steps to convert your PDF documents into
            editable PowerPoint presentations.
          </p>
          <div class="feature-grid">
            <div class="feature-card">
              <div
                style="
                  font-size: 48px;
                  color: #4f46e5;
                  font-weight: bold;
                  margin-bottom: 10px;
                "
              >
                1
              </div>
              <h3>Upload PDF File</h3>
              <p>
                Click "Choose PDF File" and select your PDF. Works with
                text-based and scanned PDFs.
              </p>
            </div>
            <div class="feature-card">
              <div
                style="
                  font-size: 48px;
                  color: #4f46e5;
                  font-weight: bold;
                  margin-bottom: 10px;
                "
              >
                2
              </div>
              <h3>Choose Processing Mode</h3>
              <p>
                Text PDFs convert instantly. Scanned PDFs prompt you to choose
                Google AI OCR or image-only mode.
              </p>
            </div>
            <div class="feature-card">
              <div
                style="
                  font-size: 48px;
                  color: #4f46e5;
                  font-weight: bold;
                  margin-bottom: 10px;
                "
              >
                3
              </div>
              <h3>Convert &amp; Download</h3>
              <p>
                Click Convert and download your editable PPTX file immediately.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- ════════════════════════════════════════════════════════ WHY US -->
      <section class="benefits" style="background: white; padding: 60px 20px">
        <div class="container">
          <h2>Why Use Our PDF to PowerPoint Converter?</h2>
          <div class="feature-grid">
            <div class="feature-card">
              <i
                class="fas fa-bolt"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Lightning Fast</h3>
              <p>
                Text-based PDFs convert in seconds. Scanned PDFs use Google AI
                for accurate OCR.
              </p>
            </div>
            <div class="feature-card">
              <i
                class="fas fa-crosshairs"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Exact Positioning</h3>
              <p>
                Every text span is placed at its exact original coordinate.
                Images stay where they belong.
              </p>
            </div>
            <div class="feature-card">
              <i
                class="fas fa-shield-alt"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Secure &amp; Private</h3>
              <p>
                Files are processed securely and deleted immediately after
                conversion.
              </p>
            </div>
            <div class="feature-card">
              <i
                class="fas fa-dollar-sign"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>100% Free</h3>
              <p>
                Convert unlimited files without charges, subscriptions, or
                hidden fees.
              </p>
            </div>
            <div class="feature-card">
              <i
                class="fas fa-user-lock"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>No Registration</h3>
              <p>Start immediately without creating an account.</p>
            </div>
            <div class="feature-card">
              <i
                class="fas fa-robot"
                style="font-size: 40px; color: #10b981; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Google AI OCR</h3>
              <p>
                Powered by Google Gemini Vision for accurate text recognition in
                scanned documents.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- ════════════════════════════════════════════════════════ ADS 2 -->
      <section
        class="ad-section"
        style="
          margin: 40px 0;
          text-align: center;
          background: #f9fafb;
          padding: 40px 20px;
        "
      >
        <div class="container">
          <ins
            class="adsbygoogle"
            style="display: block"
            data-ad-client="ca-pub-5797619165090350"
            data-ad-slot="7553156845"
            data-ad-format="auto"
            data-full-width-responsive="true"
          ></ins>
          <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
        </div>
      </section>

      <!-- ════════════════════════════════════════════════════════ GUIDE -->
      <section class="features" style="background: white">
        <div class="container">
          <h2>Complete Guide to PDF to PowerPoint Conversion</h2>
          <div style="max-width: 900px; margin: 0 auto; text-align: left">
            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              What Does PDF to PowerPoint Conversion Mean?
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 25px">
              Converting PDF to PowerPoint transforms a static PDF document into
              an editable PPTX file. Our tool uses Google AI to accurately
              detect and extract text, images, and layout — placing every
              element at its exact original position in the presentation.
            </p>
            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              How Text Extraction Works
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 25px">
              For text-based PDFs, only <strong>selectable text</strong> — text
              that exists as real PDF content — is extracted as editable text
              boxes. Text that is part of an image (e.g. a screenshot, scanned
              page, or graphic) is intentionally left as part of the image. This
              prevents double-rendering and ensures the visual fidelity of your
              presentation matches the original PDF.
            </p>
            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              Google AI OCR for Scanned PDFs
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 25px">
              When you upload a scanned PDF, Google Gemini Vision analyses each
              page, identifies text characters, and returns precise bounding
              boxes. This text is overlaid on the page image, making your
              presentation fully searchable and editable.
            </p>
            <h3 style="color: #1e3a8a; margin-bottom: 15px; margin-top: 35px">
              Tips for Best Results
            </h3>
            <p style="color: #555; line-height: 1.8; margin-bottom: 15px">
              To achieve the best results:
            </p>
            <ul
              style="
                color: #555;
                line-height: 1.8;
                margin-bottom: 25px;
                padding-left: 25px;
              "
            >
              <li style="margin-bottom: 10px">
                Use high-quality PDF files — especially for scanned documents.
              </li>
              <li style="margin-bottom: 10px">
                For scanned PDFs, ensure the original scan was done at 300 DPI
                or higher.
              </li>
              <li style="margin-bottom: 10px">
                Review the converted PowerPoint and make manual adjustments
                where needed.
              </li>
              <li style="margin-bottom: 10px">
                Keep backup copies of your original PDF files before conversion.
              </li>
            </ul>
          </div>
        </div>
      </section>

      <!-- ════════════════════════════════════════════════════════ FAQ -->
      <section class="features" style="background: #f9fafb">
        <div class="container">
          <h2>Frequently Asked Questions</h2>
          <div style="max-width: 800px; margin: 0 auto; text-align: left">
            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Is it really free?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Yes — completely free with no hidden charges or subscriptions.
              </p>
            </div>
            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Will formatting be preserved?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Our converter places text at exact original coordinates,
                preserving fonts, sizes, colours, and layout as accurately as
                possible.
              </p>
            </div>
            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Can I convert scanned PDFs?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Yes! For scanned PDFs you can choose Google AI OCR (makes text
                editable) or image-only mode (faster, visual only).
              </p>
            </div>
            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Why is text inside images not extracted separately?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Text baked into an image (not selectable in the PDF) is
                intentionally kept as part of the image. Extracting it
                separately would distort the layout. In OCR mode, Gemini Vision
                overlays searchable text without altering the image.
              </p>
            </div>
            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                What is the maximum file size?
              </h3>
              <p style="color: #555; line-height: 1.8">
                Up to 50 MB. For best performance we recommend files under 20
                MB.
              </p>
            </div>
            <div style="margin-bottom: 30px">
              <h3 style="color: #1e3a8a; margin-bottom: 10px">
                Do I need to install anything?
              </h3>
              <p style="color: #555; line-height: 1.8">
                No installation required — works entirely in your browser.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- ════════════════════════════════════════════════════════ ADS 3 -->
      <section
        class="ad-section"
        style="
          margin: 40px 0;
          text-align: center;
          background: white;
          padding: 40px 20px;
        "
      >
        <div class="container">
          <ins
            class="adsbygoogle"
            style="display: block"
            data-ad-client="ca-pub-5797619165090350"
            data-ad-slot="7553156845"
            data-ad-format="auto"
            data-full-width-responsive="true"
          ></ins>
          <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
        </div>
      </section>

      <!-- ════════════════════════════════════════════════════════ RELATED TOOLS -->
      <section class="benefits" style="background: #f9fafb">
        <div class="container">
          <h2>Related PDF Tools</h2>
          <div class="feature-grid">
            <div class="feature-card">
              <i
                class="fas fa-file-pdf"
                style="font-size: 40px; color: #4f46e5; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Merge PDF</h3>
              <p>Combine multiple PDF files into a single document quickly.</p>
              <a
                href="/merge"
                class="cta-button"
                style="font-size: 14px; padding: 8px 16px; margin-top: 10px"
                >Merge PDF</a
              >
            </div>
            <div class="feature-card">
              <i
                class="fas fa-compress"
                style="font-size: 40px; color: #4f46e5; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>Compress PDF</h3>
              <p>Reduce PDF file size to make it easier to email or upload.</p>
              <a
                href="/compress-pdf"
                class="cta-button"
                style="font-size: 14px; padding: 8px 16px; margin-top: 10px"
                >Compress PDF</a
              >
            </div>
            <div class="feature-card">
              <i
                class="fas fa-file-word"
                style="font-size: 40px; color: #4f46e5; margin-bottom: 15px"
                aria-hidden="true"
              ></i>
              <h3>PDF to Word</h3>
              <p>
                Convert PDF documents to editable Word format while maintaining
                formatting.
              </p>
              <a
                href="/pdf-to-word"
                class="cta-button"
                style="font-size: 14px; padding: 8px 16px; margin-top: 10px"
                >PDF to Word</a
              >
            </div>
          </div>
        </div>
      </section>

      <!-- ════════════════════════════════════════════════════════ CTA -->
      <section
        class="hero"
        style="
          padding: 60px 20px;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        "
      >
        <div class="container">
          <h2 style="font-size: 32px; margin-bottom: 15px; color: white">
            Ready to Convert Your PDF to PowerPoint?
          </h2>
          <p style="margin-bottom: 25px; color: white">
            Start transforming your documents into editable presentations now —
            free, fast, and powered by Google AI.
          </p>
          <a
            href="#main-content"
            class="cta-button"
            style="background: white; color: #667eea"
          >
            <i class="fas fa-arrow-up" aria-hidden="true"></i> Convert PDF Now
          </a>
        </div>
      </section>
    </main>

    <!-- ════════════════════════════════════════════════════════ OCR CHOICE DIALOG -->
    <div
      id="ocrChoiceDialog"
      class="ocr-dialog"
      role="dialog"
      aria-labelledby="ocrDialogTitle"
      aria-modal="true"
    >
      <div class="ocr-dialog-content">
        <h3 id="ocrDialogTitle">
          <i
            class="fa fa-scan-image"
            aria-hidden="true"
            style="margin-right: 10px; color: #667eea"
          ></i>
          Scanned PDF Detected
        </h3>
        <p>
          Your PDF appears to be <strong>image-based</strong> (scanned document
          or images).
        </p>
        <p>No selectable text was found. Choose how to process it:</p>
        <p class="dialog-subtitle">Choose conversion method:</p>
        <div class="ocr-dialog-options">
          <button
            id="ocrOption"
            class="cta-button"
            aria-label="Process with Google AI OCR"
          >
            <i
              class="fa fa-robot"
              aria-hidden="true"
              style="font-size: 24px; margin-bottom: 8px"
            ></i>
            <span class="option-title">Google AI OCR</span>
            <span class="option-desc"
              >Google Gemini Vision reads the text — text becomes editable and
              searchable in PowerPoint. Best quality, slightly slower.</span
            >
          </button>
          <button
            id="imageOption"
            class="secondary-btn"
            aria-label="Convert as images only"
          >
            <i
              class="fa fa-image"
              aria-hidden="true"
              style="font-size: 24px; margin-bottom: 8px"
            ></i>
            <span class="option-title">Image-Only</span>
            <span class="option-desc"
              >Convert pages as images — fast, but text won't be selectable or
              editable.</span
            >
          </button>
        </div>
        <button
          id="cancelOption"
          class="text-btn"
          aria-label="Cancel conversion"
        >
          <i class="fa fa-times" aria-hidden="true"></i>
        </button>
      </div>
    </div>

    <!-- ════════════════════════════════════════════════════════ PROCESSING DIALOG -->
    <div
      id="processingDialog"
      class="processing-dialog"
      role="dialog"
      aria-labelledby="processingTitle"
      aria-modal="true"
    >
      <div class="processing-dialog-content">
        <div class="spinner" aria-hidden="true"></div>
        <h3
          id="processingTitle"
          style="color: #1f2937; margin-bottom: 10px; font-size: 22px"
        >
          Converting PDF to PowerPoint
        </h3>
        <p
          style="color: #6b7280; margin-bottom: 8px; font-size: 15px"
          id="processingMsg"
        >
          Analysing your document…
        </p>
        <p class="processing-step" id="processingStep"></p>
        <p style="color: #9ca3af; font-size: 13px; margin-top: 12px">
          Please don't close this page.
        </p>
      </div>
    </div>

    <section id="footer-placeholder"></section>

    <script src="./js/app.js"></script>

    <!--
  DROP-IN REPLACEMENT for the <script> block in your HTML.
  Replace everything from  // ══ CONFIG  down to  // ══ CLEANUP
  with this content (keep your existing <style> and HTML structure).

  CHANGES:
    1. /pdf-to-ppt now consumes an SSE stream → shows page progress in dialog
    2. Processing dialog shows "Page X / N" with an animated progress bar
    3. File is received as base64 in the final SSE event (no second fetch)
-->

    <style>
      /* ── Progress bar inside processing dialog ── */
      .progress-bar-track {
        width: 100%;
        height: 8px;
        background: #e5e7eb;
        border-radius: 99px;
        overflow: hidden;
        margin: 16px 0 4px;
      }
      .progress-bar-fill {
        height: 100%;
        width: 0%;
        background: linear-gradient(90deg, #667eea, #764ba2);
        border-radius: 99px;
        transition: width 0.4s ease;
      }
      .progress-counter {
        font-size: 13px;
        color: #9ca3af;
        text-align: center;
        margin-top: 4px;
      }
    </style>

    <!-- Add these two elements inside .processing-dialog-content, after #processingStep -->
    <!-- PASTE INSIDE .processing-dialog-content in your HTML:
  <div class="progress-bar-track" id="progressTrack" style="display:none">
    <div class="progress-bar-fill" id="progressFill"></div>
  </div>
  <p class="progress-counter" id="progressCounter"></p>
-->

    <script>
      // ══════════════════════════════════════════════════════════════════════
      // CONFIG
      // ══════════════════════════════════════════════════════════════════════
      const BACKEND_URL = `http://127.0.0.1:8080/pdf-to-ppt`;
      const CHECK_TEXT_URL = `http://127.0.0.1:8080/check-pdf-text`;
      const MAX_FILE_SIZE = 50 * 1024 * 1024; // 50 MB

      // ══════════════════════════════════════════════════════════════════════
      // DOM REFS
      // ══════════════════════════════════════════════════════════════════════
      const pdfInput = document.getElementById("pdfUpload");
      const fileList = document.getElementById("fileList");
      const convertBtn = document.getElementById("convertBtn");
      const errorMsg = document.getElementById("errorMsg");
      const resultBtns = document.getElementById("resultBtns");
      const downloadBtn = document.getElementById("downloadBtn");
      const shareBtn = document.getElementById("shareBtn");
      const resetBtn = document.getElementById("resetBtn");
      const fileNameLink = document.getElementById("fileNameLink");
      const uploadSection = document.getElementById("uploadSection");
      const langSection = document.getElementById("langSection");

      const ocrDialog = document.getElementById("ocrChoiceDialog");
      const ocrOptionBtn = document.getElementById("ocrOption");
      const imageOptionBtn = document.getElementById("imageOption");
      const cancelOptionBtn = document.getElementById("cancelOption");
      const processingDialog = document.getElementById("processingDialog");
      const processingMsg = document.getElementById("processingMsg");
      const processingStep = document.getElementById("processingStep");
      const progressTrack = document.getElementById("progressTrack");
      const progressFill = document.getElementById("progressFill");
      const progressCounter = document.getElementById("progressCounter");

      // ══════════════════════════════════════════════════════════════════════
      // STATE
      // ══════════════════════════════════════════════════════════════════════
      let selectedFile = null;
      let convertedFileUrl = null;
      let convertedFileName = "presentation.pptx";
      let isConverting = false;

      // ══════════════════════════════════════════════════════════════════════
      // LANGUAGE SELECTION
      // ══════════════════════════════════════════════════════════════════════
      const languages = [
        ["eng", "English"],
        ["hin", "Hindi"],
        ["ben", "Bengali"],
        ["spa", "Spanish"],
        ["fra", "French"],
        ["deu", "German"],
        ["ita", "Italian"],
        ["por", "Portuguese"],
        ["rus", "Russian"],
        ["jpn", "Japanese"],
        ["kor", "Korean"],
        ["chi_sim", "Chinese Simplified"],
        ["chi_tra", "Chinese Traditional"],
        ["ara", "Arabic"],
        ["tha", "Thai"],
        ["vie", "Vietnamese"],
      ];
      let selectedLangs = ["eng"];

      const selectBox = document.getElementById("selectBox");
      const dropdown = document.getElementById("dropdown");
      const optionsDiv = document.getElementById("options");
      const searchInput = document.getElementById("searchLang");

      function renderOptions(filter = "") {
        optionsDiv.innerHTML = "";
        const filtered = languages.filter((l) =>
          l[1].toLowerCase().includes(filter.toLowerCase()),
        );
        if (!filtered.length) {
          optionsDiv.innerHTML =
            '<div style="padding:20px;text-align:center;color:#9ca3af">No languages found</div>';
          return;
        }
        filtered.forEach((l) => {
          const div = document.createElement("div");
          div.className =
            "option" + (selectedLangs.includes(l[0]) ? " selected" : "");
          div.textContent = l[1];
          div.setAttribute("role", "option");
          div.setAttribute(
            "aria-selected",
            selectedLangs.includes(l[0]) ? "true" : "false",
          );
          div.onclick = () => toggleLang(l);
          optionsDiv.appendChild(div);
        });
      }

      function toggleLang(l) {
        hideError();
        selectedLangs = selectedLangs.includes(l[0])
          ? selectedLangs.filter((x) => x !== l[0])
          : [...selectedLangs, l[0]];
        updateTags();
        renderOptions(searchInput.value);
      }

      function updateTags() {
        selectBox.innerHTML = "";
        if (!selectedLangs.length) {
          selectBox.innerHTML =
            '<span class="select-placeholder">Select languages…</span>';
          return;
        }
        selectedLangs.forEach((code) => {
          const name = languages.find((l) => l[0] === code)[1];
          const tag = document.createElement("span");
          tag.className = "tag";
          tag.innerHTML = `${name} <span class="remove-tag" data-code="${code}" role="button" aria-label="Remove ${name}" tabindex="0">×</span>`;
          selectBox.appendChild(tag);
        });
        selectBox.querySelectorAll(".remove-tag").forEach((btn) => {
          btn.onclick = (e) => {
            e.stopPropagation();
            removeTag(e.target.dataset.code);
          };
          btn.onkeypress = (e) => {
            if (e.key === "Enter" || e.key === " ") {
              e.preventDefault();
              e.stopPropagation();
              removeTag(e.target.dataset.code);
            }
          };
        });
      }

      function removeTag(code) {
        selectedLangs = selectedLangs.filter((x) => x !== code);
        updateTags();
        renderOptions(searchInput.value);
      }

      selectBox.onclick = (e) => {
        if (e.target.classList.contains("remove-tag")) return;
        const isOpen = dropdown.classList.contains("show");
        dropdown.classList.toggle("show");
        selectBox.classList.toggle("open");
        selectBox.setAttribute("aria-expanded", !isOpen);
        if (!isOpen) {
          searchInput.focus();
          searchInput.value = "";
          renderOptions();
        }
      };
      searchInput.oninput = (e) => renderOptions(e.target.value);
      document.addEventListener("click", (e) => {
        if (!selectBox.contains(e.target) && !dropdown.contains(e.target)) {
          dropdown.classList.remove("show");
          selectBox.classList.remove("open");
          selectBox.setAttribute("aria-expanded", "false");
        }
      });
      selectBox.addEventListener("keypress", (e) => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          selectBox.click();
        }
      });
      renderOptions();
      updateTags();

      // ══════════════════════════════════════════════════════════════════════
      // UTILITIES
      // ══════════════════════════════════════════════════════════════════════
      function hideError() {
        errorMsg.style.display = "none";
        errorMsg.textContent = "";
      }

      function showError(msg) {
        errorMsg.textContent = msg;
        errorMsg.style.display = "block";
        setTimeout(() => {
          if (errorMsg.textContent === msg) errorMsg.style.display = "none";
        }, 7000);
      }

      function showToast(msg) {
        let toast = document.getElementById("toastMsg");
        if (!toast) {
          toast = document.createElement("div");
          toast.id = "toastMsg";
          toast.style.cssText = `
        position:fixed;top:20px;right:20px;
        padding:15px 25px;border-radius:10px;
        box-shadow:0 10px 25px rgba(0,0,0,.2);
        z-index:20000;font-weight:500;
        animation:slideIn .3s ease;
        background:linear-gradient(135deg,#10b981 0%,#059669 100%);
        color:white;
      `;
          document.body.appendChild(toast);
        }
        toast.innerHTML = `<i class="fa fa-check-circle" style="margin-right:8px"></i>${msg}`;
        toast.style.display = "block";
        setTimeout(() => {
          toast.style.display = "none";
        }, 4000);
      }

      // ── Progress dialog helpers ──────────────────────────────────────────
      function showProcessingDialog(msg = "Checking your PDF…", step = "") {
        processingMsg.textContent = msg;
        processingStep.textContent = step;
        if (progressTrack) progressTrack.style.display = "none";
        if (progressCounter) progressCounter.textContent = "";
        processingDialog.classList.add("show");
      }

      function hideProcessingDialog() {
        processingDialog.classList.remove("show");
      }

      /**
       * Update the progress bar and counter inside the processing dialog.
       * @param {number} current  — pages processed so far (1-based)
       * @param {number} total    — total page count
       * @param {string} msg      — main message line
       */
      function updateProgress(current, total, msg) {
        if (processingMsg) processingMsg.textContent = msg;
        if (processingStep) processingStep.textContent = "";

        if (progressTrack && total > 0) {
          progressTrack.style.display = "block";
          const pct = Math.round((current / total) * 100);
          if (progressFill) progressFill.style.width = pct + "%";
          if (progressCounter) {
            progressCounter.textContent = `Page ${current} of ${total}`;
          }
        }
      }

      // ══════════════════════════════════════════════════════════════════════
      // DIALOGS
      // ══════════════════════════════════════════════════════════════════════
      function showOCRChoiceDialog() {
        return new Promise((resolve) => {
          ocrDialog.classList.add("show");
          const newOcr = ocrOptionBtn.cloneNode(true);
          const newImg = imageOptionBtn.cloneNode(true);
          const newCancel = cancelOptionBtn.cloneNode(true);
          ocrOptionBtn.replaceWith(newOcr);
          imageOptionBtn.replaceWith(newImg);
          cancelOptionBtn.replaceWith(newCancel);
          document.getElementById("ocrOption").onclick = () => {
            ocrDialog.classList.remove("show");
            resolve("ocr");
          };
          document.getElementById("imageOption").onclick = () => {
            ocrDialog.classList.remove("show");
            resolve("image");
          };
          document.getElementById("cancelOption").onclick = () => {
            ocrDialog.classList.remove("show");
            resolve("cancel");
          };
          const esc = (e) => {
            if (e.key === "Escape") {
              ocrDialog.classList.remove("show");
              document.removeEventListener("keydown", esc);
              resolve("cancel");
            }
          };
          document.addEventListener("keydown", esc);
        });
      }

      // ══════════════════════════════════════════════════════════════════════
      // FILE HANDLING
      // ══════════════════════════════════════════════════════════════════════
      function renderFileList() {
        if (!selectedFile) {
          fileList.style.display = "none";
          return;
        }
        fileList.style.display = "block";
        fileList.innerHTML = "";
        const li = document.createElement("li");
        const sizeMB = (selectedFile.size / 1048576).toFixed(2);
        li.innerHTML = `
      <div class="file-info">
        <i class="fa fa-file-pdf pdf-icon" aria-hidden="true"></i>
        <span class="file-name-text">${selectedFile.name}</span>
        <span style="color:#6b7280;font-size:13px;margin-left:8px">(${sizeMB} MB)</span>
      </div>
      <button class="delete-file" onclick="removeFile()" aria-label="Remove ${selectedFile.name}">
        <i class="fa fa-times" aria-hidden="true"></i>
      </button>`;
        fileList.appendChild(li);
      }

      pdfInput.addEventListener("change", (e) => {
        hideError();
        if (!pdfInput.files?.length) {
          selectedFile = null;
          renderFileList();
          return;
        }
        const file = pdfInput.files[0];
        if (
          file.type !== "application/pdf" &&
          !file.name.toLowerCase().endsWith(".pdf")
        ) {
          showError("Please select a valid PDF file");
          pdfInput.value = "";
          selectedFile = null;
          renderFileList();
          return;
        }
        if (file.size > MAX_FILE_SIZE) {
          showError(
            `File exceeds ${(MAX_FILE_SIZE / 1048576).toFixed(0)} MB limit`,
          );
          pdfInput.value = "";
          selectedFile = null;
          renderFileList();
          return;
        }
        if (file.size === 0) {
          showError("Selected file is empty");
          pdfInput.value = "";
          selectedFile = null;
          renderFileList();
          return;
        }
        selectedFile = file;
        renderFileList();
        showToast(`"${file.name}" selected successfully!`);
      });

      window.removeFile = () => {
        selectedFile = null;
        pdfInput.value = "";
        renderFileList();
        hideError();
      };

      // ══════════════════════════════════════════════════════════════════════
      // CHECK PDF TEXT
      // ══════════════════════════════════════════════════════════════════════
      async function checkPDFHasText(file) {
        const fd = new FormData();
        fd.append("file", file);
        try {
          const res = await fetch(CHECK_TEXT_URL, { method: "POST", body: fd });
          if (!res.ok) throw new Error("Check failed");
          const data = await res.json();
          return !!data.hasText;
        } catch {
          return false;
        }
      }

      // ══════════════════════════════════════════════════════════════════════
      // SSE CONVERSION — reads the stream, updates progress, resolves on done
      // ══════════════════════════════════════════════════════════════════════
      function runConversionSSE(fd) {
        return new Promise(async (resolve, reject) => {
          let response;
          try {
            response = await fetch(BACKEND_URL, { method: "POST", body: fd });
          } catch (err) {
            return reject(new Error("Network error: " + err.message));
          }

          if (!response.ok) {
            const errData = await response.json().catch(() => ({}));
            return reject(
              new Error(
                errData.error || `Server error (HTTP ${response.status})`,
              ),
            );
          }

          const reader = response.body.getReader();
          const decoder = new TextDecoder();
          let buffer = "";

          const processLine = (line) => {
            if (!line.startsWith("data:")) return;
            const raw = line.slice(5).trim();
            if (!raw) return;
            let evt;
            try {
              evt = JSON.parse(raw);
            } catch {
              return;
            }

            if (evt.type === "progress") {
              updateProgress(evt.page, evt.total, evt.msg);
            } else if (evt.type === "done") {
              // Decode base64 → Blob
              const binary = atob(evt.file);
              const bytes = new Uint8Array(binary.length);
              for (let i = 0; i < binary.length; i++)
                bytes[i] = binary.charCodeAt(i);
              const blob = new Blob([bytes], {
                type: "application/vnd.openxmlformats-officedocument.presentationml.presentation",
              });
              resolve({ blob, filename: evt.filename });
            } else if (evt.type === "error") {
              reject(new Error(evt.msg || "Conversion failed"));
            }
          };

          // Read stream chunks
          (async () => {
            try {
              while (true) {
                const { done, value } = await reader.read();
                if (done) break;
                buffer += decoder.decode(value, { stream: true });
                const lines = buffer.split("\n");
                buffer = lines.pop(); // keep incomplete last line
                lines.forEach(processLine);
              }
              // Process any remaining buffer content
              if (buffer.trim()) processLine(buffer.trim());
            } catch (err) {
              reject(new Error("Stream read error: " + err.message));
            }
          })();
        });
      }

      // ══════════════════════════════════════════════════════════════════════
      // CONVERT BUTTON
      // ══════════════════════════════════════════════════════════════════════
      convertBtn.addEventListener("click", async () => {
        if (isConverting) {
          showError("Conversion already in progress. Please wait.");
          return;
        }
        if (!selectedFile) {
          showError("Please upload a PDF file");
          return;
        }

        hideError();
        isConverting = true;
        convertBtn.classList.add("btn-loading");
        convertBtn.disabled = true;

        try {
          // Step 1: detect whether PDF has selectable text
          showProcessingDialog("Checking your PDF…");
          const hasText = await checkPDFHasText(selectedFile);

          let mode = "auto";
          let finalHasText = hasText;

          if (hasText) {
            mode = "auto";
            finalHasText = true;
            langSection.style.display = "none";
            updateProgress(
              0,
              0,
              "Text-based PDF detected — extracting content…",
            );
          } else {
            hideProcessingDialog();
            const choice = await showOCRChoiceDialog();
            if (choice === "cancel") {
              resetConvertBtn();
              return;
            }

            mode = choice;
            finalHasText = false;

            if (mode === "ocr") {
              if (!selectedLangs.length) {
                showError("Please select at least one language for OCR");
                resetConvertBtn();
                return;
              }
              langSection.style.display = "block";
              showProcessingDialog("Processing with Google AI OCR…");
            } else {
              showProcessingDialog("Converting pages to images…");
            }
          }

          // Step 2: stream conversion with SSE progress
          const fd = new FormData();
          fd.append("file", selectedFile);
          fd.append("lang", selectedLangs.join("+"));
          fd.append("mode", mode);
          fd.append("has_text", finalHasText.toString());

          const { blob, filename } = await runConversionSSE(fd);

          if (blob.size === 0) throw new Error("Server returned an empty file");

          const url = URL.createObjectURL(blob);
          convertedFileUrl = url;
          convertedFileName =
            filename || selectedFile.name.replace(/\.pdf$/i, "") + ".pptx";

          // Show result
          fileList.style.display = "none";
          convertBtn.style.display = "none";
          uploadSection.style.display = "none";
          langSection.style.display = "none";
          document.querySelector(".note").style.display = "none";
          resultBtns.style.display = "block";

          downloadBtn.href = url;
          downloadBtn.download = convertedFileName;
          fileNameLink.textContent = convertedFileName;
          fileNameLink.onclick = (e) => {
            e.preventDefault();
            window.open(url, "_blank");
          };

          const successMsgs = {
            ocr: "Scanned PDF processed with Google AI OCR! Text is now editable.",
            image: "Scanned PDF converted as images.",
            auto: "Text-based PDF converted with exact positioning!",
          };
          showToast(successMsgs[mode] || "Conversion successful!");
        } catch (err) {
          showError(err.message || "Conversion failed. Please try again.");
        } finally {
          hideProcessingDialog();
          resetConvertBtn();
        }
      });

      function resetConvertBtn() {
        isConverting = false;
        convertBtn.classList.remove("btn-loading");
        convertBtn.disabled = false;
      }

      // ══════════════════════════════════════════════════════════════════════
      // SHARE
      // ══════════════════════════════════════════════════════════════════════
      shareBtn.addEventListener("click", async () => {
        if (!convertedFileUrl) return;
        try {
          if (navigator.share && navigator.canShare) {
            const response = await fetch(convertedFileUrl);
            const blob = await response.blob();
            const file = new File([blob], convertedFileName, {
              type: "application/vnd.openxmlformats-officedocument.presentationml.presentation",
            });
            const shareData = {
              title: "PowerPoint Presentation",
              files: [file],
            };
            if (navigator.canShare(shareData)) {
              await navigator.share(shareData);
              showToast("Shared!");
              return;
            }
          }
          await navigator.clipboard
            .writeText(window.location.href)
            .catch(() => {
              const t = document.createElement("input");
              t.value = window.location.href;
              document.body.appendChild(t);
              t.select();
              document.execCommand("copy");
              document.body.removeChild(t);
            });
          const orig = shareBtn.innerHTML;
          shareBtn.innerHTML = '<i class="fa fa-check"></i> Link Copied!';
          shareBtn.disabled = true;
          setTimeout(() => {
            shareBtn.innerHTML = orig;
            shareBtn.disabled = false;
          }, 2000);
        } catch (err) {
          if (err.name !== "AbortError")
            showError("Sharing failed. You can still download the file.");
        }
      });

      // ══════════════════════════════════════════════════════════════════════
      // RESET
      // ══════════════════════════════════════════════════════════════════════
      resetBtn.addEventListener("click", () => {
        if (convertedFileUrl) URL.revokeObjectURL(convertedFileUrl);
        selectedFile = null;
        selectedLangs = ["eng"];
        convertedFileUrl = null;
        convertedFileName = "presentation.pptx";
        isConverting = false;
        pdfInput.value = "";
        fileList.innerHTML = "";
        fileList.style.display = "none";
        uploadSection.style.display = "block";
        convertBtn.style.display = "inline-flex";
        convertBtn.classList.remove("btn-loading");
        convertBtn.disabled = false;
        resultBtns.style.display = "none";
        langSection.style.display = "none";
        document.querySelector(".note").style.display = "block";
        hideError();
        updateTags();
        renderOptions();
        window.scrollTo({ top: 0, behavior: "smooth" });
      });

      // ══════════════════════════════════════════════════════════════════════
      // DRAG & DROP
      // ══════════════════════════════════════════════════════════════════════
      const uploadLabel = document.querySelector(".upload-label");
      ["dragenter", "dragover", "dragleave", "drop"].forEach((ev) =>
        uploadLabel.addEventListener(
          ev,
          (e) => {
            e.preventDefault();
            e.stopPropagation();
          },
          false,
        ),
      );
      ["dragenter", "dragover"].forEach((ev) =>
        uploadLabel.addEventListener(
          ev,
          () => {
            uploadLabel.classList.add("drag-over");
            uploadLabel.style.transform = "scale(1.02)";
            uploadLabel.style.borderColor = "#4f46e5";
            uploadLabel.style.backgroundColor = "#f5f3ff";
          },
          false,
        ),
      );
      ["dragleave", "drop"].forEach((ev) =>
        uploadLabel.addEventListener(
          ev,
          () => {
            uploadLabel.classList.remove("drag-over");
            uploadLabel.style.transform = "scale(1)";
            uploadLabel.style.borderColor = uploadLabel.style.backgroundColor =
              "";
          },
          false,
        ),
      );
      uploadLabel.addEventListener("drop", (e) => {
        const file = e.dataTransfer.files[0];
        if (!file) return;
        if (file.type !== "application/pdf") {
          showError("Please drop a PDF file");
          return;
        }
        if (file.size > MAX_FILE_SIZE) {
          showError("File exceeds size limit");
          return;
        }
        selectedFile = file;
        const dt = new DataTransfer();
        dt.items.add(file);
        pdfInput.files = dt.files;
        renderFileList();
        showToast(`"${file.name}" selected!`);
      });
      uploadLabel.addEventListener("keypress", (e) => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          pdfInput.click();
        }
      });
      document.addEventListener("keydown", (e) => {
        if (
          (e.ctrlKey || e.metaKey) &&
          e.key === "Enter" &&
          selectedFile &&
          !isConverting &&
          convertBtn.style.display !== "none"
        )
          convertBtn.click();
      });

      // ══════════════════════════════════════════════════════════════════════
      // CLEANUP
      // ══════════════════════════════════════════════════════════════════════
      window.addEventListener("beforeunload", () => {
        if (convertedFileUrl) URL.revokeObjectURL(convertedFileUrl);
      });
    </script>
  </body>
</html>
