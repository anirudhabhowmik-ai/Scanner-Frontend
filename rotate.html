<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Primary Meta Tags -->
    <title>Rotate PDF Pages Online Free - Fix PDF Orientation | NextoPDF</title>
    <meta
      name="title"
      content="Rotate PDF Pages Online Free - Fix PDF Orientation | NextoPDF"
    />
    <meta
      name="description"
      content="Rotate PDF pages online for free. Fix page orientation by rotating pages 90, 180, or 270 degrees. Rotate individual pages or entire documents. Perfect for scanned PDFs with wrong orientation."
    />
    <meta
      name="keywords"
      content="rotate PDF online free, rotate PDF pages, fix PDF orientation, turn PDF pages, rotate scanned PDF, flip PDF pages, correct PDF rotation"
    />
    <meta name="author" content="NextoPDF" />
    <meta
      name="robots"
      content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"
    />

    <!-- Canonical URL -->
    <link rel="canonical" href="https://nextopdf.com/rotate" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://nextopdf.com/rotate" />
    <meta
      property="og:title"
      content="Rotate PDF Pages Online Free - Fix PDF Orientation | NextoPDF"
    />
    <meta
      property="og:description"
      content="Rotate PDF pages online for free. Fix page orientation by rotating pages 90, 180, or 270 degrees. Perfect for scanned PDFs with wrong orientation."
    />
    <meta
      property="og:image"
      content="https://nextopdf.com/images/og-image.png"
    />
    <meta property="og:site_name" content="NextoPDF" />
    <meta property="og:locale" content="en_US" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="https://nextopdf.com/rotate" />
    <meta
      name="twitter:title"
      content="Rotate PDF Pages Online Free - Fix PDF Orientation | NextoPDF"
    />
    <meta
      name="twitter:description"
      content="Rotate PDF pages online for free. Fix page orientation by rotating pages 90, 180, or 270 degrees. Perfect for scanned PDFs."
    />
    <meta
      name="twitter:image"
      content="https://nextopdf.com/images/twitter-card.png"
    />
    <meta name="google-adsense-account" content="ca-pub-5797619165090350" />

    <!-- Structured Data / Schema.org -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "NextoPDF - Rotate PDF Pages",
        "url": "https://nextopdf.com/rotate",
        "description": "Free online tool to rotate PDF pages and fix document orientation",
        "applicationCategory": "UtilitiesApplication",
        "operatingSystem": "Any",
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "USD"
        },
        "featureList": "Rotate individual pages, Rotate entire documents, 90/180/270 degree rotation, Visual page preview, Fix scanned document orientation"
      }
    </script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&family=Inter:wght@400;500&display=swap"
      rel="stylesheet"
    />

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />

    <!-- Favicon -->
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="./images/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="./images/favicon-16x16.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="./images/apple-touch-icon.png"
    />

    <!-- Main CSS -->
    <link rel="stylesheet" href="./css/style.css" />

    <style>
      .pages-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 20px;
        margin: 30px auto;
        padding: 20px;
        background: white;
        border-radius: 12px;
        border: 2px dashed #e5e7eb;
        min-height: 200px;
        position: relative;
      }

      @media (max-width: 1024px) {
        .pages-grid {
          grid-template-columns: repeat(2, 1fr);
          gap: 18px;
        }
      }

      @media (max-width: 768px) {
        .pages-grid {
          grid-template-columns: 1fr;
          gap: 15px;
          padding: 15px;
        }
      }

      @media (max-width: 480px) {
        .pages-grid {
          grid-template-columns: 1fr;
          gap: 12px;
        }
      }

      .pages-grid:empty::after {
        content: "Upload a PDF to see pages here";
        position: absolute;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #9ca3af;
        text-align: center;
        padding: 20px;
      }

      .page-card {
        background: #fff;
        border-radius: 12px;
        padding: 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        position: relative;
        transition:
          transform 0.2s,
          box-shadow 0.2s;
      }

      .page-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
      }

      .page-number {
        position: absolute;
        top: -16px;
        left: 8px;
        background: #4f46e5;
        color: white;
        padding: 4px 10px;
        border-radius: 6px;
        font-size: 12px;
        font-weight: 600;
        z-index: 1;
      }

      .page-canvas-wrapper {
        width: 100%;
        min-height: 200px;
        background: #f9fafb;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: visible;
      }

      canvas {
        width: 100%;
        height: auto !important;
        display: block;
        transition: transform 0.3s ease;
      }

      .page-actions {
        display: flex;
        gap: 8px;
        margin-top: 10px;
      }

      .page-actions button {
        flex: 1;
        border: none;
        background: #f3f4f6;
        border-radius: 8px;
        padding: 8px;
        cursor: pointer;
        transition: all 0.2s ease;
        font-size: 20px;
        color: #4b5563;
      }

      .page-actions .rotate:hover {
        background: #dbeafe;
        color: #2563eb;
        transform: scale(1.05);
      }

      .btn-loading .btn-spinner {
        display: inline-block;
        margin-right: 6px;
      }

      .btn-loading .btn-text {
        display: none;
      }

      .btn-spinner {
        display: none;
      }

      .result-btns-container {
        display: flex;
        gap: 12px;
        justify-content: center;
        flex-wrap: wrap;
        margin-top: 20px;
      }

      @media (max-width: 768px) {
        .result-btns-container {
          flex-direction: column;
        }
      }

      .btn-container {
        position: fixed;
        bottom: 0;
        background: #fff;
        border-top: 4px solid #1d0cff;
        width: 100%;
        padding: 20px 0;
        z-index: 999;
        box-shadow: 0 -6px 20px rgba(0, 0, 0, 0.15);
        display: none;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }
    </style>

    <!-- Google AdSense (Replace with your AdSense ID) -->
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5797619165090350"
      crossorigin="anonymous"
    ></script>
  </head>

  <body>
    <section id="header-placeholder"></section>

    <main>
      <section class="merge-tool" role="main">
        <div class="container">
          <h1>NextoPDF - Rotate PDF Pages Online - Fix Document Orientation</h1>
          <p>
            NextoPDF - Rotate individual PDF pages or entire documents
            clockwise. Perfect for fixing scanned documents with wrong
            orientation.
          </p>

          <div class="upload-section">
            <div id="uploadSection">
              <label class="upload-label" for="pdfUpload">
                <i class="fa fa-upload" aria-hidden="true"></i> Choose PDF files
              </label>
              <input
                type="file"
                id="pdfUpload"
                accept=".pdf"
                multiple
                aria-label="Upload PDF files to rotate"
              />
            </div>

            <ul
              id="fileList"
              class="file-list"
              style="display: none"
              role="list"
            ></ul>

            <div
              id="pagesGrid"
              class="pages-grid"
              style="display: none"
              role="region"
              aria-label="PDF pages preview"
            ></div>

            <div class="btn-container" id="btn-container">
              <button
                id="rotateBtn"
                class="cta-button"
                aria-label="Apply rotation to PDF"
              >
                <span class="btn-spinner" aria-hidden="true">
                  <i class="fa fa-spinner fa-spin"></i>
                </span>
                <span class="btn-text"
                  ><i class="fa fa-rotate-right" aria-hidden="true"></i
                ></span>
                Rotate PDF
              </button>

              <p
                id="errorMsg"
                class="error-text"
                style="display: none"
                role="alert"
              ></p>
            </div>

            <div id="resultBtns" style="display: none; margin-top: 30px">
              <div class="result-card">
                <i class="fa fa-file-pdf" aria-hidden="true"></i>
              </div>

              <p class="file-name">
                <a href="#" id="fileNameLink">rotated.pdf</a>
              </p>

              <div class="result-btns-container">
                <a
                  id="downloadBtn"
                  class="cta-button"
                  download
                  aria-label="Download rotated PDF"
                >
                  <i class="fa fa-download" aria-hidden="true"></i> Download
                </a>
                <a
                  id="shareBtn"
                  class="cta-button"
                  aria-label="Share rotated PDF"
                >
                  <i class="fa fa-share-alt" aria-hidden="true"></i> Share
                </a>
                <button
                  id="resetBtn"
                  class="secondary-btn"
                  aria-label="Rotate another PDF"
                >
                  <i class="fa fa-rotate-right" aria-hidden="true"></i> Rotate
                  Another PDF
                </button>
              </div>
            </div>

            <p class="note" id="noteText">
              Supported format: PDF. Select one or multiple files.
            </p>
          </div>

          <div id="pdfPreview" style="display: none; margin-top: 30px">
            <h2>Preview Rotated PDF</h2>
            <iframe
              id="pdfFrame"
              width="100%"
              height="600"
              style="border-radius: 12px; border: 1px solid #e5e7eb"
              title="Rotated PDF preview"
            ></iframe>
          </div>
        </div>
      </section>

      <!-- How It Works Section -->
      <section class="benefits" style="background: white">
        <div class="container">
          <h2>How to Rotate PDF Pages</h2>
          <div class="feature-grid">
            <div class="feature-card">
              <div
                style="
                  font-size: 48px;
                  color: #fbbf24;
                  font-weight: bold;
                  margin-bottom: 10px;
                "
                aria-hidden="true"
              >
                1
              </div>
              <h3>Upload Your PDF</h3>
              <p>
                Select PDF files from your device. All pages will display as
                visual thumbnails for easy identification.
              </p>
            </div>
            <div class="feature-card">
              <div
                style="
                  font-size: 48px;
                  color: #fbbf24;
                  font-weight: bold;
                  margin-bottom: 10px;
                "
                aria-hidden="true"
              >
                2
              </div>
              <h3>Rotate Pages</h3>
              <p>
                Click the rotate button on each page to turn it 90 degrees
                clockwise. Click multiple times for 180° or 270° rotation.
              </p>
            </div>
            <div class="feature-card">
              <div
                style="
                  font-size: 48px;
                  color: #fbbf24;
                  font-weight: bold;
                  margin-bottom: 10px;
                "
                aria-hidden="true"
              >
                3
              </div>
              <h3>Download Result</h3>
              <p>
                Download your PDF with all pages in the correct orientation. All
                rotations are permanently applied.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- Advanced Techniques & Smart PDF Handling Section -->
      <section class="features" style="background: #f3f4f6; padding: 60px 20px">
        <div class="container">
          <h2>Advanced Techniques & Smart PDF Handling</h2>
          <p
            style="
              max-width: 900px;
              margin: 0 auto 40px;
              color: #555;
              line-height: 1.8;
              text-align: center;
            "
          >
            Take your PDF rotation workflow to the next level. Learn tips and
            features designed for efficiency, accuracy, and professional
            document presentation.
          </p>

          <div
            style="
              max-width: 1000px;
              margin: 0 auto;
              display: flex;
              flex-wrap: wrap;
              gap: 20px;
              justify-content: center;
            "
          >
            <!-- Card 1 -->
            <div
              style="
                background: white;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
                padding: 25px;
                flex: 1 1 280px;
                min-width: 280px;
              "
            >
              <h3 style="color: #1e40af; margin-bottom: 10px">
                Batch Rotation
              </h3>
              <p style="color: #555; line-height: 1.6">
                Rotate multiple pages or even multiple PDFs at once. Perfect for
                large documents or combining scans from different sources.
              </p>
            </div>

            <!-- Card 2 -->
            <div
              style="
                background: white;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
                padding: 25px;
                flex: 1 1 280px;
                min-width: 280px;
              "
            >
              <h3 style="color: #1e40af; margin-bottom: 10px">
                Automatic Orientation Detection
              </h3>
              <p style="color: #555; line-height: 1.6">
                Smart algorithms detect pages that are upside down or sideways,
                suggesting the correct rotation so you don't have to guess.
              </p>
            </div>

            <!-- Card 3 -->
            <div
              style="
                background: white;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
                padding: 25px;
                flex: 1 1 280px;
                min-width: 280px;
              "
            >
              <h3 style="color: #1e40af; margin-bottom: 10px">
                Preserve Quality & Content
              </h3>
              <p style="color: #555; line-height: 1.6">
                All rotations are lossless. Images, text, and annotations remain
                sharp, searchable, and fully functional after rotation.
              </p>
            </div>

            <!-- Card 4 -->
            <div
              style="
                background: white;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
                padding: 25px;
                flex: 1 1 280px;
                min-width: 280px;
              "
            >
              <h3 style="color: #1e40af; margin-bottom: 10px">
                Combine With Other Tools
              </h3>
              <p style="color: #555; line-height: 1.6">
                Rotate first, then merge, split, or compress PDFs for perfectly
                organized documents ready for sharing or storage.
              </p>
            </div>

            <!-- Card 5 -->
            <div
              style="
                background: white;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
                padding: 25px;
                flex: 1 1 280px;
                min-width: 280px;
              "
            >
              <h3 style="color: #1e40af; margin-bottom: 10px">
                Mobile & Desktop Friendly
              </h3>
              <p style="color: #555; line-height: 1.6">
                Rotate PDFs efficiently on any device. Tap or click page
                thumbnails to rotate, with live previews ensuring accuracy.
              </p>
            </div>

            <!-- Card 6 -->
            <div
              style="
                background: white;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
                padding: 25px;
                flex: 1 1 280px;
                min-width: 280px;
              "
            >
              <h3 style="color: #1e40af; margin-bottom: 10px">
                Accessibility Ready
              </h3>
              <p style="color: #555; line-height: 1.6">
                Properly rotated pages improve compatibility with screen readers
                and OCR tools. Ensure documents are readable by everyone.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- Tips for Efficient PDF Handling Section -->
      <section class="features" style="background: #fefce8; padding: 60px 20px">
        <div class="container">
          <h2>Tips for Efficient PDF Handling</h2>
          <p
            style="
              max-width: 900px;
              margin: 0 auto 40px;
              color: #555;
              line-height: 1.8;
              text-align: center;
            "
          >
            Maximize your productivity when working with PDF rotation tools.
            These tips help you save time and avoid common frustrations.
          </p>

          <div
            style="
              max-width: 1000px;
              margin: 0 auto;
              display: flex;
              flex-wrap: wrap;
              gap: 20px;
              justify-content: center;
            "
          >
            <!-- Card 1 -->
            <div
              style="
                background: white;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
                padding: 25px;
                flex: 1 1 300px;
                min-width: 280px;
              "
            >
              <h3 style="color: #b45309; margin-bottom: 10px">
                Plan Before Rotating
              </h3>
              <p style="color: #555; line-height: 1.6">
                Quickly review all pages and note which ones need rotation.
                Planning prevents unnecessary clicks and ensures consistency.
              </p>
            </div>

            <!-- Card 2 -->
            <div
              style="
                background: white;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
                padding: 25px;
                flex: 1 1 300px;
                min-width: 280px;
              "
            >
              <h3 style="color: #b45309; margin-bottom: 10px">
                Use Batch Operations
              </h3>
              <p style="color: #555; line-height: 1.6">
                When working with multiple PDFs, rotate all similar pages
                together. This saves time and keeps your documents uniform.
              </p>
            </div>

            <!-- Card 3 -->
            <div
              style="
                background: white;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
                padding: 25px;
                flex: 1 1 300px;
                min-width: 280px;
              "
            >
              <h3 style="color: #b45309; margin-bottom: 10px">
                Check Orientation with Thumbnails
              </h3>
              <p style="color: #555; line-height: 1.6">
                Always verify page orientation in the preview thumbnails. This
                ensures accuracy before you finalize and download.
              </p>
            </div>

            <!-- Card 4 -->
            <div
              style="
                background: white;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
                padding: 25px;
                flex: 1 1 300px;
                min-width: 280px;
              "
            >
              <h3 style="color: #b45309; margin-bottom: 10px">
                Leverage Auto Detection
              </h3>
              <p style="color: #555; line-height: 1.6">
                Use automatic page orientation detection when available. Let the
                tool suggest rotation angles for upside-down or sideways pages.
              </p>
            </div>

            <!-- Card 5 -->
            <div
              style="
                background: white;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
                padding: 25px;
                flex: 1 1 300px;
                min-width: 280px;
              "
            >
              <h3 style="color: #b45309; margin-bottom: 10px">
                Save Incrementally
              </h3>
              <p style="color: #555; line-height: 1.6">
                If working on large PDFs, save your progress periodically. This
                prevents data loss and allows you to revert if needed.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- Common Mistakes and How to Avoid Them Section -->
      <section class="features" style="background: #e0f2fe; padding: 60px 20px">
        <div class="container">
          <h2>Common Mistakes and How to Avoid Them</h2>
          <p
            style="
              max-width: 900px;
              margin: 0 auto 40px;
              color: #555;
              line-height: 1.8;
              text-align: center;
            "
          >
            Avoid pitfalls when rotating PDFs to maintain quality, efficiency,
            and accuracy.
          </p>

          <div
            style="
              max-width: 1000px;
              margin: 0 auto;
              display: flex;
              flex-wrap: wrap;
              gap: 20px;
              justify-content: center;
            "
          >
            <!-- Card 1 -->
            <div
              style="
                background: white;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
                padding: 25px;
                flex: 1 1 300px;
                min-width: 280px;
              "
            >
              <h3 style="color: #0369a1; margin-bottom: 10px">
                Rotating Without Preview
              </h3>
              <p style="color: #555; line-height: 1.6">
                Mistake: Rotating pages blindly can lead to incorrect
                orientation. Solution: Always check page thumbnails before
                applying rotations.
              </p>
            </div>

            <!-- Card 2 -->
            <div
              style="
                background: white;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
                padding: 25px;
                flex: 1 1 300px;
                min-width: 280px;
              "
            >
              <h3 style="color: #0369a1; margin-bottom: 10px">
                Over-Rotating Pages
              </h3>
              <p style="color: #555; line-height: 1.6">
                Mistake: Clicking the rotate button too many times may reverse
                your progress. Solution: Count clicks carefully—each click =
                90°.
              </p>
            </div>

            <!-- Card 3 -->
            <div
              style="
                background: white;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
                padding: 25px;
                flex: 1 1 300px;
                min-width: 280px;
              "
            >
              <h3 style="color: #0369a1; margin-bottom: 10px">
                Ignoring Page Types
              </h3>
              <p style="color: #555; line-height: 1.6">
                Mistake: Treating scanned and text-based PDFs the same.
                Solution: Use OCR for scanned pages if needed, and preserve
                searchable text.
              </p>
            </div>

            <!-- Card 4 -->
            <div
              style="
                background: white;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
                padding: 25px;
                flex: 1 1 300px;
                min-width: 280px;
              "
            >
              <h3 style="color: #0369a1; margin-bottom: 10px">
                Skipping Batch Checks
              </h3>
              <p style="color: #555; line-height: 1.6">
                Mistake: Rotating individual pages one by one for multiple PDFs.
                Solution: Use batch rotation and auto-detection to save time and
                maintain consistency.
              </p>
            </div>

            <!-- Card 5 -->
            <div
              style="
                background: white;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
                padding: 25px;
                flex: 1 1 300px;
                min-width: 280px;
              "
            >
              <h3 style="color: #0369a1; margin-bottom: 10px">
                Not Verifying Final Output
              </h3>
              <p style="color: #555; line-height: 1.6">
                Mistake: Downloading without a final check. Solution: Scroll
                through all pages before saving to ensure correct orientation
                for every page.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- CTA Section -->
      <section class="hero">
        <div class="container">
          <h2 style="font-size: 32px; margin-bottom: 15px">
            Ready to Fix Your PDF Orientation?
          </h2>
          <p style="margin-bottom: 25px">
            Rotate individual pages or entire documents in seconds. Visual
            preview ensures perfect orientation.
          </p>
          <a
            href="#"
            class="cta-button"
            onclick="
              window.scrollTo({ top: 0, behavior: 'smooth' });
              return false;
            "
            aria-label="Scroll to top to rotate PDF"
          >
            <i class="fa fa-sync-alt" aria-hidden="true"></i> Start Rotating Now
          </a>
        </div>
      </section>
    </main>

    <section id="footer-placeholder"></section>

    <script src="./js/app.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>

    <script>
      const BACKEND_ROTATE_URL = `${BACKEND_BASE_URL}/rotate-pdf`;

      const pdfUpload = document.getElementById("pdfUpload");
      const pagesGrid = document.getElementById("pagesGrid");
      const rotateBtn = document.getElementById("rotateBtn");
      const errorMsg = document.getElementById("errorMsg");
      const downloadBtn = document.getElementById("downloadBtn");
      const resultBtns = document.getElementById("resultBtns");
      const pdfFrame = document.getElementById("pdfFrame");
      const pdfPreview = document.getElementById("pdfPreview");
      const fileList = document.getElementById("fileList");
      const uploadSection = document.getElementById("uploadSection");
      const fileNameLink = document.getElementById("fileNameLink");
      const shareBtn = document.getElementById("shareBtn");
      const resetBtn = document.getElementById("resetBtn");
      const noteText = document.getElementById("noteText");
      const btnContainer = document.getElementById("btn-container");

      let files = [];

      pdfjsLib.GlobalWorkerOptions.workerSrc =
        "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";

      function showError(msg) {
        errorMsg.textContent = msg;
        errorMsg.style.display = "block";
      }

      function clearError() {
        errorMsg.style.display = "none";
      }

      function renderFileList() {
        if (files.length === 0) {
          fileList.style.display = "none";
          return;
        }

        fileList.style.display = "block";
        fileList.innerHTML = "";

        files.forEach((file, index) => {
          const li = document.createElement("li");
          li.innerHTML = `
            <i class="fa fa-file-pdf pdf-icon"></i>
            <span>${file.name}</span>
            <i class="fa fa-times delete-file" data-index="${index}" role="button" aria-label="Remove ${file.name}" tabindex="0"></i>
          `;
          fileList.appendChild(li);
        });
      }

      async function loadPDFs() {
        clearError();
        pagesGrid.innerHTML = "";

        if (files.length === 0) {
          pagesGrid.style.display = "none";
          return;
        }

        pagesGrid.style.display = "grid";

        let pageNo = 1;

        for (const file of files) {
          const pdf = await pdfjsLib.getDocument(URL.createObjectURL(file))
            .promise;

          for (let i = 1; i <= pdf.numPages; i++) {
            const page = await pdf.getPage(i);
            const viewport = page.getViewport({ scale: 1 });

            let maxWidth;
            if (window.innerWidth < 768) {
              maxWidth = window.innerWidth - 80;
            } else {
              maxWidth = (window.innerWidth - 140) / 2;
            }

            const displayScale = maxWidth / viewport.width;
            const renderScale = displayScale * (window.devicePixelRatio || 2);
            const scaledViewport = page.getViewport({ scale: renderScale });

            const canvas = document.createElement("canvas");
            const context = canvas.getContext("2d");

            canvas.width = scaledViewport.width;
            canvas.height = scaledViewport.height;

            await page.render({
              canvasContext: context,
              viewport: scaledViewport,
            }).promise;

            canvas.style.width = "100%";
            canvas.style.height = "auto";

            const card = document.createElement("div");
            card.className = "page-card";
            card.dataset.rotation = "0";
            card.setAttribute("role", "article");
            card.setAttribute("aria-label", `Page ${pageNo}`);

            card.innerHTML = `
              <div class="page-number" aria-hidden="true">Page ${pageNo++}</div>
              <div class="page-canvas-wrapper"></div>
              <div class="page-actions">
                <button class="rotate" aria-label="Rotate this page 90 degrees clockwise">
                  <i class="fa fa-rotate-right" aria-hidden="true"></i>
                </button>
              </div>
            `;

            card.querySelector(".page-canvas-wrapper").appendChild(canvas);

            card.querySelector(".rotate").onclick = () => {
              let r = (+card.dataset.rotation + 90) % 360;
              card.dataset.rotation = r;
              canvas.style.transform = `rotate(${r}deg) scale(${r % 180 ? 0.7 : 1})`;
            };

            pagesGrid.appendChild(card);
          }
        }
      }

      pdfUpload.addEventListener("change", async () => {
        const newFiles = Array.from(pdfUpload.files);
        btnContainer.style.display = "flex";
        newFiles.forEach((file) => {
          if (
            !files.some((f) => f.name === file.name && f.size === file.size)
          ) {
            files.push(file);
          }
        });

        pdfUpload.value = "";
        renderFileList();
        await loadPDFs();
      });

      fileList.addEventListener("click", async (e) => {
        if (!e.target.classList.contains("delete-file")) return;

        const index = Number(e.target.dataset.index);
        files.splice(index, 1);

        renderFileList();
        await loadPDFs();
        btnContainer.style.display = "none";
      });

      rotateBtn.onclick = async () => {
        clearError();

        if (files.length === 0) {
          showError("Please upload at least one PDF");
          return;
        }

        rotateBtn.classList.add("btn-loading");
        rotateBtn.disabled = true;

        const rotations = Array.from(
          document.querySelectorAll(".page-card"),
        ).map((card) => Number(card.dataset.rotation || 0));

        const fd = new FormData();
        files.forEach((f) => fd.append("files", f));
        fd.append("rotations", JSON.stringify(rotations));

        try {
          const res = await fetch(BACKEND_ROTATE_URL, {
            method: "POST",
            body: fd,
          });

          if (!res.ok) throw new Error(await res.text());

          const blob = await res.blob();
          const url = URL.createObjectURL(blob);

          downloadBtn.href = url;
          downloadBtn.download = "rotated.pdf";
          shareBtn.href = url;

          resultBtns.style.display = "block";
          uploadSection.style.display = "none";
          rotateBtn.style.display = "none";
          fileList.style.display = "none";
          pagesGrid.style.display = "none";
          noteText.style.display = "none";

          const isSmallDevice = window.matchMedia("(max-width: 768px)").matches;
          if (!isSmallDevice) {
            pdfFrame.src = url;
            pdfPreview.style.display = "block";
          }

          fileNameLink.onclick = (e) => {
            e.preventDefault();
            isSmallDevice
              ? window.open(url, "_blank")
              : pdfPreview.scrollIntoView({ behavior: "smooth" });
          };
          window.scrollTo({ top: 0, behavior: "smooth" });
          btnContainer.style.display = "none";
        } catch (e) {
          showError(e.message);
        } finally {
          rotateBtn.disabled = false;
          rotateBtn.classList.remove("btn-loading");
        }
      };

      resetBtn.onclick = () => {
        files = [];
        pagesGrid.innerHTML = "";
        pagesGrid.style.display = "none";
        fileList.innerHTML = "";
        fileList.style.display = "none";
        resultBtns.style.display = "none";
        pdfPreview.style.display = "none";
        pdfFrame.src = "";
        uploadSection.style.display = "block";
        rotateBtn.style.display = "inline-flex";
        noteText.style.display = "block";
        clearError();
        window.scrollTo({ top: 0, behavior: "smooth" });
      };
    </script>
  </body>
</html>
